<!-- generated with roffit -->
<a name="NAME"></a><h2 class="nroffsh">Name</h2>
<p class="level0">nping - Network packet generation tool / ping utility </p><a name="SYNOPSIS"></a><h2 class="nroffsh">Synopsis</h2>
<p class="level0"><span Class="bold">nping</span> [<span Class="emphasis">Options</span>] {<span Class="emphasis">targets</span>} </p><a name="DESCRIPTION"></a><h2 class="nroffsh">Description</h2>
<p class="level0">Nping is an open-source tool for network packet generation, response analysis and response time measurement. Nping allows users to generate network packets of a wide range of protocols, letting them tune virtually any field of the protocol headers. While Nping can be used as a simple ping utility to detect active hosts, it can also be used as a raw packet generator for network stack stress tests, ARP poisoning, Denial of Service attacks, route tracing, and other purposes. </p>
<p class="level0">Additionally, Nping offers a special mode of operation called the &quot;Echo Mode&quot;, that lets users see how the generated probes change in transit, revealing the differences between the transmitted packets and the packets received at the other end. See section &quot;Echo Mode&quot; for details. </p>
<p class="level0">The output from Nping is a list of the packets that are being sent and received. The level of detail depends on the options used. </p>
<p class="level0">A typical Nping execution is shown in Example&nbsp;1. The only Nping arguments used in this example are <span Class="bold">-c</span>, to specify the number of times to target each host, <span Class="bold">--tcp</span> to specify TCP Probe Mode, <span Class="bold">-p 80,433</span> to specify the target ports; and then the two target hostnames. </p>
<p class="level0"><span Class="bold">Example&nbsp;1.&nbsp;A representative Nping execution</span> </p><pre class="level1">
&#35; <span class="bold">nping -c 1 --tcp -p 80,433 scanme.nmap.org google.com</span>
&nbsp;
Starting Nping ( https://nmap.org/nping )
SENT (0.0120s) TCP 96.16.226.135:50091 &gt; 64.13.134.52:80 S ttl=64 id=52072 iplen=40  seq=1077657388 win=1480 
RCVD (0.1810s) TCP 64.13.134.52:80 &gt; 96.16.226.135:50091 SA ttl=53 id=0 iplen=44  seq=4158134847 win=5840 &lt;mss 1460&gt;
SENT (1.0140s) TCP 96.16.226.135:50091 &gt; 74.125.45.100:80 S ttl=64 id=13932 iplen=40  seq=1077657388 win=1480 
RCVD (1.1370s) TCP 74.125.45.100:80 &gt; 96.16.226.135:50091 SA ttl=52 id=52913 iplen=44  seq=2650443864 win=5720 &lt;mss 1430&gt;
SENT (2.0140s) TCP 96.16.226.135:50091 &gt; 64.13.134.52:433 S ttl=64 id=8373 iplen=40  seq=1077657388 win=1480 
SENT (3.0140s) TCP 96.16.226.135:50091 &gt; 74.125.45.100:433 S ttl=64 id=23624 iplen=40  seq=1077657388 win=1480 
&nbsp;
Statistics for host scanme.nmap.org (64.13.134.52):
&nbsp;|  Probes Sent: 2 | Rcvd: 1 | Lost: 1  (50.00%)
&nbsp;|_ Max rtt: 169.720ms | Min rtt: 169.720ms | Avg rtt: 169.720ms
Statistics for host google.com (74.125.45.100):
&nbsp;|  Probes Sent: 2 | Rcvd: 1 | Lost: 1  (50.00%)
&nbsp;|_ Max rtt: 122.686ms | Min rtt: 122.686ms | Avg rtt: 122.686ms
Raw packets sent: 4 (160B) | Rcvd: 2 (92B) | Lost: 2 (50.00%)
Tx time: 3.00296s | Tx bytes/s: 53.28 | Tx pkts/s: 1.33
Rx time: 3.00296s | Rx bytes/s: 30.64 | Rx pkts/s: 0.67
Nping done: 2 IP addresses pinged in 4.01 seconds
</pre>

<p class="level0">The newest version of Nping can be obtained with Nmap at m[blue]<span Class="bold">%<a href="https://nmap.org">https://nmap.org</a></span>m[]. The newest version of this man page is available at m[blue]<span Class="bold">%<a href="https://nmap.org/book/nping-man.html">https://nmap.org/book/nping-man.html</a></span>m[]. </p>
<p class="level0">--&gt; &nbsp; .SH &quot;OPTIONS SUMMARY&quot; </p>
<p class="level0">This options summary is printed when Nping is run with no arguments. It helps people remember the most common options, but is no substitute for the in-depth documentation in the rest of this manual. Some obscure options aren*(Aqt even included here. </p><pre class="level1">
Nping 0.7.92SVN ( https://nmap.org/nping )
Usage: nping [Probe mode] [Options] {target specification}
&nbsp;
TARGET SPECIFICATION:
&nbsp; Targets may be specified as hostnames, IP addresses, networks, etc.
&nbsp; Ex: scanme.nmap.org, microsoft.com/24, 192.168.0.1; 10.0.*.1-24
PROBE MODES:
&nbsp; --tcp-connect                    : Unprivileged TCP connect probe mode.
&nbsp; --tcp                            : TCP probe mode.
&nbsp; --udp                            : UDP probe mode.
&nbsp; --icmp                           : ICMP probe mode.
&nbsp; --arp                            : ARP/RARP probe mode.
&nbsp; --tr, --traceroute               : Traceroute mode (can only be used with 
&nbsp;                                    TCP/UDP/ICMP modes).
TCP CONNECT MODE:
&nbsp;  -p, --dest-port &lt;port spec&gt;     : Set destination port(s).
&nbsp;  -g, --source-port &lt;portnumber&gt;  : Try to use a custom source port.
TCP PROBE MODE:
&nbsp;  -g, --source-port &lt;portnumber&gt;  : Set source port.
&nbsp;  -p, --dest-port &lt;port spec&gt;     : Set destination port(s).
&nbsp;  --seq &lt;seqnumber&gt;               : Set sequence number.
&nbsp;  --flags &lt;flag list&gt;             : Set TCP flags (ACK,PSH,RST,SYN,FIN...)
&nbsp;  --ack &lt;acknumber&gt;               : Set ACK number.
&nbsp;  --win &lt;size&gt;                    : Set window size.
&nbsp;  --badsum                        : Use a random invalid checksum. 
UDP PROBE MODE:
&nbsp;  -g, --source-port &lt;portnumber&gt;  : Set source port.
&nbsp;  -p, --dest-port &lt;port spec&gt;     : Set destination port(s).
&nbsp;  --badsum                        : Use a random invalid checksum. 
ICMP PROBE MODE:
&nbsp; --icmp-type &lt;type&gt;               : ICMP type.
&nbsp; --icmp-code &lt;code&gt;               : ICMP code.
&nbsp; --icmp-id &lt;id&gt;                   : Set identifier.
&nbsp; --icmp-seq &lt;n&gt;                   : Set sequence number.
&nbsp; --icmp-redirect-addr &lt;addr&gt;      : Set redirect address.
&nbsp; --icmp-param-pointer &lt;pnt&gt;       : Set parameter problem pointer.
&nbsp; --icmp-advert-lifetime &lt;time&gt;    : Set router advertisement lifetime.
&nbsp; --icmp-advert-entry &lt;IP,pref&gt;    : Add router advertisement entry.
&nbsp; --icmp-orig-time  &lt;timestamp&gt;    : Set originate timestamp.
&nbsp; --icmp-recv-time  &lt;timestamp&gt;    : Set receive timestamp.
&nbsp; --icmp-trans-time &lt;timestamp&gt;    : Set transmit timestamp.
ARP/RARP PROBE MODE:
&nbsp; --arp-type &lt;type&gt;                : Type: ARP, ARP-reply, RARP, RARP-reply.
&nbsp; --arp-sender-mac &lt;mac&gt;           : Set sender MAC address.
&nbsp; --arp-sender-ip  &lt;addr&gt;          : Set sender IP address.
&nbsp; --arp-target-mac &lt;mac&gt;           : Set target MAC address.
&nbsp; --arp-target-ip  &lt;addr&gt;          : Set target IP address.
IPv4 OPTIONS:
&nbsp; -S, --source-ip                  : Set source IP address.
&nbsp; --dest-ip &lt;addr&gt;                 : Set destination IP address (used as an 
&nbsp;                                    alternative to {target specification} ). 
&nbsp; --tos &lt;tos&gt;                      : Set type of service field (8bits).
&nbsp; --id  &lt;id&gt;                       : Set identification field (16 bits).
&nbsp; --df                             : Set Don*(Aqt Fragment flag.
&nbsp; --mf                             : Set More Fragments flag.
&nbsp; --evil                           : Set Reserved / Evil flag.
&nbsp; --ttl &lt;hops&gt;                     : Set time to live [0-255].
&nbsp; --badsum-ip                      : Use a random invalid checksum. 
&nbsp; --ip-options &lt;S|R [route]|L [route]|T|U ...&gt; : Set IP options
&nbsp; --ip-options &lt;hex string&gt;                    : Set IP options
&nbsp; --mtu &lt;size&gt;                     : Set MTU. Packets get fragmented if MTU is
&nbsp;                                    small enough.
IPv6 OPTIONS:
&nbsp; -6, --IPv6                       : Use IP version 6.
&nbsp; --dest-ip                        : Set destination IP address (used as an
&nbsp;                                    alternative to {target specification}).
&nbsp; --hop-limit                      : Set hop limit (same as IPv4 TTL).
&nbsp; --traffic-class &lt;class&gt; :        : Set traffic class.
&nbsp; --flow &lt;label&gt;                   : Set flow label.
ETHERNET OPTIONS:
&nbsp; --dest-mac &lt;mac&gt;                 : Set destination mac address. (Disables
&nbsp;                                    ARP resolution)
&nbsp; --source-mac &lt;mac&gt;               : Set source MAC address.
&nbsp; --ether-type &lt;type&gt;              : Set EtherType value.
PAYLOAD OPTIONS:
&nbsp; --data &lt;hex string&gt;              : Include a custom payload.
&nbsp; --data-string &lt;text&gt;             : Include a custom ASCII text.
&nbsp; --data-length &lt;len&gt;              : Include len random bytes as payload.
ECHO CLIENT/SERVER:
&nbsp; --echo-client &lt;passphrase&gt;       : Run Nping in client mode.
&nbsp; --echo-server &lt;passphrase&gt;       : Run Nping in server mode.
&nbsp; --echo-port &lt;port&gt;               : Use custom &lt;port&gt; to listen or connect.
&nbsp; --no-crypto                      : Disable encryption and authentication.
&nbsp; --once                           : Stop the server after one connection.
&nbsp; --safe-payloads                  : Erase application data in echoed packets.
TIMING AND PERFORMANCE:
&nbsp; Options which take &lt;time&gt; are in seconds, or append *(Aqms*(Aq (milliseconds),
&nbsp; *(Aqs*(Aq (seconds), *(Aqm*(Aq (minutes), or *(Aqh*(Aq (hours) to the value (e.g. 30m, 0.25h).
&nbsp; --delay &lt;time&gt;                   : Adjust delay between probes.
&nbsp; --rate  &lt;rate&gt;                   : Send num packets per second.
MISC:
&nbsp; -h, --help                       : Display help information.
&nbsp; -V, --version                    : Display current version number. 
&nbsp; -c, --count &lt;n&gt;                  : Stop after &lt;n&gt; rounds.
&nbsp; -e, --interface &lt;name&gt;           : Use supplied network interface.
&nbsp; -H, --hide-sent                  : Do not display sent packets.
&nbsp; -N, --no-capture                 : Do not try to capture replies.
&nbsp; --privileged                     : Assume user is fully privileged.
&nbsp; --unprivileged                   : Assume user lacks raw socket privileges.
&nbsp; --send-eth                       : Send packets at the raw Ethernet layer.
&nbsp; --send-ip                        : Send packets using raw IP sockets.
&nbsp; --bpf-filter &lt;filter spec&gt;       : Specify custom BPF filter.
OUTPUT:
&nbsp; -v                               : Increment verbosity level by one.
&nbsp; -v[level]                        : Set verbosity level. E.g: -v4
&nbsp; -d                               : Increment debugging level by one.
&nbsp; -d[level]                        : Set debugging level. E.g: -d3
&nbsp; -q                               : Decrease verbosity level by one.
&nbsp; -q[N]                            : Decrease verbosity level N times
&nbsp; --quiet                          : Set verbosity and debug level to minimum.
&nbsp; --debug                          : Set verbosity and debug to the max level.
EXAMPLES:
&nbsp; nping scanme.nmap.org
&nbsp; nping --tcp -p 80 --flags rst --ttl 2 192.168.1.1
&nbsp; nping --icmp --icmp-type time --delay 500ms 192.168.254.254
&nbsp; nping --echo-server &quot;public&quot; -e wlan0 -vvv 
&nbsp; nping --echo-client &quot;public&quot; echo.nmap.org --tcp -p1-1024 --flags ack
&nbsp;
SEE THE MAN PAGE FOR MANY MORE OPTIONS, DESCRIPTIONS, AND EXAMPLES
&nbsp;
</pre>
<a name="TARGET"></a><h2 class="nroffsh">Target specification</h2>
<p class="level0">Everything on the Nping command line that isn*(Aqt an option or an option argument is treated as a target host specification. Nping uses the same syntax for target specifications that Nmap does. The simplest case is a single target given by IP address or hostname. </p>
<p class="level0">Nping supports CIDR-style addressing. You can append /<span Class="emphasis">numbits</span> to an IPv4 address or hostname and Nping will send probes to every IP address for which the first <span Class="emphasis">numbits</span> are the same as for the reference IP or hostname given. For example, 192.168.10.0/24 would send probes to the 256 hosts between 192.168.10.0 (binary: 11000000 10101000 00001010 00000000) and 192.168.10.255 (binary: 11000000 10101000 00001010 11111111), inclusive. 192.168.10.40/24 would ping exactly the same targets. Given that the host scanme.nmap.org is at the IP address 64.13.134.52, the specification scanme.nmap.org/16 would send probes to the 65,536 IP addresses between 64.13.0.0 and 64.13.255.255. The smallest allowed value is /0, which targets the whole Internet. The largest value is /32, which targets just the named host or IP address because all address bits are fixed. </p>
<p class="level0">CIDR notation is short but not always flexible enough. For example, you might want to send probes to 192.168.0.0/16 but skip any IPs ending with .0 or .255 because they may be used as subnet network and broadcast addresses. Nping supports this through octet range addressing. Rather than specify a normal IP address, you can specify a comma-separated list of numbers or ranges for each octet. For example, 192.168.0-255.1-254 will skip all addresses in the range that end in .0 or .255, and 192.168.3-5,7.1 will target the four addresses 192.168.3.1, 192.168.4.1, 192.168.5.1, and 192.168.7.1. Either side of a range may be omitted; the default values are 0 on the left and 255 on the right. Using - by itself is the same as 0-255, but remember to use 0- in the first octet so the target specification doesn*(Aqt look like a command-line option. Ranges need not be limited to the final octets: the specifier 0-.-.13.37 will send probes to all IP addresses on the Internet ending in .13.37. This sort of broad sampling can be useful for Internet surveys and research. </p>
<p class="level0">IPv6 addresses can only be specified by their fully qualified IPv6 address or hostname. CIDR and octet ranges aren*(Aqt supported for IPv6 because they are rarely useful. </p>
<p class="level0">Nping accepts multiple host specifications on the command line, and they don*(Aqt need to be the same type. The command <span Class="bold">nping scanme.nmap.org 192.168.0.0/8 10.0.0,1,3-7.-</span> does what you would expect. </p><a name="OPTION"></a><h2 class="nroffsh">Option specification</h2>
<p class="level0">Nping is designed to be very flexible and fit a wide variety of needs. As with most command-line tools, its behavior can be adjusted using command-line options. These general principles apply to option arguments, unless stated otherwise. </p>
<p class="level0">Options that take integer numbers can accept values specified in decimal, octal or hexadecimal base. When a number starts with 0x, it will be treated as hexadecimal; when it simply starts with 0, it will be treated as octal. Otherwise, Nping will assume the number has been specified in base 10. Virtually all numbers that can be supplied from the command line are unsigned so, as a general rule, the minimum value is zero. Users may also specify the word random or rand to make Nping generate a random value within the expected range. </p>
<p class="level0">IP addresses may be given as IPv4 addresses (e.g. 192.168.1.1), IPv6 addresses (e.g. 2001:db8:85a3::8e4c:760:7146), or hostnames, which will be resolved using the default DNS server configured in the host system. </p>
<p class="level0">Options that take MAC addresses accept the usual colon-separated 6 hex byte format (e.g. 00:50:56:d4:01:98). Hyphens may also be used instead of colons (e.g. 00-50-56-c0-00-08). The special word random or rand sets a random address and the word broadcast or bcast sets ff:ff:ff:ff:ff:ff. </p><a name="GENERAL"></a><h2 class="nroffsh">General operation</h2>
<p class="level0">Unlike other ping and packet generation tools, Nping supports multiple target host and port specifications. While this provides great flexibility, it is not obvious how Nping handles situations where there is more than one host and/or more than one port to send probes to. This section explains how Nping behaves in these cases. </p>
<p class="level0">When multiple target hosts are specified, Nping rotates among them in round-robin fashion. This gives slow hosts more time to send their responses before another probe is sent to them. Ports are also scheduled using round robin. So, unless only one port is specified, Nping never sends two probes to the same target host and port consecutively. </p>
<p class="level0">The loop around targets is the (lqinner loop(rq and the loop around ports is the (lqouter loop(rq. All targets will be sent a probe for a given port before moving on to the next port. Between probes, Nping waits a configurable amount of time called the (lqinter-probe delay(rq, which is controlled by the <span Class="bold">--delay</span> option. These examples show how it works. </p><pre class="level2">
&#35; <span class="bold">nping --tcp -c 2 1.1.1.1 -p 100-102</span>
&nbsp;
Starting Nping ( https://nmap.org/nping )
SENT (0.0210s) TCP 192.168.1.77 &gt; 1.1.1.1:100
SENT (1.0230s) TCP 192.168.1.77 &gt; 1.1.1.1:101
SENT (2.0250s) TCP 192.168.1.77 &gt; 1.1.1.1:102
SENT (3.0280s) TCP 192.168.1.77 &gt; 1.1.1.1:100
SENT (4.0300s) TCP 192.168.1.77 &gt; 1.1.1.1:101
SENT (5.0320s) TCP 192.168.1.77 &gt; 1.1.1.1:102
</pre>
<pre class="level2">
&#35; <span class="bold">nping --tcp -c 2 1.1.1.1 2.2.2.2 3.3.3.3 -p 8080</span>
&nbsp;
Starting Nping ( https://nmap.org/nping )
SENT (0.0230s) TCP 192.168.0.21 &gt; 1.1.1.1:8080
SENT (1.0240s) TCP 192.168.0.21 &gt; 2.2.2.2:8080
SENT (2.0260s) TCP 192.168.0.21 &gt; 3.3.3.3:8080
SENT (3.0270s) TCP 192.168.0.21 &gt; 1.1.1.1:8080
SENT (4.0290s) TCP 192.168.0.21 &gt; 2.2.2.2:8080
SENT (5.0310s) TCP 192.168.0.21 &gt; 3.3.3.3:8080
</pre>
<pre class="level2">
&#35; <span class="bold">nping --tcp -c 1 --delay 500ms 1.1.1.1 2.2.2.2 3.3.3.3 -p 137-139</span>
&nbsp;
Starting Nping ( https://nmap.org/nping )
SENT (0.0230s) TCP 192.168.0.21 &gt; 1.1.1.1:137
SENT (0.5250s) TCP 192.168.0.21 &gt; 2.2.2.2:137
SENT (1.0250s) TCP 192.168.0.21 &gt; 3.3.3.3:137
SENT (1.5280s) TCP 192.168.0.21 &gt; 1.1.1.1:138
SENT (2.0280s) TCP 192.168.0.21 &gt; 2.2.2.2:138
SENT (2.5310s) TCP 192.168.0.21 &gt; 3.3.3.3:138
SENT (3.0300s) TCP 192.168.0.21 &gt; 1.1.1.1:139
SENT (3.5330s) TCP 192.168.0.21 &gt; 2.2.2.2:139
SENT (4.0330s) TCP 192.168.0.21 &gt; 3.3.3.3:139
</pre>
<a name="PROBE"></a><h2 class="nroffsh">Probe modes</h2>
<p class="level0">Nping supports a wide variety of protocols. Although in some cases Nping can automatically determine the mode from the options used, it is generally a good idea to specify it explicitly. </p>
<p class="level0"><span Class="bold">--tcp-connect</span> (TCP Connect mode) </p>
<p class="level1">TCP connect mode is the default mode when a user does not have raw packet privileges. Instead of writing raw packets as most other modes do, Nping asks the underlying operating system to establish a connection with the target machine and port by issuing the connect system call. This is the same high-level system call that web browsers, P2P clients, and most other network-enabled applications use to establish a connection. It is part of a programming interface known as the Berkeley Sockets API. Rather than read raw packet responses off the wire, Nping uses this API to obtain status information on each connection attempt. For this reason, you will not be able to see the contents of the packets that are sent or received but only status information about the TCP connection establishment taking place. </p>
<p class="level0"><span Class="bold">--tcp</span> (TCP mode) </p>
<p class="level1">TCP is the mode that lets users create and send any kind of TCP packet. TCP packets are sent embedded in IP packets that can also be tuned. This mode can be used for many different purposes. For example you could try to discover open ports by sending TCP SYN messages without completing the three-way handshake. This technique is often referred to as half-open scanning, because you don*(Aqt open a full TCP connection. You send a SYN packet, as if you are going to open a real connection and then wait for a response. A SYN/ACK indicates the port is open, while a RST indicates it*(Aqs closed. If no response is received one could assume that some intermediate network device is filtering the responses. Another use could be to see how a remote TCP/IP stack behaves when it receives a non-RFC-compliant packet, like one with both SYN and RST flags set. One could also do some evil by creating custom RST packets using an spoofed IP address with the intent of closing an active TCP connection. </p>
<p class="level0"><span Class="bold">--udp</span> (UDP mode) </p>
<p class="level1">UDP mode can have two different behaviours. Under normal circumstances, it lets users create custom IP/UDP packets. However, if Nping is run by a user without raw packet privileges and no changes to the default protocol headers are requested, then Nping enters the unprivileged UDP mode which basically sends UDP packets to the specified target hosts and ports using the sendto system call. Note that in this unprivileged mode it is not possible to see low-level header information of the packets on the wire but only status information about the amount of bytes that are being transmitted and received. UDP mode can be used to interact with any UDP-based server. Examples are DNS servers, streaming servers, online gaming servers, and port knocking/single-packet authorization daemons. </p>
<p class="level0"><span Class="bold">--icmp</span> (ICMP mode) </p>
<p class="level1">ICMP mode is the default mode when the user runs Nping with raw packet privileges. Any kind of ICMP message can be created. The default ICMP type is Echo, i.e., ping. ICMP mode can be used for many different purposes, from a simple request for a timestamp or a netmask to the transmission of fake destination unreachable messages, custom redirects, and router advertisements. </p>
<p class="level0"><span Class="bold">--arp</span> (ARP/RARP mode) </p>
<p class="level1">ARP lets you create and send a few different ARP-related packets. These include ARP, RARP, DRARP, and InARP requests and replies. This mode can ban be used to perform low-level host discovery, and conduct ARP-cache poisoning attacks. </p>
<p class="level0"><span Class="bold">--traceroute</span> (Traceroute mode) </p>
<p class="level1">Traceroute is not a mode by itself but a complement to TCP, UDP, and ICMP modes. When this option is specified Nping will set the IP TTL value of the first probe to 1. When the next router receives the packet it will drop it due to the expiration of the TTL and it will generate an ICMP destination unreachable message. The next probe will have a TTL of 2 so now the first router will forward the packet while the second router will be the one that drops the packet and generates the ICMP message. The third probe will have a TTL value of 3 and so on. By examining the source addresses of all those ICMP Destination Unreachable messages it is possible to determine the path that the probes take until they reach their final destination. </p><a name="TCP"></a><h2 class="nroffsh">Tcp connect mode</h2>
<p class="level0"><span Class="bold">-p </span><span class="bold"><span Class="emphasis">port_spec</span></span>, <span Class="bold">--dest-port </span><span class="bold"><span Class="emphasis">port_spec</span></span> (Target ports) </p>
<p class="level1">This option specifies which ports you want to try to connect to. It can be a single port, a comma-separated list of ports (e.g. 80,443,8080), a range (e.g. 1-1023), and any combination of those (e.g. 21-25,80,443,1024-2048). The beginning and/or end values of a range may be omitted, causing Nping to use 1 and 65535, respectively. So you can specify -p- to target ports from 1 through 65535. Using port zero is allowed if you specify it explicitly. </p>
<p class="level0"><span Class="bold">-g </span><span class="bold"><span Class="emphasis">portnumber</span></span>, <span Class="bold">--source-port </span><span class="bold"><span Class="emphasis">portnumber</span></span> (Spoof source port) </p>
<p class="level1">This option asks Nping to use the specified port as source port for the TCP connections. Note that this might not work on all systems or may require root privileges. Specified value must be an integer in the range [0(en65535]. </p><a name="TCP"></a><h2 class="nroffsh">Tcp mode</h2>
<p class="level0"><span Class="bold">-p </span><span class="bold"><span Class="emphasis">port_spec</span></span>, <span Class="bold">--dest-port </span><span class="bold"><span Class="emphasis">port_spec</span></span> (Target ports) </p>
<p class="level1">This option specifies which destination ports you want to send probes to. It can be a single port, a comma-separated list of ports (e.g. 80,443,8080), a range (e.g. 1-1023), and any combination of those (e.g. 21-25,80,443,1024-2048). The beginning and/or end values of a range may be omitted, causing Nping to use 1 and 65535, respectively. So you can specify -p- to target ports from 1 through 65535. Using port zero is allowed if you specify it explicitly. </p>
<p class="level0"><span Class="bold">-g </span><span class="bold"><span Class="emphasis">portnumber</span></span>, <span Class="bold">--source-port </span><span class="bold"><span Class="emphasis">portnumber</span></span> (Spoof source port) </p>
<p class="level1">This option asks Nping to use the specified port as source port for the TCP connections. Note that this might not work on all systems or may require root privileges. Specified value must be an integer in the range [0(en65535]. </p>
<p class="level0"><span Class="bold">--seq </span><span class="bold"><span Class="emphasis">seqnumber</span></span> (Sequence Number) </p>
<p class="level1">Specifies the TCP sequence number. In SYN packets this is the initial sequence number (ISN). In a normal transmission this corresponds to the sequence number of the first byte of data in the segment. <span Class="emphasis">seqnumber</span> must be a number in the range [0(en4294967295]. </p>
<p class="level0"><span Class="bold">--flags </span><span class="bold"><span Class="emphasis">flags</span></span> (TCP Flags) </p>
<p class="level1">This option specifies which flags should be set in the TCP packet. <span Class="emphasis">flags</span> may be specified in three different ways: </p>
<p class="level2">h&#39;-04&#39; 1.h&#39;+01&#39;c </p>
<p class="level1"><a name=""></a><span class="nroffip">  1. 4.2</span> </p>
<p class="level2">As a comma-separated list of flags, e.g. <span Class="bold">--flags syn,ack,rst</span> </p>
<p class="level2">h&#39;-04&#39; 2.h&#39;+01&#39;c </p>
<p class="level1"><a name=""></a><span class="nroffip">  2. 4.2</span> </p>
<p class="level2">As a list of one-character flag initials, e.g. <span Class="bold">--flags SAR</span> tells Nping to set flags SYN, ACK, and RST. </p>
<p class="level2">h&#39;-04&#39; 3.h&#39;+01&#39;c </p>
<p class="level1"><a name=""></a><span class="nroffip">  3. 4.2</span> </p>
<p class="level2">As an 8-bit hexadecimal number, where the supplied number is the exact value that will be placed in the flags field of the TCP header. The number should start with the prefix 0x and should be in the range [0x00(en0xFF], e.g. --flags 0x20 sets the URG flag as 0x20 corresponds to binary 00100000 and the URG flag is represented by the third bit. </p>
<p class="level1">There are 8 possible flags to set: CWR, ECN, URG, ACK, PSH, RST, SYN, and FIN. The special value ALL means to set all flags. NONE means to set no flags. It is important that if you don*(Aqt want any flag to be set, you request it explicitly because in some cases the SYN flag may be set by default. Here is a brief description of the meaning of each flag: </p>
<p class="level1">CWR (Congestion Window Reduced) </p>
<p class="level2">Set by an ECN-Capable sender when it reduces its congestion window (due to a retransmit timeout, a fast retransmit or in response to an ECN notification. </p>
<p class="level1">ECN (Explicit Congestion Notification) </p>
<p class="level2">During the three-way handshake it indicates that sender is capable of performing explicit congestion notification. Normally it means that a packet with the IP Congestion Experienced flag set was received during normal transmission. See <a href="http://www.ietf.org/rfc/rfc3168.txt">RFC 3168</a> for more information. </p>
<p class="level1">URG (Urgent) </p>
<p class="level2">Segment is urgent and the urgent pointer field carries valid information. </p>
<p class="level1">ACK (Acknowledgement) </p>
<p class="level2">The segment carries an acknowledgement and the value of the acknowledgement number field is valid and contains the next sequence number that is expected from the receiver. </p>
<p class="level1">PSH (Push) </p>
<p class="level2">The data in this segment should be immediately pushed to the application layer on arrival. </p>
<p class="level1">RST (Reset) </p>
<p class="level2">There was some problem and the sender wants to abort the connection. </p>
<p class="level1">SYN (Synchronize) </p>
<p class="level2">The segment is a request to synchronize sequence numbers and establish a connection. The sequence number field contains the sender*(Aqs initial sequence number. </p>
<p class="level1">FIN (Finish) </p>
<p class="level2">The sender wants to close the connection. </p>
<p class="level0"><span Class="bold">--win </span><span class="bold"><span Class="emphasis">size</span></span> (Window Size) </p>
<p class="level1">Specifies the TCP window size, this is, the number of octets the sender of the segment is willing to accept from the receiver at one time. This is usually the size of the reception buffer that the OS allocates for a given connection. <span Class="emphasis">size</span> must be a number in the range [0(en65535]. </p>
<p class="level0"><span Class="bold">--badsum</span> (Invalid Checksum) </p>
<p class="level1">Asks Nping to use an invalid TCP checksum for the packets sent to target hosts. Since virtually all host IP stacks properly drop these packets, any responses received are likely coming from a firewall or an IDS that didn*(Aqt bother to verify the checksum. For more details on this technique, see m[blue]<span Class="bold">%<a href="https://nmap.org/p60-12.html">https://nmap.org/p60-12.html</a></span>m[]. </p><a name="UDP"></a><h2 class="nroffsh">Udp mode</h2>
<p class="level0"><span Class="bold">-p </span><span class="bold"><span Class="emphasis">port_spec</span></span>, <span Class="bold">--dest-port </span><span class="bold"><span Class="emphasis">port_spec</span></span> (Target ports) </p>
<p class="level1">This option specifies which ports you want UDP datagrams to be sent to. It can be a single port, a comma-separated list of ports (e.g. 80,443,8080), a range (e.g. 1-1023), and any combination of those (e.g. 21-25,80,443,1024-2048). The beginning and/or end values of a range may be omitted, causing Nping to use 1 and 65535, respectively. So you can specify -p- to target ports from 1 through 65535. Using port zero is allowed if you specify it explicitly. </p>
<p class="level0"><span Class="bold">-g </span><span class="bold"><span Class="emphasis">portnumber</span></span>, <span Class="bold">--source-port </span><span class="bold"><span Class="emphasis">portnumber</span></span> (Spoof source port) </p>
<p class="level1">This option asks Nping to use the specified port as source port for the transmitted datagrams. Note that this might not work on all systems or may require root privileges. Specified value must be an integer in the range [0(en65535]. </p>
<p class="level0"><span Class="bold">--badsum</span> (Invalid Checksum) </p>
<p class="level1">Asks Nping to use an invalid UDP checksum for the packets sent to target hosts. Since virtually all host IP stacks properly drop these packets, any responses received are likely coming from a firewall or an IDS that didn*(Aqt bother to verify the checksum. For more details on this technique, see m[blue]<span Class="bold">%<a href="https://nmap.org/p60-12.html">https://nmap.org/p60-12.html</a></span>m[]. </p><a name="ICMP"></a><h2 class="nroffsh">Icmp mode</h2>
<p class="level0"><span Class="bold">--icmp-type </span><span class="bold"><span Class="emphasis">type</span></span> (ICMP type) </p>
<p class="level1">This option specifies which type of ICMP messages should be generated. <span Class="emphasis">type</span> can be supplied in two different ways. You can use the m[blue]<span Class="bold">official type numbers assigned by IANA</span>m[]s-2u[1]ds+2 (e.g. <span Class="bold">--icmp-type 8</span> for ICMP Echo Request), or you can use any of the mnemonics listed in the section called (lqICMP Types(rq. </p>
<p class="level0"><span Class="bold">--icmp-code </span><span class="bold"><span Class="emphasis">code</span></span> (ICMP code) </p>
<p class="level1">This option specifies which ICMP code should be included in the generated ICMP messages. <span Class="emphasis">code</span> can be supplied in two different ways. You can use the m[blue]<span Class="bold">official code numbers assigned by IANA</span>m[]s-2u[1]ds+2 (e.g. <span Class="bold">--icmp-code 1</span> for Fragment Reassembly Time Exceeded), or you can use any of the mnemonics listed in the section called (lqICMP Codes(rq. </p>
<p class="level0"><span Class="bold">--icmp-id </span><span class="bold"><span Class="emphasis">id</span></span> (ICMP identifier) </p>
<p class="level1">This option specifies the value of the identifier used in some of the ICMP messages. In general it is used to match request and reply messages. <span Class="emphasis">id</span> must be a number in the range [0(en65535]. </p>
<p class="level0"><span Class="bold">--icmp-seq </span><span class="bold"><span Class="emphasis">seq</span></span> (ICMP sequence) </p>
<p class="level1">This option specifies the value of the sequence number field used in some ICMP messages. In general it is used to match request and reply messages. <span Class="emphasis">id</span> must be a number in the range [0(en65535]. </p>
<p class="level0"><span Class="bold">--icmp-redirect-addr </span><span class="bold"><span Class="emphasis">addr</span></span> (ICMP Redirect address) </p>
<p class="level1">This option sets the address field in ICMP Redirect messages. In other words, it sets the IP address of the router that should be used when sending IP datagrams to the original destination. <span Class="emphasis">addr</span> can be either an IPv4 address or a hostname. </p>
<p class="level0"><span Class="bold">--icmp-param-pointer </span><span class="bold"><span Class="emphasis">pointer</span></span> (ICMP Parameter Problem pointer) </p>
<p class="level1">This option specifies the pointer that indicates the location of the problem in ICMP Parameter Problem messages. <span Class="emphasis">pointer</span> should be a number in the range [0(en255]. Normally this option is only used when ICMP code is set to 0 (&quot;Pointer indicates the error&quot;). </p>
<p class="level0"><span Class="bold">--icmp-advert-lifetime </span><span class="bold"><span Class="emphasis">ttl</span></span> (ICMP Router Advertisement Lifetime) </p>
<p class="level1">This option specifies the router advertisement lifetime, this is, the number of seconds the information carried in an ICMP Router Advertisement can be considered valid for. <span Class="emphasis">ttl</span> must be a positive integer in the range [0(en65535]. </p>
<p class="level0"><span Class="bold">--icmp-advert-entry </span><span class="bold"><span Class="emphasis">addr</span></span><a class="bold" href="#">,</a><span class="bold"><span Class="emphasis">pref</span></span> (ICMP Router Advertisement Entry) </p>
<p class="level1">This option adds a Router Advertisement entry to an ICMP Router Advertisement message. The parameter must be two values separated by a comma. <span Class="emphasis">addr</span> is the router*(Aqs IP and can be specified either as an IP address in dot-decimal notation or as a hostname. <span Class="emphasis">pref</span> is the preference level for the specified IP. It must be a number in the range [0(en4294967295]. An example is <span Class="bold">--icmp-advert-entry 192.168.128.1,3</span>. </p>
<p class="level0"><span Class="bold">--icmp-orig-time </span><span class="bold"><span Class="emphasis">timestamp</span></span> (ICMP Originate Timestamp) </p>
<p class="level1">This option sets the Originate Timestamp in ICMP Timestamp messages. The Originate Timestamp is expressed as the number of milliseconds since midnight UTC and it corresponds to the time the sender last touched the Timestamp message before its transmission. <span Class="emphasis">timestamp</span> can be specified as a regular time (e.g. 10s, 3h, 1000ms), or the special string now. You can add or subtract values from now, for example <span Class="bold">--icmp-orig-time now-2s</span>, <span Class="bold">--icmp-orig-time now+1h</span>, <span Class="bold">--icmp-orig-time now+200ms</span>. </p>
<p class="level0"><span Class="bold">--icmp-recv-time </span><span class="bold"><span Class="emphasis">timestamp</span></span> (ICMP Receive Timestamp) </p>
<p class="level1">This option sets the Receive Timestamp in ICMP Timestamp messages. The Receive Timestamp is expressed as the number of milliseconds since midnight UTC and it corresponds to the time the echoer first touched the Timestamp message on receipt. <span Class="emphasis">timestamp</span> is as with <span Class="bold">--icmp-orig-time</span>. </p>
<p class="level0"><span Class="bold">--icmp-trans-time </span><span class="bold"><span Class="emphasis">timestamp</span></span> (ICMP Transmit Timestamp) </p>
<p class="level1">This option sets the Transmit Timestamp in ICMP Timestamp messages. The Transmit Timestamp is expressed as the number of milliseconds since midnight UTC and it corresponds to the time the echoer last touched the Timestamp message before its transmission. <span Class="emphasis">timestamp</span> is as with <span Class="bold">--icmp-orig-time</span>. </p><a name="ICMP"></a><h2 class="nroffsh">Icmp types</h2>
<p class="level0">These identifiers may be used as mnemonics for the ICMP type numbers given to the <span Class="bold">--icmp-type</span> option. In general there are three forms of each identifier: the full name (e.g. destination-unreachable), the short name (e.g. dest-unr), or the initials (e.g. du). In ICMP types that request something, the word &quot;request&quot; is omitted. </p>
<p class="level0">echo-reply, echo-rep, er </p>
<p class="level1">Echo Reply (type 0). This message is sent in response to an Echo Request message. </p>
<p class="level0">destination-unreachable, dest-unr, du </p>
<p class="level1">Destination Unreachable (type 3). This message indicates that a datagram could not be delivered to its destination. </p>
<p class="level0">source-quench, sour-que, sq </p>
<p class="level1">Source Quench (type 4). This message is used by a congested IP device to tell other device that is sending packets too fast and that it should slow down. </p>
<p class="level0">redirect, redi, r </p>
<p class="level1">Redirect (type 5). This message is normally used by routers to inform a host that there is a better route to use for sending datagrams. See also the <span Class="bold">--icmp-redirect-addr</span> option. </p>
<p class="level0">echo-request, echo, e </p>
<p class="level1">Echo Request (type 8). This message is used to test the connectivity of another device on a network. </p>
<p class="level0">router-advertisement, rout-adv, ra </p>
<p class="level1">Router Advertisement (type 9). This message is used by routers to let hosts know of their existence and capabilities. See also the <span Class="bold">--icmp-advert-lifetime</span> option. </p>
<p class="level0">router-solicitation, rout-sol, rs </p>
<p class="level1">Router Solicitation (type 10). This message is used by hosts to request Router Advertisement messages from any listening routers. </p>
<p class="level0">time-exceeded, time-exc, te </p>
<p class="level1">Time Exceeded (type 11). This message is generated by some intermediate device (normally a router) to indicate that a datagram has been discarded before reaching its destination because the IP TTL expired. </p>
<p class="level0">parameter-problem, member-pro, pp </p>
<p class="level1">Parameter Problem (type 12). This message is used when a device finds a problem with a parameter in an IP header and it cannot continue processing it. See also the <span Class="bold">--icmp-param-pointer</span> option. </p>
<p class="level0">timestamp, time, tm </p>
<p class="level1">Timestamp Request (type 13). This message is used to request a device to send a timestamp value for propagation time calculation and clock synchronization. See also the <span Class="bold">--icmp-orig-time</span>, <span Class="bold">--icmp-recv-time</span>, and <span Class="bold">--icmp-trans-time</span>. </p>
<p class="level0">timestamp-reply, time-rep, tr </p>
<p class="level1">Timestamp Reply (type 14). This message is sent in response to a Timestamp Request message. </p>
<p class="level0">information, info, i </p>
<p class="level1">Information Request (type 15). This message is now obsolete but it was originally used to request configuration information from another device. </p>
<p class="level0">information-reply, info-rep, ir </p>
<p class="level1">Information Reply (type 16). This message is now obsolete but it was originally sent in response to an Information Request message to provide configuration information. </p>
<p class="level0">mask-request, mask, m </p>
<p class="level1">Address Mask Request (type 17). This message is used to ask a device to send its subnet mask. </p>
<p class="level0">mask-reply, mask-rep, mr </p>
<p class="level1">Address Mask Reply (type 18). This message contains a subnet mask and is sent in response to a Address Mask Request message. </p>
<p class="level0">traceroute, trace, tc </p>
<p class="level1">Traceroute (type 30). This message is normally sent by an intermediate device when it receives an IP datagram with a traceroute option. ICMP Traceroute messages are still experimental, see <a href="http://www.ietf.org/rfc/rfc1393.txt">RFC 1393</a> for more information. </p><a name="ICMP"></a><h2 class="nroffsh">Icmp codes</h2>
<p class="level0">These identifiers may be used as mnemonics for the ICMP code numbers given to the <span Class="bold">--icmp-code</span> option. They are listed by the ICMP type they correspond to. </p>
<p class="level0"><br></p>
<p class="level0"><span Class="bold">Destination Unreachable</span> </p>
<p class="level1">network-unreachable, netw-unr, net </p>
<p class="level2">Code 0. Datagram could not be delivered to its destination network (probably due to some routing problem). </p>
<p class="level1">host-unreachable, host-unr, host </p>
<p class="level2">Code 1. Datagram was delivered to the destination network but it was impossible to reach the specified host (probably due to some routing problem). </p>
<p class="level1">protocol-unreachable, prot-unr, proto </p>
<p class="level2">Code 2. The protocol specified in the Protocol field of the IP datagram is not supported by the host to which the datagram was delivered. </p>
<p class="level1">port-unreachable, port-unr, port </p>
<p class="level2">Code 3. The TCP/UDP destination port was invalid. </p>
<p class="level1">needs-fragmentation, need-fra, frag </p>
<p class="level2">Code 4. Datagram had the DF bit set but it was too large for the MTU of the next physical network so it had to be dropped. </p>
<p class="level1">source-route-failed, sour-rou, routefail </p>
<p class="level2">Code 5. IP datagram had a Source Route option but a router couldn*(Aqt pass it to the next hop. </p>
<p class="level1">network-unknown, netw-unk, net? </p>
<p class="level2">Code 6. Destination network is unknown. This code is never used. Instead, Network Unreachable is used. </p>
<p class="level1">host-unknown, host-unk, host? </p>
<p class="level2">Code 7. Specified host is unknown. Usually generated by a router local to the destination host to inform of a bad address. </p>
<p class="level1">host-isolated, host-iso, isolated </p>
<p class="level2">Code 8. Source Host Isolated. Not used. </p>
<p class="level1">network-prohibited, netw-pro, !net </p>
<p class="level2">Code 9. Communication with destination network is administratively prohibited (source device is not allowed to send packets to the destination network). </p>
<p class="level1">host-prohibited, host-pro, !host </p>
<p class="level2">Code 10. Communication with destination host is administratively prohibited. (The source device is allowed to send packets to the destination network but not to the destination device.) </p>
<p class="level1">network-tos, unreachable-network-tos, netw-tos, tosnet </p>
<p class="level2">Code 11. Destination network unreachable because it cannot provide the type of service specified in the IP TOS field. </p>
<p class="level1">host-tos, unreachable-host-tos, toshost </p>
<p class="level2">Code 12. Destination host unreachable because it cannot provide the type of service specified in the IP TOS field. </p>
<p class="level1">communication-prohibited, comm-pro, !comm </p>
<p class="level2">Code 13. Datagram could not be forwarded due to filtering that blocks the message based on its contents. </p>
<p class="level1">host-precedence-violation, precedence-violation, prec-vio, violation </p>
<p class="level2">Code 14. Precedence value in the IP TOS field is not permitted. </p>
<p class="level1">precedence-cutoff, prec-cut, cutoff </p>
<p class="level2">Code 15. Precedence value in the IP TOS field is lower than the minimum allowed for the network. </p>
<p class="level0"><br></p>
<p class="level0"><span Class="bold">Redirect</span> </p>
<p class="level1">redirect-network, redi-net, net </p>
<p class="level2">Code 0. Redirect all future datagrams with the same destination network as the original datagram, to the router specified in the Address field. The use of this code is prohibited by <a href="http://www.ietf.org/rfc/rfc1812.txt">RFC 1812</a>. </p>
<p class="level1">redirect-host, redi-host, host </p>
<p class="level2">Code 1. Redirect all future datagrams with the same destination host as the original datagram, to the router specified in the Address field. </p>
<p class="level1">redirect-network-tos, redi-ntos, redir-ntos </p>
<p class="level2">Code 2. Redirect all future datagrams with the same destination network and IP TOS value as the original datagram, to the router specified in the Address field. The use of this code is prohibited by <a href="http://www.ietf.org/rfc/rfc1812.txt">RFC 1812</a>. </p>
<p class="level1">redirect-host-tos, redi-htos, redir-htos </p>
<p class="level2">Code 3. Redirect all future datagrams with the same destination host and IP TOS value as the original datagram, to the router specified in the Address field. </p>
<p class="level0"><br></p>
<p class="level0"><span Class="bold">Router Advertisement</span> </p>
<p class="level1">normal-advertisement, norm-adv, normal, zero, default, def </p>
<p class="level2">Code 0. Normal router advertisement. In Mobile IP: Mobility agent can act as a router for IP datagrams not related to mobile nodes. </p>
<p class="level1">not-route-common-traffic, not-rou, mobile-ip, !route, !commontraffic </p>
<p class="level2">Code 16. Used for Mobile IP. The mobility agent does not route common traffic. All foreign agents must forward to a default router any datagrams received from a registered mobile node </p>
<p class="level0"><br></p>
<p class="level0"><span Class="bold">Time Exceeded</span> </p>
<p class="level1">ttl-exceeded-in-transit, ttl-exc, ttl-transit </p>
<p class="level2">Code 0. IP Time To Live expired during transit. </p>
<p class="level1">fragment-reassembly-time-exceeded, frag-exc, frag-time </p>
<p class="level2">Code 1. Fragment reassembly time has been exceeded. </p>
<p class="level0"><br></p>
<p class="level0"><span Class="bold">Parameter Problem</span> </p>
<p class="level1">pointer-indicates-error, poin-ind, pointer </p>
<p class="level2">Code 0. The pointer field indicates the location of the problem. See the <span Class="bold">--icmp-param-pointer</span> option. </p>
<p class="level1">missing-required-option, miss-option, option-missing </p>
<p class="level2">Code 1. IP datagram was expected to have an option that is not present. </p>
<p class="level1">bad-length, bad-len, badlen </p>
<p class="level2">Code 2. The length of the IP datagram is incorrect. </p><a name="ARP"></a><h2 class="nroffsh">Arp mode</h2>
<p class="level0"><span Class="bold">--arp-type </span><span class="bold"><span Class="emphasis">type</span></span> (ICMP Type) </p>
<p class="level1">This option specifies which type of ARP messages should be generated. <span Class="emphasis">type</span> can be supplied in two different ways. You can use the m[blue]<span Class="bold">official numbers assigned by IANA</span>m[]s-2u[2]ds+2 (e.g. <span Class="bold">--arp-type 1</span> for ARP Request), or you can use one of the mnemonics from the section called (lqARP Types(rq. </p>
<p class="level0"><span Class="bold">--arp-sender-mac </span><span class="bold"><span Class="emphasis">mac</span></span> (Sender MAC address) </p>
<p class="level1">This option sets the Sender Hardware Address field of the ARP header. Although ARP supports many types of link layer addresses, currently Nping only supports MAC addresses. <span Class="emphasis">mac</span> must be specified using the traditional MAC notation (e.g. 00:0a:8a:32:f4:ae). You can also use hyphens as separators (e.g. 00-0a-8a-32-f4-ae). </p>
<p class="level0"><span Class="bold">--arp-sender-ip </span><span class="bold"><span Class="emphasis">addr</span></span> (Sender IP address) </p>
<p class="level1">This option sets the Sender IP field of the ARP header. <span Class="emphasis">addr</span> can be given as an IPv4 address or a hostname. </p>
<p class="level0"><span Class="bold">--arp-target-mac </span><span class="bold"><span Class="emphasis">mac</span></span> (target MAC address) </p>
<p class="level1">This option sets the Target Hardware Address field of the ARP header. </p>
<p class="level0"><span Class="bold">--arp-target-ip </span><span class="bold"><span Class="emphasis">addr</span></span> (target ip address) </p>
<p class="level1">This option sets the Target IP field of the ARP header. </p><a name="ARP"></a><h2 class="nroffsh">Arp types</h2>
<p class="level0">These identifiers may be used as mnemonics for the ARP type numbers given to the <span Class="bold">--arp-type</span> option. </p>
<p class="level0">arp-request, arp, a </p>
<p class="level1">ARP Request (type 1). ARP requests are used to translate network layer addresses (normally IP addresses) to link layer addresses (usually MAC addresses). Basically, and ARP request is a broadcasted message that asks the host in the same network segment that has a given IP address to provide its MAC address. </p>
<p class="level0">arp-reply, arp-rep, ar </p>
<p class="level1">ARP Reply (type 2). An ARP reply is a message that a host sends in response to an ARP request to provide its link layer address. </p>
<p class="level0">rarp-request, rarp, r </p>
<p class="level1">RARP Requests (type 3). RARP requests are used to translate a link layer address (normally a MAC address) to a network layer address (usually an IP address). Basically a RARP request is a broadcasted message sent by a host that wants to know his own IP address because it doesn*(Aqt have any. It was the first protocol designed to solve the bootstrapping problem. However, RARP is now obsolete and DHCP is used instead. For more information about RARP see <a href="http://www.ietf.org/rfc/rfc903.txt">RFC 903</a>. </p>
<p class="level0">rarp-reply, rarp-rep, rr </p>
<p class="level1">RARP Reply (type 4). A RARP reply is a message sent in response to a RARP request to provide an IP address to the host that sent the RARP request in the first place. </p>
<p class="level0">drarp-request, drarp, d </p>
<p class="level1">Dynamic RARP Request (type 5). Dynamic RARP is an extension to RARP used to obtain or assign a network layer address from a fixed link layer address. DRARP was used mainly in Sun Microsystems platforms in the late 90*(Aqs but now it*(Aqs no longer used. See <a href="http://www.ietf.org/rfc/rfc1931.txt">RFC 1931</a> for more information. </p>
<p class="level0">drarp-reply, drarp-rep, dr </p>
<p class="level1">Dynamic RARP Reply (type 6). A DRARP reply is a message sent in response to a RARP request to provide network layer address. </p>
<p class="level0">drarp-error, drarp-err, de </p>
<p class="level1">DRARP Error (type 7). DRARP Error messages are usually sent in response to DRARP requests to inform of some error. In DRARP Error messages, the Target Protocol Address field is used to carry an error code (usually in the first byte). The error code is intended to tell why no target protocol address is being returned. For more information see <a href="http://www.ietf.org/rfc/rfc1931.txt">RFC 1931</a>. </p>
<p class="level0">inarp-request, inarp, i </p>
<p class="level1">Inverse ARP Request (type 8). InARP requests are used to translate a link layer address to a network layer address. It is similar to RARP request but in this case, the sender of the InARP request wants to know the network layer address of another node, not its own address. InARP is mainly used in Frame Relay and ATM networks. For more information see <a href="http://www.ietf.org/rfc/rfc2390.txt">RFC 2390</a>. </p>
<p class="level0">inarp-reply, inarp-rep, ir </p>
<p class="level1">Inverse ARP Reply (type 9). InARP reply messages are sent in response to InARP requests to provide the network layer address associated with the host that has a given link layer address. </p>
<p class="level0">arp-nak, an </p>
<p class="level1">ARP NAK (type 10). ARP NAK messages are an extension to the ATMARP protocol and they are used to improve the robustness of the ATMARP server mechanism. With ARP NAK, a client can determine the difference between a catastrophic server failure and an ATMARP table lookup failure. See <a href="http://www.ietf.org/rfc/rfc1577.txt">RFC 1577</a> for more information. </p><a name="IPV4"></a><h2 class="nroffsh">Ipv4 options</h2>
<p class="level0"><span Class="bold">-S </span><span class="bold"><span Class="emphasis">addr</span></span>, <span Class="bold">--source-ip </span><span class="bold"><span Class="emphasis">addr</span></span> (Source IP Address) </p>
<p class="level1">Sets the source IP address. This option lets you specify a custom IP address to be used as source IP address in sent packets. This allows spoofing the sender of the packets. <span Class="emphasis">addr</span> can be an IPv4 address or a hostname. </p>
<p class="level0"><span Class="bold">--dest-ip </span><span class="bold"><span Class="emphasis">addr</span></span> (Destination IP Address) </p>
<p class="level1">Adds a target to Nping*(Aqs target list. This option is provided for consistency but its use is deprecated in favor of plain target specifications. See the section called (lqTARGET SPECIFICATION(rq. </p>
<p class="level0"><span Class="bold">--tos </span><span class="bold"><span Class="emphasis">tos</span></span> (Type of Service) </p>
<p class="level1">Sets the IP TOS field. The TOS field is used to carry information to provide quality of service features. It is normally used to support a technique called Differentiated Services. See <a href="http://www.ietf.org/rfc/rfc2474.txt">RFC 2474</a> for more information. <span Class="emphasis">tos</span> must be a number in the range [0(en255]. </p>
<p class="level0"><span Class="bold">--id </span><span class="bold"><span Class="emphasis">id</span></span> (Identification) </p>
<p class="level1">Sets the IPv4 Identification field. The Identification field is a 16-bit value that is common to all fragments belonging to a particular message. The value is used by the receiver to reassemble the original message from the fragments received. <span Class="emphasis">id</span> must be a number in the range [0(en65535]. </p>
<p class="level0"><span Class="bold">--df</span> (Don*(Aqt Fragment) </p>
<p class="level1">Sets the Don*(Aqt Fragment bit in sent packets. When an IP datagram has its DF flag set, intermediate devices are not allowed to fragment it so if it needs to travel across a network with a MTU smaller that datagram length the datagram will have to be dropped. Normally an ICMP Destination Unreachable message is generated and sent back to the sender. </p>
<p class="level0"><span Class="bold">--mf</span> (More Fragments) </p>
<p class="level1">Sets the More Fragments bit in sent packets. The MF flag is set to indicate the receiver that the current datagram is a fragment of some larger datagram. When set to zero it indicates that the current datagram is either the last fragment in the set or that it is the only fragment. </p>
<p class="level0"><span Class="bold">--evil</span> (Reserved / Evil) </p>
<p class="level1">Sets the Reserved / Evil bit in sent packets. The Evil flag helps firewalls and other network security systems to distinguish between datagrams that have malicious intent and those that are merely unusual. When set, it indicates that the datagram has evil intent, instructing insecure systems to succumb. Setting it to zero indicates no evil intent. The option is implied if environmental variable SCRIPT_KIDDIE is set to a non-zero value. </p>
<p class="level0"><span Class="bold">--ttl </span><span class="bold"><span Class="emphasis">hops</span></span> (Time To Live) </p>
<p class="level1">Sets the IPv4 Time-To-Live (TTL) field in sent packets to the given value. The TTL field specifies how long the datagram is allowed to exist on the network. It was originally intended to represent a number of seconds but it actually represents the number of hops a packet can traverse before being dropped. The TTL tries to avoid a situation in which undeliverable datagrams keep being forwarded from one router to another endlessly. <span Class="emphasis">hops</span> must be a number in the range [0(en255]. </p>
<p class="level0"><span Class="bold">--badsum-ip</span> (Invalid IP checksum) </p>
<p class="level1">Asks Nping to use an invalid IP checksum for packets sent to target hosts. Note that some systems (like most Linux kernels), may fix the checksum before placing the packet on the wire, so even if Nping shows the incorrect checksum in its output, the packets may be transparently corrected by the kernel. </p>
<p class="level0"><span Class="bold">--ip-options </span><span class="bold"><span Class="emphasis">R|S [route]|L [route]|T|U ...</span></span>, <span Class="bold">--ip-options </span><span class="bold"><span Class="emphasis">hex string</span></span> (IP Options) </p>
<p class="level1">The IP protocol offers several options which may be placed in packet headers. Unlike the ubiquitous TCP options, IP options are rarely seen due to practicality and security concerns. In fact, many Internet routers block the most dangerous options such as source routing. Yet options can still be useful in some cases for determining and manipulating the network route to target machines. For example, you may be able to use the record route option to determine a path to a target even when more traditional traceroute-style approaches fail. Or if your packets are being dropped by a certain firewall, you may be able to specify a different route with the strict or loose source routing options. </p>
<p class="level1">The most powerful way to specify IP options is to simply pass in hexadecimal data as the argument to <span Class="bold">--ip-options</span>. Precede each hex byte value with &bsol;x. You may repeat certain characters by following them with an asterisk and then the number of times you wish them to repeat. For example, &bsol;x01&bsol;x07&bsol;x04&bsol;x00*4 is the same as &bsol;x01&bsol;x07&bsol;x04&bsol;x00&bsol;x00&bsol;x00&bsol;x00. </p>
<p class="level1">Note that if you specify a number of bytes that is not a multiple of four, an incorrect IP header length will be set in the IP packet. The reason for this is that the IP header length field can only express multiples of four. In those cases, the length is computed by dividing the header length by 4 and rounding down. This will affect the way the header that follows the IP header is interpreted, showing bogus information in Nping or in the output of any sniffer. Although this kind of situation might be useful for some stack stress tests, users would normally want to specify explicit padding, so the correct header length is set. </p>
<p class="level1">Nping also offers a shortcut mechanism for specifying options. Simply pass the letter R, T, or U to request record-route, record-timestamp, or both options together, respectively. Loose or strict source routing may be specified with an L or S followed by a space and then a space-separated list of IP addresses. </p>
<p class="level1">For more information and examples of using IP options with Nping, see the mailing list post at m[blue]<span Class="bold">%<a href="https://seclists.org/nmap-dev/2006/q3/0052.html">https://seclists.org/nmap-dev/2006/q3/0052.html</a></span>m[]. </p>
<p class="level0"><span Class="bold">--mtu </span><span class="bold"><span Class="emphasis">size</span></span> (Maximum Transmission Unit) </p>
<p class="level1">This option sets a fictional MTU in Nping so IP datagrams larger than <span Class="emphasis">size</span> are fragmented before transmission. <span Class="emphasis">size</span> must be specified in bytes and corresponds to the number of octets that can be carried on a single link-layer frame. </p><a name="IPV6"></a><h2 class="nroffsh">Ipv6 options</h2>
<p class="level0"><span Class="bold">-6</span>, <span Class="bold">--ipv6</span> (Use IPv6) </p>
<p class="level1">Tells Nping to use IP version 6 instead of the default IPv4. It is generally a good idea to specify this option as early as possible in the command line so Nping can parse it soon and know in advance that the rest of the parameters refer to IPv6. The command syntax is the same as usual except that you also add the <span Class="bold">-6</span> option. Of course, you must use IPv6 syntax if you specify an address rather than a hostname. An address might look like <span Class="bold">3ffe:7501:4819:2000:210:f3ff:fe03:14d0</span>, so hostnames are recommended. </p>
<p class="level1">While IPv6 hasn*(Aqt exactly taken the world by storm, it gets significant use in some (usually Asian) countries and most modern operating systems support it. To use Nping with IPv6, both the source and target of your packets must be configured for IPv6. If your ISP (like most of them) does not allocate IPv6 addresses to you, free tunnel brokers are widely available and work fine with Nping. You can use the free IPv6 tunnel broker service at m[blue]<span Class="bold">%<a href="http://www.tunnelbroker.net">http://www.tunnelbroker.net</a></span>m[]. </p>
<p class="level1">Please note that IPv6 support is still highly experimental and many modes and options may not work with it. </p>
<p class="level0"><span Class="bold">-S </span><span class="bold"><span Class="emphasis">addr</span></span>, <span Class="bold">--source-ip </span><span class="bold"><span Class="emphasis">addr</span></span> (Source IP Address) </p>
<p class="level1">Sets the source IP address. This option lets you specify a custom IP address to be used as source IP address in sent packets. This allows spoofing the sender of the packets. <span Class="emphasis">addr</span> can be an IPv6 address or a hostname. </p>
<p class="level0"><span Class="bold">--dest-ip </span><span class="bold"><span Class="emphasis">addr</span></span> (Destination IP Address) </p>
<p class="level1">Adds a target to Nping*(Aqs target list. This option is provided for consistency but its use is deprecated in favor of plain target specifications. See the section called (lqTARGET SPECIFICATION(rq. </p>
<p class="level0"><span Class="bold">--flow </span><span class="bold"><span Class="emphasis">label</span></span> (Flow Label) </p>
<p class="level1">Sets the IPv6 Flow Label. The Flow Label field is 20 bits long and is intended to provide certain quality-of-service properties for real-time datagram delivery. However, it has not been widely adopted, and not all routers or endpoints support it. Check <a href="http://www.ietf.org/rfc/rfc2460.txt">RFC 2460</a> for more information. <span Class="emphasis">label</span> must be an integer in the range [0(en1048575]. </p>
<p class="level0"><span Class="bold">--traffic-class </span><span class="bold"><span Class="emphasis">class</span></span> (Traffic Class) </p>
<p class="level1">Sets the IPv6 Traffic Class. This field is similar to the TOS field in IPv4, and is intended to provide the Differentiated Services method, enabling scalable service discrimination in the Internet without the need for per-flow state and signaling at every hop. Check <a href="http://www.ietf.org/rfc/rfc2474.txt">RFC 2474</a> for more information. <span Class="emphasis">class</span> must be an integer in the range [0(en255]. </p>
<p class="level0"><span Class="bold">--hop-limit </span><span class="bold"><span Class="emphasis">hops</span></span> (Hop Limit) </p>
<p class="level1">Sets the IPv6 Hop Limit field in sent packets to the given value. The Hop Limit field specifies how long the datagram is allowed to exist on the network. It represents the number of hops a packet can traverse before being dropped. As with the TTL in IPv4, IPv6 Hop Limit tries to avoid a situation in which undeliverable datagrams keep being forwarded from one router to another endlessly. <span Class="emphasis">hops</span> must be a number in the range [0(en255]. </p><a name="ETHERNET"></a><h2 class="nroffsh">Ethernet options</h2>
<p class="level0">In most cases Nping sends packets at the raw IP level. This means that Nping creates its own IP packets and transmits them through a raw socket. However, in some cases it may be necessary to send packets at the raw Ethernet level. This happens, for example, when Nping is run under Windows (as Microsoft has disabled raw socket support since Windows XP SP2), or when Nping is asked to send ARP packets. Since in some cases it is necessary to construct ethernet frames, Nping offers some options to manipulate the different fields. </p>
<p class="level0"><span Class="bold">--dest-mac </span><span class="bold"><span Class="emphasis">mac</span></span> (Ethernet Destination MAC Address) </p>
<p class="level1">This option sets the destination MAC address that should be set in outgoing Ethernet frames. This is useful in case Nping can*(Aqt determine the next hop*(Aqs MAC address or when you want to route probes through a router other than the configured default gateway. The MAC address should have the usual format of six colon-separated bytes, e.g. 00:50:56:d4:01:98. Alternatively, hyphens may be used instead of colons. Use the word random or rand to generate a random address, and broadcast or bcast to use ff:ff:ff:ff:ff:ff. If you set up a bogus destination MAC address your probes may not reach the intended targets. </p>
<p class="level0"><span Class="bold">--source-mac </span><span class="bold"><span Class="emphasis">mac</span></span> (Ethernet Source MAC Address) </p>
<p class="level1">This option sets the source MAC address that should be set in outgoing Ethernet frames. This is useful in case Nping can*(Aqt determine your network interface MAC address or when you want to inject traffic into the network while hiding your network card*(Aqs real address. The syntax is the same as for --dest-mac. If you set up a bogus source MAC address you may not receive probe replies. </p>
<p class="level0"><span Class="bold">--ether-type </span><span class="bold"><span Class="emphasis">type</span></span> (Ethertype) </p>
<p class="level1">This option sets the Ethertype field of the ethernet frame. The Ethertype is used to indicate which protocol is encapsulated in the payload. <span Class="emphasis">type</span> can be supplied in two different ways. You can use the m[blue]<span Class="bold">official numbers listed by the IEEE</span>m[]s-2u[3]ds+2 (e.g. <span Class="bold">--ether-type 0x0800</span> for IP version 4), or one of the mnemonics from the section called (lqEthernet Types(rq. </p><a name="Ethernet"></a><h2 class="nroffsh">Ethernet types</h2>
<p class="level0">These identifiers may be used as mnemonics for the Ethertype numbers given to the <span Class="bold">--arp-type</span> option. </p>
<p class="level0">ipv4, ip, 4 </p>
<p class="level1">Internet Protocol version 4 (type 0x0800). </p>
<p class="level0">ipv6, 6 </p>
<p class="level1">Internet Protocol version 6 (type 0x86DD). </p>
<p class="level0">arp </p>
<p class="level1">Address Resolution Protocol (type 0x0806). </p>
<p class="level0">rarp </p>
<p class="level1">Reverse Address Resolution Protocol (type 0x8035). </p>
<p class="level0">frame-relay, frelay, fr </p>
<p class="level1">Frame Relay (type 0x0808). </p>
<p class="level0">ppp </p>
<p class="level1">Point-to-Point Protocol (type 0x880B). </p>
<p class="level0">gsmp </p>
<p class="level1">General Switch Management Protocol (type 0x880C). </p>
<p class="level0">mpls </p>
<p class="level1">Multiprotocol Label Switching (type 0x8847). </p>
<p class="level0">mps-ual, mps </p>
<p class="level1">Multiprotocol Label Switching with Upstream-assigned Label (type 0x8848). </p>
<p class="level0">mcap </p>
<p class="level1">Multicast Channel Allocation Protocol (type 0x8861). </p>
<p class="level0">pppoe-discovery, pppoe-d </p>
<p class="level1">PPP over Ethernet Discovery Stage (type 0x8863). </p>
<p class="level0">pppoe-session, pppoe-s </p>
<p class="level1">PPP over Ethernet Session Stage (type 0x8864). </p>
<p class="level0">ctag </p>
<p class="level1">Customer VLAN Tag Type (type 0x8100). </p>
<p class="level0">epon </p>
<p class="level1">Ethernet Passive Optical Network (type 0x8808). </p>
<p class="level0">pbnac </p>
<p class="level1">Port-based network access control (type 0x888E). </p>
<p class="level0">stag </p>
<p class="level1">Service VLAN tag identifier (type 0x88A8). </p>
<p class="level0">ethexp1 </p>
<p class="level1">Local Experimental Ethertype 1 (type 0x88B5). </p>
<p class="level0">ethexp2 </p>
<p class="level1">Local Experimental Ethertype 2 (type 0x88B6). </p>
<p class="level0">ethoui </p>
<p class="level1">OUI Extended Ethertype (type 0x88B7). </p>
<p class="level0">preauth </p>
<p class="level1">Pre-Authentication (type 0x88C7). </p>
<p class="level0">lldp </p>
<p class="level1">Link Layer Discovery Protocol (type 0x88CC). </p>
<p class="level0">mac-security, mac-sec, macsec </p>
<p class="level1">Media Access Control Security (type 0x88E5). </p>
<p class="level0">mvrp </p>
<p class="level1">Multiple VLAN Registration Protocol (type 0x88F5). </p>
<p class="level0">mmrp </p>
<p class="level1">Multiple Multicast Registration Protocol (type 0x88F6). </p>
<p class="level0">frrr </p>
<p class="level1">Fast Roaming Remote Request (type 0x890D). </p><a name="PAYLOAD"></a><h2 class="nroffsh">Payload options</h2>
<p class="level0"><span Class="bold">--data </span><span class="bold"><span Class="emphasis">hex string</span></span> (Append custom binary data to sent packets) </p>
<p class="level1">This option lets you include binary data as payload in sent packets. <span Class="emphasis">hex string</span> may be specified in any of the following formats: 0xAABBCCDDEEFF<a class="emphasis" href="#">...</a>, AABBCCDDEEFF<a class="emphasis" href="#">...</a> or &bsol;xAA&bsol;xBB&bsol;xCC&bsol;xDD&bsol;xEE&bsol;xFF<a class="emphasis" href="#">...</a>. Examples of use are <span Class="bold">--data 0xdeadbeef</span> and <span Class="bold">--data &bsol;xCA&bsol;xFE&bsol;x09</span>. Note that if you specify a number like 0x00ff no byte-order conversion is performed. Make sure you specify the information in the byte order expected by the receiver. </p>
<p class="level0"><span Class="bold">--data-string </span><span class="bold"><span Class="emphasis">string</span></span> (Append custom string to sent packets) </p>
<p class="level1">This option lets you include a regular string as payload in sent packets. <span Class="emphasis">string</span> can contain any string. However, note that some characters may depend on your system*(Aqs locale and the receiver may not see the same information. Also, make sure you enclose the string in double quotes and escape any special characters from the shell. Example: <span Class="bold">--data-string &quot;Jimmy Jazz...&quot;</span>. </p>
<p class="level0"><span Class="bold">--data-length </span><span class="bold"><span Class="emphasis">len</span></span> (Append random data to sent packets) </p>
<p class="level1">This option lets you include <span Class="emphasis">len</span> random bytes of data as payload in sent packets. <span Class="emphasis">len</span> must be an integer in the range [0(en65400]. However, values higher than 1400 are not recommended because it may not be possible to transmit packets due to network MTU limitations. </p><a name="ECHO"></a><h2 class="nroffsh">Echo mode</h2>
<p class="level0">The &quot;Echo Mode&quot; is a novel technique implemented by Nping which lets users see how network packets change in transit, from the host where they originated to the target machine. Basically, the Echo mode turns Nping into two different pieces: the Echo server and the Echo client. The Echo server is a network service that has the ability to capture packets from the network and send a copy (&quot;echo them&quot;) to the originating client through a side TCP channel. The Echo client is the part that generates such network packets, transmits them to the server, and receives their echoed version through a side TCP channel that it has previously established with the Echo server. </p>
<p class="level0">This scheme lets the client see the differences between the packets that it sends and what is actually received by the server. By having the server send back copies of the received packets through the side channel, things like NAT devices become immediately apparent to the client because it notices the changes in the source IP address (and maybe even source port). Other devices like those that perform traffic shaping, changing TCP window sizes or adding TCP options transparently between hosts, turn up too. </p>
<p class="level0">The Echo mode is also useful for troubleshooting routing and firewall issues. Among other things, it can be used to determine if the traffic generated by the Nping client is being dropped in transit and never gets to its destination or if the responses are the ones that don*(Aqt get back to it. </p>
<p class="level0">Internally, client and server communicate over an encrypted and authenticated channel, using the Nping Echo Protocol (NEP), whose technical specification can be found in m[blue]<span Class="bold">%<a href="https://nmap.org/svn/nping/docs/EchoProtoRFC.txt">https://nmap.org/svn/nping/docs/EchoProtoRFC.txt</a></span>m[] </p>
<p class="level0">The following paragraphs describe the different options available in Nping*(Aqs Echo mode. </p>
<p class="level0"><span Class="bold">--ec </span><span class="bold"><span Class="emphasis">passphrase</span></span>, <span Class="bold">--echo-client </span><span class="bold"><span Class="emphasis">passphrase</span></span> (Run Echo client) </p>
<p class="level1">This option tells Nping to run as an Echo client. <span Class="emphasis">passphrase</span> is a sequence of ASCII characters that is used used to generate the cryptographic keys needed for encryption and authentication in a given session. The passphrase should be a secret that is also known by the server, and it may contain any number of printable ASCII characters. Passphrases that contain whitespace or special characters must be enclosed in double quotes. </p>
<p class="level1">When running Nping as an Echo client, most options from the regular raw probe modes apply. The client may be configured to send specific probes using flags like <span Class="bold">--tcp</span>, <span Class="bold">--icmp</span> or <span Class="bold">--udp</span>. Protocol header fields may be manipulated normally using the appropriate options (e.g. <span Class="bold">--ttl</span>, <span Class="bold">--seq</span>, <span Class="bold">--icmp-type</span>, etc.). The only exceptions are ARP-related flags, which are not supported in Echo mode, as protocols like ARP are closely related to the data link layer and its probes can*(Aqt pass through different network segments. </p>
<p class="level0"><span Class="bold">--es </span><span class="bold"><span Class="emphasis">passphrase</span></span>, <span Class="bold">--echo-server </span><span class="bold"><span Class="emphasis">passphrase</span></span> (Run Echo server) </p>
<p class="level1">This option tells Nping to run as an Echo server. <span Class="emphasis">passphrase</span> is a sequence of ASCII characters that is used used to generate the cryptographic keys needed for encryption and authentication in a given session. The passphrase should be a secret that is also known by the clients, and it may contain any number of printable ASCII characters. Passphrases that contain whitespace or special characters must be enclosed in double quotes. Note that although it is not recommended, it is possible to use empty passphrases, supplying <span Class="bold">--echo-server &quot;&quot;</span>. However, if what you want is to set up an open Echo server, it is better to use option <span Class="bold">--no-crypto</span>. See below for details. </p>
<p class="level0"><span Class="bold">--ep </span><span class="bold"><span Class="emphasis">port</span></span>, <span Class="bold">--echo-port </span><span class="bold"><span Class="emphasis">port</span></span> (Set Echo TCP port number) </p>
<p class="level1">This option asks Nping to use the specified TCP port number for the Echo side channel connection. If this option is used with <span Class="bold">--echo-server</span>, it specifies the port on which the server listens for connections. If it is used with <span Class="bold">--echo-client</span>, it specifies the port to connect to on the remote host. By default, port number 9929 is used. </p>
<p class="level0"><span Class="bold">--nc</span>, <span Class="bold">--no-crypto</span> (Disable encryption and authentication) </p>
<p class="level1">This option asks Nping not to use any cryptographic operations during an Echo session. In practical terms, this means that the Echo side channel session data will be transmitted in the clear, and no authentication will be performed by the server or client during the session establishment phase. When <span Class="bold">--no-crypto</span> is used, the passphrase supplied with <span Class="bold">--echo-server</span> or <span Class="bold">--echo-client</span> is ignored. </p>
<p class="level1">This option must be specified if Nping was compiled without openSSL support. Note that, for technical reasons, a passphrase still needs to be supplied after the --echo-client or --echo-server flags, even though it will be ignored. </p>
<p class="level1">The --no-crypto flag might be useful when setting up a public Echo server, because it allows users to connect to the Echo server without the need for any passphrase or shared secret. However, it is strongly recommended to not use --no-crypto unless absolutely necessary. Public Echo servers should be configured to use the passphrase &quot;public&quot; or the empty passphrase (--echo-server &quot;&quot;) as the use of cryptography does not only provide confidentiality and authentication but also message integrity. </p>
<p class="level0"><span Class="bold">--once</span> (Serve one client and quit) </p>
<p class="level1">This option asks the Echo server to quit after serving one client. This is useful when only a single Echo session wants to be established as it eliminates the need to access the remote host to shutdown the server. </p>
<p class="level0"><span Class="bold">--safe-payloads</span> (Zero application data before echoing a packet) </p>
<p class="level1">This option asks the Echo server to erase any application layer data found in client packets before echoing them. When the option is enabled, the Echo server parses the packets received from Echo clients and tries to determine if they contain data beyond the transport layer. If such data is found, it is overwritten with zeroes before transmitting the packets to the appropriate Echo client. </p>
<p class="level1">Echo servers can handle multiple simultaneous clients running multiple echo sessions in parallel. In order to determine which packet needs to be echoed to which client and through which session, the Echo server uses an heuristic algorithm. Although we have taken every security measure that we could think of to prevent that a client receives an echoed packet that it did not generate, there is always a risk that our algorithm makes a mistake and delivers a packet to the wrong client. The --safe-payloads option is useful for public echo servers or critical deployments where that kind of mistake cannot be afforded. </p>
<p class="level0">The following examples illustrate how Nping*(Aqs Echo mode can be used to discover intermediate devices. </p>
<p class="level0"><span Class="bold">Example&nbsp;2.&nbsp;Discovering NAT devices</span> </p><pre class="level1">
&nbsp;   &#35; <span class="bold">nping --echo-client &quot;public&quot; echo.nmap.org --udp </span>
&nbsp;
&nbsp;   Starting Nping ( https://nmap.org/nping )
&nbsp;   SENT (1.0970s) UDP 10.1.20.128:53 &gt; 178.79.165.17:40125 ttl=64 id=32523 iplen=28 
&nbsp;   CAPT (1.1270s) UDP 80.38.10.21:45657 &gt; 178.79.165.17:40125 ttl=54 id=32523 iplen=28 
&nbsp;   RCVD (1.1570s) ICMP 178.79.165.17 &gt; 10.1.20.128 Port unreachable (type=3/code=3) ttl=49 id=16619 iplen=56 
&nbsp;   [...]
&nbsp;   SENT (5.1020s) UDP 10.1.20.128:53 &gt; 178.79.165.17:40125 ttl=64 id=32523 iplen=28 
&nbsp;   CAPT (5.1335s) UDP 80.38.10.21:45657 &gt; 178.79.165.17:40125 ttl=54 id=32523 iplen=28 
&nbsp;   RCVD (5.1600s) ICMP 178.79.165.17 &gt; 10.1.20.128 Port unreachable (type=3/code=3) ttl=49 id=16623 iplen=56 
&nbsp;    
&nbsp;   Max rtt: 60.628ms | Min rtt: 58.378ms | Avg rtt: 59.389ms
&nbsp;   Raw packets sent: 5 (140B) | Rcvd: 5 (280B) | Lost: 0 (0.00%)| Echoed: 5 (140B) 
&nbsp;   Tx time: 4.00459s | Tx bytes/s: 34.96 | Tx pkts/s: 1.25
&nbsp;   Rx time: 5.00629s | Rx bytes/s: 55.93 | Rx pkts/s: 1.00
&nbsp;   Nping done: 1 IP address pinged in 6.18 seconds
&nbsp;   
</pre>

<p class="level0">The output clearly shows the presence of a NAT device in the client*(Aqs local network. Note how the captured packet (CAPT) differs from the SENT packet: the source address for the original packets is in the reserved 10.0.0.0/8 range, while the address seen by the server is 80.38.10.21, the Internet side address of the NAT device. The source port was also modified by the device. The line starting with RCVD corresponds to the responses generated by the TCP/IP stack of the machine where the Echo server is run. </p>
<p class="level0"><span Class="bold">Example&nbsp;3.&nbsp;Discovering a transparent proxy</span> </p><pre class="level1">
&nbsp;   &#35; <span class="bold">nping --echo-client &quot;public&quot; echo.nmap.org --tcp -p80</span>
&nbsp;
&nbsp;   Starting Nping ( https://nmap.org/nping )
&nbsp;   SENT (1.2160s) TCP 10.0.1.77:41659 &gt; 178.79.165.17:80 S ttl=64 id=3317 iplen=40  seq=567704200 win=1480 
&nbsp;   RCVD (1.2180s) TCP 178.79.165.17:80 &gt; 10.0.1.77:41659 SA ttl=128 id=13177 iplen=44  seq=3647106954 win=16384 &lt;mss 1460&gt;
&nbsp;   SENT (2.2150s) TCP 10.0.1.77:41659 &gt; 178.79.165.17:80 S ttl=64 id=3317 iplen=40  seq=567704200 win=1480 
&nbsp;   SENT (3.2180s) TCP 10.0.1.77:41659 &gt; 178.79.165.17:80 S ttl=64 id=3317 iplen=40  seq=567704200 win=1480 
&nbsp;   SENT (4.2190s) TCP 10.0.1.77:41659 &gt; 178.79.165.17:80 S ttl=64 id=3317 iplen=40  seq=567704200 win=1480 
&nbsp;   SENT (5.2200s) TCP 10.0.1.77:41659 &gt; 178.79.165.17:80 S ttl=64 id=3317 iplen=40  seq=567704200 win=1480 
&nbsp;    
&nbsp;   Max rtt: 2.062ms | Min rtt: 2.062ms | Avg rtt: 2.062ms
&nbsp;   Raw packets sent: 5 (200B) | Rcvd: 1 (46B) | Lost: 4 (80.00%)| Echoed: 0 (0B) 
&nbsp;   Tx time: 4.00504s | Tx bytes/s: 49.94 | Tx pkts/s: 1.25
&nbsp;   Rx time: 5.00618s | Rx bytes/s: 9.19 | Rx pkts/s: 0.20
&nbsp;   Nping done: 1 IP address pinged in 6.39 seconds
&nbsp;   
</pre>

<p class="level0">In this example, the output is a bit more tricky. The absence of error messages shows that the Echo client has successfully established an Echo session with the server. However, no CAPT packets can be seen in the output. This means that none of the transmitted packets reached the server. Interestingly, a TCP SYN-ACK packet was received in response to the first TCP-SYN packet (and also, it is known that the target host does not have port 80 open). This behavior reveals the presence of a transparent web proxy cache server (which in this case is an old MS ISA server). </p><a name="TIMING"></a><h2 class="nroffsh">Timing and performance options</h2>
<p class="level0"><span Class="bold">--delay </span><span class="bold"><span Class="emphasis">time</span></span> (Delay between probes) </p>
<p class="level1">This option lets you control for how long will Nping wait before sending the next probe. Like in many other ping tools, the default delay is one second. <span Class="emphasis">time</span> must be a positive integer or floating point number. By default it is specified in seconds, however you can give an explicit unit by appending ms for milliseconds, s for seconds, m for minutes, or h for hours (e.g. 2.5s, 45m, 2h). </p>
<p class="level0"><span Class="bold">--rate </span><span class="bold"><span Class="emphasis">rate</span></span> (Send probes at a given rate) </p>
<p class="level1">This option specifies the number of probes that Nping should send per second. This option and <span Class="bold">--delay</span> are inverses; <span Class="bold">--rate 20</span> is the same as <span Class="bold">--delay 0.05</span>. If both options are used, only the last one in the parameter list counts. </p><a name="MISCELLANEOUS"></a><h2 class="nroffsh">Miscellaneous options</h2>
<p class="level0"><span Class="bold">-h</span>, <span Class="bold">--help</span> (Display help) </p>
<p class="level1">Displays help information and exits. </p>
<p class="level0"><span Class="bold">-V</span>, <span Class="bold">--version</span> (Display version) </p>
<p class="level1">Displays the program*(Aqs version number and quits. </p>
<p class="level0"><span Class="bold">-c </span><span class="bold"><span Class="emphasis">rounds</span></span>, <span Class="bold">--count </span><span class="bold"><span Class="emphasis">rounds</span></span> (Stop after a given number of rounds) </p>
<p class="level1">This option lets you specify the number of times that Nping should loop over target hosts (and in some cases target ports). Nping calls these (lqrounds(rq. In a basic execution with only one target (and only one target port in TCP/UDP modes), the number of rounds matches the number of probes sent to the target host. However, in more complex executions where Nping is run against multiple targets and multiple ports, the number of rounds is the number of times that Nping sends a complete set of probes that covers all target IPs and all target ports. For example, if Nping is asked to send TCP SYN packets to hosts 192.168.1.0-255 and ports 80 and 433, then 256 (mu 2&nbsp;=&nbsp;512 packets are sent in one round. So if you specify <span Class="bold">-c 100</span>, Nping will loop over the different target hosts and ports 100 times, sending a total of 256 (mu 2 (mu 100&nbsp;=&nbsp;51200 packets. By default Nping runs for 5 rounds. If a value of 0 is specified, Nping will run continuously. </p>
<p class="level0"><span Class="bold">-e </span><span class="bold"><span Class="emphasis">name</span></span>, <span Class="bold">--interface </span><span class="bold"><span Class="emphasis">name</span></span> (Set the network interface to be used) </p>
<p class="level1">This option tells Nping what interface should be used to send and receive packets. Nping should be able to detect this automatically, but it will tell you if it cannot. <span Class="emphasis">name</span> must be the name of an existing network interface with an assigned IP address. </p>
<p class="level0"><span Class="bold">--privileged</span> (Assume that the user is fully privileged) </p>
<p class="level1">Tells Nping to simply assume that it is privileged enough to perform raw socket sends, packet sniffing, and similar operations that usually require special privileges. By default Nping quits if such operations are requested by a user that has no root or administrator privileges. This option may be useful on Linux, BSD or similar systems that can be configured to allow unprivileged users to perform raw-packet transmissions. The <span Class="bold">NPING_PRIVILEGED</span> environment variable may be set as an alternative to using <span Class="bold">--privileged</span>. </p>
<p class="level0"><span Class="bold">--unprivileged</span> (Assume that the user lacks raw socket privileges) </p>
<p class="level1">This option is the opposite of <span Class="bold">--privileged</span>. It tells Nping to treat the user as lacking network raw socket and sniffing privileges. This is useful for testing, debugging, or when the raw network functionality of your operating system is somehow broken. The <span Class="bold">NPING_UNPRIVILEGED</span> environment variable may be set as an alternative to using <span Class="bold">--unprivileged</span>. </p>
<p class="level0"><span Class="bold">--send-eth</span> (Use raw ethernet sending) </p>
<p class="level1">Asks Nping to send packets at the raw ethernet (data link) layer rather than the higher IP (network) layer. By default, Nping chooses the one which is generally best for the platform it is running on. Raw sockets (IP layer) are generally most efficient for Unix machines, while ethernet frames are required for Windows operation since Microsoft disabled raw socket support. Nping still uses raw IP packets despite this option when there is no other choice (such as non-ethernet connections). </p>
<p class="level0"><span Class="bold">--send-ip</span> (Send at raw IP level) </p>
<p class="level1">Asks Nping to send packets via raw IP sockets rather than sending lower level ethernet frames. It is the complement to the <span Class="bold">--send-eth</span> option. </p>
<p class="level0"><span Class="bold">--bpf-filter </span><span class="bold"><span Class="emphasis">filter spec</span></span> <span Class="bold">--filter </span><span class="bold"><span Class="emphasis">filter spec</span></span> (Set custom BPF filter) </p>
<p class="level1">This option lets you use a custom BPF filter. By default Nping chooses a filter that is intended to capture most common responses to the particular probes that are sent. For example, when sending TCP packets, the filter is set to capture packets whose destination port matches the probe*(Aqs source port or ICMP error messages that may be generated by the target or any intermediate device as a result of the probe. If for some reason you expect strange packets in response to sent probes or you just want to sniff a particular kind of traffic, you can specify a custom filter using the BPF syntax used by tools like tcpdump. See the documentation at m[blue]<span Class="bold">%<a href="http://www.tcpdump.org/">http://www.tcpdump.org/</a></span>m[] for more information. </p>
<p class="level0"><span Class="bold">-H</span>, <span Class="bold">--hide-sent</span> (Do not display sent packets) </p>
<p class="level1">This option tells Nping not to print information about sent packets. This can be useful when using very short inter-probe delays (i.e., when flooding), because printing information to the standard output has a computational cost and disabling it can probably speed things up a bit. Also, it may be useful when using Nping to detect active hosts or open ports (e.g. sending probes to all TCP ports in a /24 subnet). In that case, users may not want to see thousands of sent probes but just the replies generated by active hosts. </p>
<p class="level0"><span Class="bold">-N</span>, <span Class="bold">--no-capture</span> (Do not attempt to capture replies) </p>
<p class="level1">This option tells Nping to skip packet capture. This means that packets in response to sent probes will not be processed or displayed. This can be useful when doing flooding and network stack stress tests. Note that when this option is specified, most of the statistics shown at the end of the execution will be useless. This option does not work with TCP Connect mode. </p><a name="OUTPUT"></a><h2 class="nroffsh">Output options</h2>
<p class="level0"><span Class="bold">-v</span><span class="bold">[<span Class="emphasis">level</span>]</span>, <span Class="bold">--verbose </span><span class="bold">[<span Class="emphasis">level</span>]</span> (Increase or set verbosity level) </p>
<p class="level1">Increases the verbosity level, causing Nping to print more information during its execution. There are 9 levels of verbosity (-4 to 4). Every instance of <span Class="bold">-v</span> increments the verbosity level by one (from its default value, level 0). Every instance of option <span Class="bold">-q</span> decrements the verbosity level by one. Alternatively you can specify the level directly, as in <span Class="bold">-v3</span> or <span Class="bold">-v-1</span>. These are the available levels: </p>
<p class="level1">Level -4 </p>
<p class="level2">No output at all. In some circumstances you may not want Nping to produce any output (like when one of your work mates is watching over your shoulder). In that case level -4 can be useful because although you won*(Aqt see any response packets, probes will still be sent. </p>
<p class="level1">Level -3 </p>
<p class="level2">Like level -4 but displays fatal error messages so you can actually see if Nping is running or it failed due to some error. </p>
<p class="level1">Level -2 </p>
<p class="level2">Like level -3 but also displays warnings and recoverable errors. </p>
<p class="level1">Level -1 </p>
<p class="level2">Displays traditional run-time information (version, start time, statistics, etc.) but does not display sent or received packets. </p>
<p class="level1">Level 0 </p>
<p class="level2">This is the default verbosity level. It behaves like level -1 but also displays sent and received packets and some other important information. </p>
<p class="level1">Level 1 </p>
<p class="level2">Like level 0 but it displays detailed information about timing, flags, protocol details, etc. </p>
<p class="level1">Level 2 </p>
<p class="level2">Like level 1 but displays very detailed information about sent and received packets and other interesting information. </p>
<p class="level1">Level 3 </p>
<p class="level2">Like level 2 but also displays the raw hexadecimal dump of sent and received packets. </p>
<p class="level1">Level 4 and higher </p>
<p class="level2">Same as level 3. </p>
<p class="level0"><span Class="bold">-q</span><span class="bold">[<span Class="emphasis">level</span>]</span>, <span Class="bold">--reduce-verbosity </span><span class="bold">[<span Class="emphasis">level</span>]</span> (Decrease verbosity level) </p>
<p class="level1">Decreases the verbosity level, causing Nping to print less information during its execution. </p>
<p class="level0"><span Class="bold">-d</span><span class="bold">[<span Class="emphasis">level</span>]</span> (Increase or set debugging level) </p>
<p class="level1">When even verbose mode doesn*(Aqt provide sufficient data for you, debugging is available to flood you with much more! As with the <span Class="bold">-v</span>, debugging is enabled with a command-line flag <span Class="bold">-d</span> and the debug level can be increased by specifying it multiple times. There are 7 debugging levels (0 to 6). Every instance of <span Class="bold">-d</span> increments debugging level by one. Provide an argument to <span Class="bold">-d</span> to set the level directly; for example <span Class="bold">-d4</span>. </p>
<p class="level1">Debugging output is useful when you suspect a bug in Nping, or if you are simply confused as to what Nping is doing and why. As this feature is mostly intended for developers, debug lines aren*(Aqt always self-explanatory. You may get something like </p><pre class="level2">
NSOCK (1.0000s) Callback: TIMER SUCCESS for EID 12; tcpconnect_event_handler(): Received callback of type TIMER with status SUCCESS
</pre>

<p class="level1">If you don*(Aqt understand a line, your only recourses are to ignore it, look it up in the source code, or request help from the development list (nmap-dev). Some lines are self-explanatory, but the messages become more obscure as the debug level is increased. These are the available levels: </p>
<p class="level1">Level 0 </p>
<p class="level2">Level 0. No debug information at all. This is the default level. </p>
<p class="level1">Level 1 </p>
<p class="level2">In this level, only very important or high-level debug information will be printed. </p>
<p class="level1">Level 2 </p>
<p class="level2">Like level 1 but also displays important or medium-level debug information </p>
<p class="level1">Level 3 </p>
<p class="level2">Like level 2 but also displays regular and low-level debug information. </p>
<p class="level1">Level 4 </p>
<p class="level2">Like level 3 but also displays messages only a real Nping freak would want to see. </p>
<p class="level1">Level 5 </p>
<p class="level2">Like level 4 but it enables basic debug information related to external libraries like Nsock. </p>
<p class="level1">Level 6 </p>
<p class="level2">Like level 5 but it enables full, very detailed, debug information related to external libraries like Nsock. </p><a name="BUGS"></a><h2 class="nroffsh">Bugs</h2>
<p class="level0">Like its authors, Nping isn*(Aqt perfect. But you can help make it better by sending bug reports or even writing patches. If Nping doesn*(Aqt behave the way you expect, first upgrade to the latest version available from m[blue]<span Class="bold">%<a href="https://nmap.org">https://nmap.org</a></span>m<span Class="bold">%<a href="http://issues.nmap.org">http://issues.nmap.org</a></span>. If the problem persists, do some research to determine whether it has already been discovered and addressed. Try searching for the problem or error message on Google since that aggregates so many forums. If nothing comes of this, create an Issue on our tracker (m[blue][]m[]) and/or mail a bug report to &lt;dev@nmap.org&gt;. If you subscribe to the nmap-dev list before posting, your message will bypass moderation and get through more quickly. Subscribe at m[blue]<span Class="bold">%<a href="https://nmap.org/mailman/listinfo/dev">https://nmap.org/mailman/listinfo/dev</a></span>m[]. Please include everything you have learned about the problem, as well as what version of Nping you are using and what operating system version it is running on. Other suggestions for improving Nping may be sent to the Nmap dev mailing list as well. </p>
<p class="level0">If you are able to write a patch improving Nping or fixing a bug, that is even better! Instructions for submitting patches or git pull requests are available from m[blue]<span Class="bold">%<a href="https://github.com/nmap/nmap/blob/master/CONTRIBUTING.md">https://github.com/nmap/nmap/blob/master/CONTRIBUTING.md</a></span>m[] </p>
<p class="level0">Particularly sensitive issues such as a security reports may be sent directly to Fyodor directly at &lt;fyodor@nmap.org&gt;. All other reports and comments should use the dev list or issue tracker instead because more people read, follow, and respond to those. </p><a name="AUTHORS"></a><h2 class="nroffsh">Authors</h2>
<p class="level0">Luis MartinGarcia &lt;luis.mgarc@gmail.com&gt; (m[blue]<span Class="bold">%<a href="http://www.luismg.com">http://www.luismg.com</a></span>m[]) </p>
<p class="level0">Fyodor &lt;fyodor@nmap.org&gt; (m[blue]<span Class="bold">%<a href="https://insecure.org">https://insecure.org</a></span>m[]) </p><a name="NOTES"></a><h2 class="nroffsh">Notes</h2>
<p class="level0"><a name=""></a><span class="nroffip"> 1. 4</span> </p>
<p class="level1">official type numbers assigned by IANA </p>
<p class="level2">%<a href="http://www.iana.org/assignments/icmp-parameters">http://www.iana.org/assignments/icmp-parameters</a> </p>
<p class="level0"><a name=""></a><span class="nroffip"> 2. 4</span> </p>
<p class="level1">official numbers assigned by IANA </p>
<p class="level2">%<a href="http://www.iana.org/assignments/arp-parameters/">http://www.iana.org/assignments/arp-parameters/</a> </p>
<p class="level0"><a name=""></a><span class="nroffip"> 3. 4</span> </p>
<p class="level1">official numbers listed by the IEEE </p>
<p class="level2">%<a href="http://standards.ieee.org/regauth/ethertype/eth.txt">http://standards.ieee.org/regauth/ethertype/eth.txt</a> </p><p class="roffit">
 This HTML page was made with <a href="http://daniel.haxx.se/projects/roffit/">roffit</a>.
