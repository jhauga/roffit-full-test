<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
 "http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<title>"nmap" man page</title>
<meta name="generator" content="roffit">
<STYLE type="text/css">
pre {
  overflow: auto;
  margin: 0;
}

P.level0, pre.level0 {
 padding-left: 2em;
}

P.level1, pre.level1 {
 padding-left: 4em;
}

P.level2, pre.level2 {
 padding-left: 6em;
}

span.emphasis {
 font-style: italic;
}

span.bold {
 font-weight: bold;
}

span.manpage {
 font-weight: bold;
}

h2.nroffsh {
 background-color: #e0e0e0;
}

span.nroffip {
 font-weight: bold;
 font-size: 120%;
 font-family: monospace;
}

p.roffit {
 text-align: center;
 font-size: 80%;
}
</STYLE>
</head><body>
<a name=""></a><h2 class="nroffsh">НАЗВАНИЕ</h2>
<p class="level0">nmap - Утилита для исследования сети и сканер портов </p><a name=""></a><h2 class="nroffsh">СИНТАКСИС</h2>
<p class="level0"><span Class="bold">nmap</span> [<span Class="emphasis">Тип&nbsp;сканирования</span>...] [<a class="emphasis" href="#">Опции</a>] {<span Class="emphasis">цель&nbsp;сканирования</span>} </p><a name=""></a><h2 class="nroffsh">ОПИСАНИЕ</h2>
<p class="level0">Nmap («Network Mapper») - это утилита с открытым исходным кодом для исследования сети и проверки безопасности. Она была разработана для быстрого сканирования больших сетей, хотя прекрасно справляется и с единичными целями. Nmap использует &quot;сырые&quot; IP пакеты оригинальным способом, чтобы определить какие хосты доступны в сети, какие службы (название приложения и версию) они предлагают, какие операционные системы (и версии ОС) они используют, какие типы пакетных фильтров/брандмауэров используются и еще множество других характеристик. В то время, как Nmap обычно используется для проверки безопасности, многие системные администраторы находят ее полезной для обычных задач, таких как контролирование структуры сети, управление расписаниями запуска служб и учет времени работы хоста или службы. </p>
<p class="level0">Выходные данные Nmap это список просканированных целей с дополнительной информацией по каждой из них в зависимости от заданных опций. Ключевой информацией является «таблица важных портов». Эта таблица содержит номер порта, протокол, имя службы и состояние. Состояние может иметь значение open (открыт), filtered (фильтруется), closed (закрыт) или unfiltered (не фильтруется). Открыт означает, что приложение на целевой машине готово для установки соединения/принятия пакетов на этот порт. Фильтруется означает, что брандмауэр, сетевой фильтр, или какая-то другая помеха в сети блокирует порт, и Nmap не может установить открыт этот порт или закрыт. Закрытые порты не связаны ни с каким приложением, но могут быть открыты в любой момент. Порты расцениваются как не фильтрованные, когда они отвечают на запросы Nmap, но Nmap не может определить открыты они или закрыты. Nmap выдает комбинации открыт|фильтруется и закрыт|фильтруется, когда не может определить, какое из этих двух состояний описывает порт. Эта таблица также может предоставлять детали о версии программного обеспечения, если это было запрошено. Когда осуществляется сканирование по IP протоколу (<span Class="bold">-sO</span>), Nmap предоставляет информацию о поддерживаемых протоколах, а не об открытых портах. </p>
<p class="level0">В дополнение к таблице важных портов Nmap может предоставлять дальнейшую информацию о целях: преобразованные DNS имена, предположение об используемой операционной системе, типы устройств и MAC адреса. </p>
<p class="level0">Типичное сканирование с использованием Nmap показано в Пример 1. Единственные аргументы, использованные в этом примере - это <span Class="bold">-A</span>, для определения версии ОС, сканирования с использованием скриптов и трассировки; <span Class="bold">-T4</span> для более быстрого выполнения; затем два целевых хоста. </p>
<p class="level0"><a class="bold" href="#">Пример 1. Типичный пример сканирования с помощью Nmap</a> </p><pre class="level1">
&#35; nmap -A -T4 scanme.nmap.org playground
&nbsp;
Starting Nmap ( https://nmap.org )
Interesting ports on scanme.nmap.org (64.13.134.52):
(The 1663 ports scanned but not shown below are in state: filtered)
PORT    STATE  SERVICE VERSION
22/tcp  open   ssh     OpenSSH 3.9p1 (protocol 1.99)
53/tcp  open   domain
70/tcp  closed gopher
80/tcp  open   http    Apache httpd 2.0.52 ((Fedora))
113/tcp closed auth
Device type: general purpose
Running: Linux 2.4.X|2.5.X|2.6.X
OS details: Linux 2.4.7 - 2.6.11, Linux 2.6.0 - 2.6.11
&nbsp;
Interesting ports on playground.nmap.org (192.168.0.40):
(The 1659 ports scanned but not shown below are in state: closed)
PORT     STATE SERVICE       VERSION
135/tcp  open  msrpc         Microsoft Windows RPC
139/tcp  open  netbios-ssn
389/tcp  open  ldap?
445/tcp  open  microsoft-ds  Microsoft Windows XP microsoft-ds
1002/tcp open  windows-icfw?
1025/tcp open  msrpc         Microsoft Windows RPC
1720/tcp open  H.323/Q.931   CompTek AquaGateKeeper
5800/tcp open  vnc-http      RealVNC 4.0 (Resolution 400x250; VNC port: 5900)
5900/tcp open  vnc           VNC (protocol 3.8)
MAC Address: 00:A0:CC:63:85:4B (Lite-on Communications)
Device type: general purpose
Running: Microsoft Windows NT/2K/XP
OS details: Microsoft Windows XP Pro RC1+ through final release
Service Info: OSs: Windows, Windows XP
&nbsp;
Nmap finished: 2 IP addresses (2 hosts up) scanned in 88.392 seconds
</pre>

<p class="level0">Самую новую версию Nmap можно скачать с m[blue]<span Class="bold">%<a href="https://nmap.org">https://nmap.org</a></span>m[]. Самая новая версия страницы справки Nmap (man page) расположена по адресу m[blue]<span Class="bold">%<a href="https://nmap.org/book/man.html">https://nmap.org/book/man.html</a></span>m[]. </p><a name=""></a><h2 class="nroffsh">ЗАМЕЧАНИЯ О ПЕРЕВОДЕ</h2>
<p class="level0">Гуз Александр (Guz Alexander) &lt;kalimatas@gmail.com&gt; </p>
<p class="level0">Этот русский вариант Справочного Руководства Nmap является переводом версии 6184 m[blue]<a class="bold" href="#">оригинальной английской версии</a>m[]s-2u[1]ds+2. Хотя я надеюсь, что данный перевод сделает Nmap более доступным для русскоязычных пользователей, я не могу гарантировать, что он является полным или является переводом последней официальной английской версии. Эту работу можно модифицировать и(или) распространять на основе лицензии m[blue]<a class="bold" href="#Creative">Creative Commons Attribution License</a>m[]s-2u[2]ds+2. </p>
<p class="level0">Марк Бруцкий (Mark Brutsky) &lt;hackcat.dev@gmail.com&gt; </p>
<p class="level0">Этот русский вариант Справочного Руководства Nmap является переводом версии 6184 m[blue]<a class="bold" href="#">оригинальной английской версии</a>m[]s-2u[1]ds+2. Хотя я надеюсь, что данный перевод сделает Nmap более доступным для русскоязычных пользователей, я не могу гарантировать, что он является полным или является переводом последней официальной английской версии. Эту работу можно модифицировать и(или) распространять на основе лицензии m[blue]<a class="bold" href="#Creative">Creative Commons Attribution License</a>m[]s-2u[2]ds+2. </p><a name=""></a><h2 class="nroffsh">СВОДКА ОПЦИЙ</h2>
<p class="level0">Эта сводка опций выводится на экран, когда Nmap запускается без каких-либо опций; последняя версия всегда доступна здесь m[blue]<span Class="bold">%<a href="https://nmap.org/data/nmap.usage.txt">https://nmap.org/data/nmap.usage.txt</a></span>m[]. Эта сводка помогает людям запомнить наиболее употребляемые опции, но она не может быть заменой документации, предоставленной в данном руководстве. Некоторые опции не включены в этот список. </p><pre class="level1">
Nmap 4.76 ( https://nmap.org )
Использование: nmap [Тип(ы) Сканирования] [Опции] {цель сканирования}
ОПРЕДЕЛЕНИЕ ЦЕЛИ СКАНИРОВАНИЯ:
&nbsp; Можно использовать сетевые имена, IP адреса, сети и т.д.
&nbsp; Пример: scanme.nmap.org, microsoft.com/24, 192.168.0.1; 10.0.0-255.1-254
&nbsp; -iL &lt;имя_входного_файла&gt;: Использовать список хостов/сетей из файла
&nbsp; -iR &lt;количество_хостов&gt;: Выбрать произвольные цели
&nbsp; --exclude &lt;хост1[,хост2][,хост3],...&gt;: Исключить хосты/сети
&nbsp; --excludefile &lt;имя_файла&gt;: Исключить из сканирования список хостов/сетей, находящийся в файле
ОБНАРУЖЕНИЕ ХОСТОВ:
&nbsp; -sL: Сканирование с целью составления списка - просто составить список целей для сканирования
&nbsp; -sP: Пинг сканирование - просто определить, работает ли хост
&nbsp; -PN: Расценивать все хосты как работающие - пропустить обнаружение хостов
&nbsp; -PS/PA/PU [список_портов]: TCP SYN/ACK или UDP пингование заданных хостов
&nbsp; -PE/PP/PM: Пингование с использованием ICMP-эхо запросов, запросов временной метки и сетевой маски 
&nbsp; -PO [список_протоколов]: Пингование с использованием IP протокола
&nbsp; -n/-R: Никогда не производить DNS разрешение/Всегда производить разрешение [по умолчанию: иногда]
&nbsp; --dns-servers &lt;сервер1[,сервер2],...&gt;: Задать собственные DNS сервера для разрешения доменных имён
&nbsp; --system-dns: Использовать системный DNS-преобразователь
РАЗЛИЧНЫЕ ПРИЕМЫ СКАНИРОВАНИЯ:
&nbsp; -sS/sT/sA/sW/sM: TCP SYN/с использованием системного вызова Connect()/ACK/Window/Maimon сканирования
&nbsp; -sU: UDP сканирование
&nbsp; -sN/sF/sX: TCP Null, FIN и Xmas сканирования
&nbsp; --scanflags &lt;флаги&gt;: Задать собственные TCP флаги
&nbsp; -sI &lt;зомби_хост[:порт]&gt;: &quot;Ленивое&quot; (Idle) сканирование
&nbsp; -sO: Сканирование IP протокола 
&nbsp; -b &lt;FTP_хост&gt;: FTP bounce сканирование
&nbsp; --traceroute: Трассировка пути к хосту
&nbsp; --reason: Выводить причину, почему Nmap установил порт в определенном состоянии
ОПРЕДЕЛЕНИЕ ПОРТОВ И ПОРЯДКА СКАНИРОВАНИЯ: 
&nbsp; -p &lt;диапазон_портов&gt;: Сканирование только определенных портов
&nbsp;   Пример: -p22; -p1-65535; -p U:53,111,137,T:21-25,80,139,8080
&nbsp; -F: Быстрое сканирование - Сканирование ограниченного количества портов
&nbsp; -r: Сканировать порты последовательно - не использовать случайный порядок портов
&nbsp; --top-ports &lt;количество_портов&gt;: Сканировать &lt;количество_портов&gt; наиболее распространенных портов
&nbsp; --port-ratio &lt;рейтинг&gt;: Сканировать порты с рейтингом большим, чем &lt;рейтинг&gt;
ОПРЕДЕЛЕНИЕ СЛУЖБ И ИХ ВЕРСИЙ:
&nbsp; -sV: Исследовать открытые порты для определения информации о службе/версии
&nbsp; --version-intensity &lt;уровень&gt;: Устанавливать от 0 (легкое) до 9 (пробовать все запросы)
&nbsp; --version-light: Ограничиться наиболее легкими запросами (интенсивность 2)
&nbsp; --version-all: Использовать каждый единичный запрос (интенсивность 9)
&nbsp; --version-trace: Выводить подробную информацию о процессе сканирования (для отладки)
СКАНИРОВАНИЕ С ИПОЛЬЗОВАНИЕМ СКРИПТОВ:
&nbsp; -sC: эквивалентно опции --script=default
&nbsp; --script=&lt;Lua скрипты&gt;: &lt;Lua скрипты&gt; - это разделенный запятыми список директорий, файлов скриптов или 
&nbsp; категорий скриптов
&nbsp; --script-args=&lt;имя1=значение1,[имя2=значение2,...]&gt;: Передача аргументов скриптам
&nbsp; --script-trace: Выводить все полученные и отправленные данные
&nbsp; --script-updatedb: Обновить базу данных скриптов
ОПРЕДЕЛЕНИЕ ОС:
&nbsp; -O: Активировать функцию определения ОС
&nbsp; --osscan-limit: Использовать функцию определения ОС только для &quot;перспективных&quot; хостов
&nbsp; --osscan-guess: Угадать результаты определения ОС
ОПЦИИ УПРАВЛЕНИЯ ВРЕМЕНЕМ И ПРОИЗВОДИТЕЛЬНОСТЬЮ:
&nbsp; Опции, принимающие аргумент &lt;время&gt;, задаются в миллисекундах, пока вы не добавите *(Aqs*(Aq (секунды), *(Aqm*(Aq (минуты), 
&nbsp; или *(Aqh*(Aq (часы) к значению (напр. 30m).
&nbsp; -T[0-5]: Установить шаблон настроек управления временем (больше - быстрее)
&nbsp; --min-hostgroup/max-hostgroup &lt;кол_хостов&gt;: Установить размер групп для параллельного сканирования
&nbsp; --min-parallelism/max-parallelism &lt;количество_запросов&gt;: Регулирует распараллеливание запросов
&nbsp; --min-rtt-timeout/max-rtt-timeout/initial-rtt-timeout &lt;время&gt;: Регулирует время ожидания ответа на запрос
&nbsp; --max-retries &lt;количество_попыток&gt;: Задает максимальное количество повторных передач запроса
&nbsp; --host-timeout &lt;время&gt;: Прекращает сканирование медленных целей
&nbsp; --scan-delay/--max-scan-delay &lt;время&gt;: Регулирует задержку между запросами
&nbsp; --min-rate &lt;число&gt;: Посылать запросы с интенсивностью не меньше чем &lt;число&gt; в секунду
&nbsp; --max-rate &lt;число&gt;: Посылать запросы с интенсивностью не больше чем &lt;число&gt; в секунду
ОБХОД БРАНДМАУЭРОВ/IDS:
&nbsp; -f; --mtu &lt;значение&gt;: Фрагментировать пакеты (опционально с заданным значениме MTU)
&nbsp; -D &lt;фикт_хост1,фикт_хост2[,ME],...&gt;: Маскировка сканирования с помощью фиктивных хостов
&nbsp; -S &lt;IP_адрес&gt;: Изменить исходный адрес
&nbsp; -e &lt;интерфейс&gt;: Использовать конкретный интерфейс
&nbsp; -g/--source-port &lt;номер_порта&gt;: Использовать заданный номер порта
&nbsp; --data-length &lt;число&gt;: Добавить произвольные данные к посылаемым пакетам
&nbsp; --ip-options &lt;опции&gt;: Посылать пакет с заданным ip опциями
&nbsp; --ttl &lt;значение&gt;: Установить IP поле time-to-live (время жизни)
&nbsp; --spoof-mac &lt;MAC_адрес/префикс/название производителя&gt;: Задать собственный MAC адрес
&nbsp; --badsum: Посылать пакеты с фиктивными TCP/UDP контрольными суммами
ВЫВОД РЕЗУЛЬТАТОВ:
&nbsp; -oN/-oX/-oS/-oG &lt;файл&gt;: Выводить результаты нормального, XML, s|&lt;rIpt kIddi3,
&nbsp;    и Grepable формата вывода, соответственно, в заданный файл
&nbsp; -oA &lt;базовове_имя_файла&gt;: Использовать сразу три основных формата вывода 
&nbsp; -v: Увеличить уровень вербальности (задать дважды или более для увеличения эффекта)
&nbsp; -d[уровень]: Увеличить или установить уровень отладки (до 9)
&nbsp; --open: Показывать только открытые (или возможно открытые) порты
&nbsp; --packet-trace: Отслеживание принятых и переданных пакетов
&nbsp; --iflist: Вывести список интерфейсов и роутеров (для отладки)
&nbsp; --log-errors: Записывать ошибки/предупреждения в выходной файл нормального режима
&nbsp; --append-output: Добавлять выходные данные в конец, а не перезаписывать выходные файлы
&nbsp; --resume &lt;имя_файла&gt;: Продолжить прерванное сканирование
&nbsp; --stylesheet &lt;путь/URL&gt;: Устанавливает XSL таблицу стилей для преобразования XML вывода в HTML
&nbsp; --webxml: Загружает таблицу стилей с Nmap.Org
&nbsp; --no-stylesheet: Убрать объявление XSL таблицы стилей из XML
РАЗЛИЧНЫЕ ОПЦИИ:
&nbsp; -6: Включить IPv6 сканирование
&nbsp; -A: Активировать функции определения ОС и версии, сканирование с использованием скриптов и трассировку
&nbsp; --datadir &lt;имя_директории&gt;: Определяет место расположения файлов Nmap
&nbsp; --send-eth/--send-ip: Использовать сырой уровень Ethernet/IP
&nbsp; --privileged: Подразумевать, что у пользователя есть все привилегии
&nbsp; --unprivileged: Подразумевать, что у пользователя нет привилегий для использования сырых сокетов
&nbsp; -V: Вывести номер версии
&nbsp; -h: Вывести эту страницу помощи
ПРИМЕРЫ:
&nbsp; nmap -v -A scanme.nmap.org
&nbsp; nmap -v -sP 192.168.0.0/16 10.0.0.0/8
&nbsp; nmap -v -iR 10000 -PN -p 80
ДЛЯ СПРАВКИ ПО ДРУГИМ ОПЦИЯМ, ОПИСАНИЙ И ПРИМЕРОВ СМОТРИТЕ MAN СТРАНИЦУ
&nbsp;
</pre>
<a name=""></a><h2 class="nroffsh">ОПРЕДЕЛЕНИЕ ЦЕЛИ СКАНИРОВАНИЯ</h2>
<p class="level0">В командной строке Nmap все, что не является опцией (или аргументом опции), рассматривается как цель сканирования. В простейшем случае для сканирования используется IP адрес или сетевое имя целевой машины. </p>
<p class="level0">Иногда необходимо просканировать целую сеть. Для этого Nmap поддерживает CIDR адресацию. </p>
<p class="level0">Вы можете добавить /<span Class="emphasis">кол-во бит</span> к IP адресу или сетевому имени и Nmap просканирует каждый IP адрес, для которого первые <span Class="emphasis">кол-во бит</span> такие же как и у заданного хоста. Например, 192.168.10.0/24 просканирует 256 хостов между 192.168.10.0 (бинарное: 11000000 10101000 00001010 00000000) и 192.168.10.255 (бинарное: 11000000 10101000 00001010 11111111) включительно. 192.168.10.40/24 сделает абсолютно то же самое. Зная, что IP адрес scanme.nmap.org 64.13.134.52, при записи типа scanme.nmap.org/16 будет произведено сканирование 65,536 IP адресов между 64.13.0.0 и 64.13.255.255. Наименьшее допустимое значение /0, при котором будет просканирован весь Интернет. Наибольшее значение /32, при котором будет просканирован только заданный хост или IP адрес, т.к. все адресные биты заблокированы. </p>
<p class="level0">CIDR нотация коротка, однако не всегда достаточно гибка. Например, вы хотите просканировать 192.168.0.0/16, но пропустить все IP-адреса, оканчивающиеся на .0 или .255, т.к. обычно это широковещательные адреса. Nmap может осуществить такое сканирование путем задания диапазонов в октетах. Вместо определния обычного IP адреса, вы можете определить для каждого октета либо разделенный запятыми список чисел, либо диапазон. Например, 192.168.0-255.1-254 пропустит все адреса в диапазоне оканчивающиеся на .0 и .255. Диапазоны не обязательно задавать только в последних октетах: при записи 0-255.0-255.13.37 будет произведено сканирование всех адресов в Интернете оканчивающихся на 13.37. Такой тип сканирования может быть полезен для исселедования просторов Интернета. </p>
<p class="level0">IPv6 адреса могут быть определны только в форме, полностью соответствующей правильной форме записи IPv6 адресов. CIDR и использование диапазонов в октетах не применимо к IPv6 адресам, т.к. они редко используются. </p>
<p class="level0">Вы можете передавать в командной строке Nmap различные варианты определения целей, не обязательно одного типа. Команда <span Class="bold">nmap scanme.nmap.org 192.168.0.0/16 10.0.0,1,3-7.0-255</span> сделает то, что вы ожидаете. </p>
<p class="level0">Цели сканирования обычно задаются в командной строке, и существуют различные опции контроля выбора целей: </p>
<p class="level0"><span Class="bold">-iL </span><span class="bold"><a class="emphasis" href="#">имя_файла</a></span> (Ввод из списка) </p>
<p class="level1">Считывает цели из <a class="emphasis" href="#">имя_файла</a>. Хотя передача большого списка хостов для сканирования является обычным явлением, это не удобно. Например, ваш DHCP сервер передают вам список из 10,000 используемых им на данный момент адресов, и вы хотите его просканировать. Или, возможно, вы хотите просканировать все IP адреса, <a class="emphasis" href="#">кроме</a> переданных им, чтобы выявить несанкционированное использование статических IP адресов. Просто сгенерируйте список хостов для сканирования и передайте имя файла в Nmap как аргумент для опции<span Class="bold">-iL</span>. Записи в файле могут находиться в любой приемлимой для Nmap форме (IP адреса, сетевые имена, CIDR, IPv6, или диапазоны в октетах). Каждая запись должна быть отделена пробелом или несколькими, символами табуляции либо символами перехода на новую строку. Вы можете передать в качестве аргумента дефис(-) как имя файла, если хотите, чтобы Nmap считывал список хостов из стандартного ввода, а не из файла. </p>
<p class="level0"><span Class="bold">-iR </span><span class="bold"><span Class="emphasis">кол-во хостов</span></span> (Выбирает произвольные цели) </p>
<p class="level1">Для сканирования в пределах всего Интернета или каких-либо исследований, вам, возможно, понадобится выбрать цели произвольно. Аргумент <span Class="emphasis">кол-во хостов</span> определяет сколько необходимо сгенерировать IP адресов. Неподходящие IP адреса, такие как частные, широковещательные или нелокализованные диапазоны адресов автоматически пропускаются. Аргумент 0 может быть передан для бесконечного сканирования. Имейте в виду, что некоторым системным администраторам может не понравиться неразрешенное сканирование их сетей и они могут пожаловаться. Используйте эту опцию на свой страх и риск! Если в дождливый денек вам будет скучно, попробуйте команду <span Class="bold">nmap -sS -PS80 -iR 0 -p 80</span> </p>
<p class="level1">для сканирования произвольных веб-серверов. </p>
<p class="level0"><span Class="bold">--exclude </span><span class="bold"><span Class="emphasis">хост1</span></span><span class="bold">[,<span Class="emphasis">хост2</span>[,...]]</span> (Исключить хосты/сети) </p>
<p class="level1">Определяет разделенный запятыми список целей, которые необходимо исключить из сканирования, даже если они являются частью заданного вами диапазона сканирования. Передаваемый список использует стандартный синтаксис Nmap, поэтому может содержать сетевые имена, CIDR адресацию, диапазоны в октетах и т.д. Эта опция может быть полезна, если сеть, которую вы хотите просканировать, содержит сервера или системы, негативно реагирующие на сканирование портов, или подсети, администрируемые другими людьми. </p>
<p class="level0"><span Class="bold">--excludefile </span><span class="bold"><a class="emphasis" href="#">имя_файла</a></span> (Исключить список из файла) </p>
<p class="level1">Эта опция делает то же самое, что и <span Class="bold">--exclude</span>, за исключением того, что цели для исключения находятся в разделенном пробелами, символами табуляции или символами перехода на новую строку <a class="emphasis" href="#">файле</a>, а не в командной строке. </p><a name=""></a><h2 class="nroffsh">ОБНАРУЖЕНИЕ ХОСТОВ</h2>
<p class="level0">Одна из первейших задач при исследовании любой сети это сократить (иногда довольно большой) набор IP диапазонов до списка активных или интересных хостов. Сканирование каждого порта каждого IP адреса медленно и необязательно. Конечно же то, что делает хост интересным для исселедования во многом определяется целями сканирования. Сетевые администраторы возможно будут заинтересованы только в хостах, на которых запущена определенная служба, в то время как тем, кого интересует безопасность, будут интересны все устройства с IP адресами. Задачи администраторов по обнаружению работающих хостов в сети могут быть удовлетворены обычным ICMP пингом, людям же, которые тестируют способность сети противостоять атакам из вне, необходимо использовать разнообразные наборы запросов с целью обхода брандмауэра. </p>
<p class="level0">Посколько задачи, требующие обнаружения хостов столь различны, Nmap предоставляет большое разнообразие опций для различных методов. Задачу обнаружения хостов иногда называют пинг сканированием (ping scan), однако она намного превосходит использование обычных ICMP запросов ассоциирующихся с вездесущими ping утилитами. Пользователи могут полностью пропустить шаг пинг сканирования с помощью опции сканирования с целью составления списка (<span Class="bold">-sL</span>) или просто отключив его (<span Class="bold">-PN</span>), или сканировать сеть с помощью произвольных комбинаций мультипортовых TCP SYN/ACK, UDP и ICMP запросов. Целью всех этих запросов является получение ответов, указывающих, что IP адрес в настоящее время активен (используется хостом или сетевым устройством). В большинстве сетей лишь небольшой процент IP адресов активен постоянно. Это особенно характерно для адресных пространств вида 10.0.0.0/8. Такие сети имеют 16 млн. IP адресов, но я видел, как они используются компаниями, в которых не более тысячи машин. Функция обнаружения хостов может найти эти машины в этом необъятном море IP адресов. </p>
<p class="level0">Если не задано никаких опций обнаружения хостов, то Nmap посылает TCP ACK пакет на порт 80 и запрос на ICMP эхо ответ кажодй целевой машине. Исключение составляет ARP сканировании всех целей в сети. Для непривилегированных пользователей Unix оболочки, вместо ACK пакета посылается SYN используя системный вызов <span Class="bold">connect</span> Эти умолчания равнозначны опциям <span Class="bold">-PA -PE</span>. Такое сканирование достаточно для локальных сетей, но для исследования безопасности необходимо использовать более сложные наборы запросов. </p>
<p class="level0">Опции <span Class="bold">-P*</span> (определяющие тип пинг сканирования) могут комбинироваться. Вы можете увеличить шансы обхода строго брандмауэра посылая множество запросов различных типов, используя различные TCP порты/флаги и ICMP коды. Также имейте в виду, что даже если вы определите различные <span Class="bold">-P*</span> опции, по умолчанию применительно к целям локальной сети будет производиться и ARP сканирование (<span Class="bold">-PR</span>), т.к. оно почти всегда быстрее и более эффективно. </p>
<p class="level0">По умолчанию после обнаружения хостов Nmap начинает сканирование портов каждой активной машины. Так будет, даже если вы укажите на использование нестандартных методов обнаружения хостов, например, с использованием UDP запросов (<span Class="bold">-PU</span>). Прочтите об опции <span Class="bold">-sP</span>, чтобы узнать, как выполнить только обнаружение хостов, или используйте опцию <span Class="bold">-PN</span>, чтобы пропустить обнаружение хостов и осуществить сканирование портов всех целевых машин. С помощью следующих опций можно настраивать функцию обнаружения хостов: </p>
<p class="level0"><span Class="bold">-sL</span> (Сканирование с целью составления списка) </p>
<p class="level1">Это тип сканирования является &quot;упрощенной&quot; версией функции обнаружения хостов, при помощи которого просто будет создан список хостов заданной сети без посылки каких-либо пакетов целевым машинам. По умолчанию Nmap все же будет осуществлять обратное разрешение DNS с целью узнавания имен хостов. Часто бывает удивительно, как много полезной информации могут содержать обычные имена хостов. Например, fw.chi это имя брандмауэра одной Чикагской компании. </p>
<p class="level1">В конце Nmap также сообщает общее количество IP адресов. Этот тип сканирования также является хорошим способом проверить, что вы действительно знаете IP адреса необходимых вам целей. Если имена хостов содержат неизвестные вам доменные имена, то стоит провести дальнейшее исследование, чтобы избежать сканирования сети не той компании, которая вам нужна. </p>
<p class="level1">Т.к. целью является просто составление списка целевых хостов, то опции с большим уровнем функциональности, такие как сканирование портов, определение ОС или пинг сканирование не могут сочетаться с рассматриваемой опцией. Если вы хотите отключить пинг сканирование, но хотите использовать опции с таким высоким уровнем функциональности, то почитайте об опции <span Class="bold">-PN</span>. </p>
<p class="level0"><span Class="bold">-sP</span> (Пинг сканирование) </p>
<p class="level1">Эта опция указывает Nmap произвести пинг сканирование (определение хостов), а затем вывести список доступных хостов, т.е. тех, которые ответили на запросы. Определение маршрутов и NSE скрипты также используются, если необходимо, однако дальнейшее тестирование (как сканирование портов или определение ОС) не производится. По умолчанию эта опция считается как бы на один шаг более тщательной, чем сканирование с целью составления простого списка хостов, и может быть использована в этих же целях. Она позволяет произвести исследование целевой сети без привлечения внимания. Знание, какие хосты в сети в данный момент работают, для атакующих ценне, чем просто список IP адресов и сетевых имен, предоставляемых опцией -sL. </p>
<p class="level1">Эта опция также полезна системным администраторам. Она может быть использована для подсчета количества работающих в сети машин или мониторинга доступности сервера. Это часто называют &quot;пинг чисткой&quot; (ping sweep) и результаты, предоставляемые этой опцией, заслуживают больше доверия, чем обычное пингование широковещательных адресов, т.к. большинство хостов не отвечают на подобные запросы. </p>
<p class="level1">По умолчанию опцией <span Class="bold">-sP</span> посылаются запрос на ICMP это ответ и TCP ACK пакет на порт 80. Когда используется непривилегированным пользователем, посылается только SYN пакет (используя системные вызов <span Class="bold">connect</span>) на порт 80 целевой машины. Когда привилегированный пользователь производит сканирование целей локальной сети, то используются ARP запросы до тех пор, пока не будет задано <span Class="bold">--send-ip</span>. Для большей гибкости опция <span Class="bold">-sP</span> может быть скомбинирована с любой из опций <span Class="bold">-P*</span> (за исключением <span Class="bold">-PN</span>). Если используется какой-либо из этих типов запросов и опции для задания номеров портов, то запросы по умолчанию (ACK и это ответы) опускаются. Когда между машиной с Nmap и целевой сетью расположен строгий брандмауэр, то рекомедуется использование таких расширенных методов сканирования. Иначе некоторые из хостов могут быть не определены, т.к. брандмауэр заблокировал запрос или ответ. </p>
<p class="level0"><span Class="bold">-PN</span> (Не использовать пинг сканирование) </p>
<p class="level1">Указывает Nmap полностью пропустить этап обнаружения хостов. Обычно, Nmap использует этот этап для обнаружения активных машин, к которым можно применить более углубленное сканирование. По умолчанию Nmap производит углубленное сканирование, такое как сканирование портов, определение версии или определение ОС только обнаруженных работающих хостов. После отключения этапа обнаружения хостов опцией <span Class="bold">-PN</span>, Nmap будет производить сканирование <a class="emphasis" href="#">каждого</a> заданого целевого IP адреса. Так что, если для сканирования будет определена сеть с адресным пространством класса B (/16), то будет произведено сканирование всех 65,536 IP адресов. Т.к. этап обнаружения хостов и составления списка целей сканирования пропущен, то Nmap будет исполнять запрошенные функции, как если бы каждый IP адрес был активен. Для машин локальной сети будет произведено ARP сканирование (пока не зададите <span Class="bold">--send-ip</span>), т.к. Nmap необходимы MAC адреса для дальнейшего сканирования целевых хостов. Раньше эта опция задавалась флагом <span Class="bold">P0</span> (используется нуль), но была переименова, чтобы избежать путаницы с пингованием с использованием IP протокола <span Class="bold">PO</span> (используется буква O). </p>
<p class="level0"><span Class="bold">-PS </span><span class="bold"><a class="emphasis" href="#">список_портов</a></span> (TCP SYN пингование) </p>
<p class="level1">Эта опция посылает пустой TCP пакет с установленным SYN флагом. Порт по умолчанию - 80 (можно задать во время компилирования изменяя <span Class="emphasis">DEFAULT_TCP_PROBE_PORT_SPEC</span> </p>
<p class="level1">в nmap.h). </p>
<p class="level1">Альтернативные порты задаются в качестве параметров. Синтаксис такой же как и для опции <span Class="bold">-p</span> за исключением того, что спецификаторы типа T: недопустимы. Примеры: <span Class="bold">-PS22</span> и <span Class="bold">-PS22-25,80,113,1050,35000</span>. Имейте в виду, что между списком портов и <span Class="bold">-PS</span> не должно быть пробела. Если заданы несколько запросов, то они будут посланы параллельно. </p>
<p class="level1">Установленные флаг SYN указывает удаленной системе, что вы пытаетесь установить соединение. Если порт назначения закрыт, то в ответ посылается RST (сброс) пакет. Если порт открыт, то удаленная система предпримет второй шаг в 3-ех этапной последовательности установки TCP соединения путем ответа </p>
<p class="level1">SYN/ACK TCP пакетом. Система, на которой работает Nmap, сбрасывает почти установленное соединение отвечая RST пакетом вместо ACK, что привело бы к установке полного соединения. RST пакет посылается ядром системы, на которой работает Nmap, в ответ на непредвиденный SYN/ACK пакет, а не самой Nmap. </p>
<p class="level1">Nmap не важно открыт порт или закрыт. Ответы пакетами RST или SYN/ACK описанными выше, указывают Nmap на то, что хост доступен и может отвечать на запросы. </p>
<p class="level1">На Unix машинах, только пользователь с правами root, как правило, может посылать и принимать сырые TCP пакеты. Для непривилегированного пользователя для каждого целевого порта инициируется системный вызов <span Class="bold">connect</span>. Поэтому при попытке установить соединение на целевой хост посылается SYN пакет. Если на вызов <span Class="bold">connect</span> приходит быстрый ответ или отказ типа ECONNREFUSED, значит TCP стек получил SYN/ACK или RST пакет, и хост помечается как доступный. Если соединение не устанавливается по причине истечения времени (timeout), то хост помечается как не работающий. Этот механизм также используется для соединений с использованием протокола IPv6, т.к. построение сырых пакетов IPv6 еще не реализовано в Nmap. </p>
<p class="level0"><span Class="bold">-PA </span><span class="bold"><a class="emphasis" href="#">список_портов</a></span> (TCP ACK пингование) </p>
<p class="level1">Этот тип пингования очень похож на описанный выше. Разница состоит в том, как вы могли догадаться, что вместо установки SYN флага устанавливается TCP ACK флаг. Такой ACK пакет имеет своей целью распознавание данных во время установленного TCP соединения, но такого соединения не существует, поэтому удаленные хосты всегда будут отвечат на такой запрос RST пакетом, тем самым выдавая свое существование. </p>
<p class="level1">Опция <span Class="bold">-PA</span> использует тот же порт по умолчанию, что и SYN запросы (80), и так же может принимать в качестве параметра список портов в том же формате. Если эту опцию пытается использовать непривилегированный пользователь или задана цель в формате IPv6, то используется механизм с использованием вызова <span Class="bold">connect</span> описанный выше. Этот механизм несовершенен, т.к. при использовании вызова <span Class="bold">connect</span> вместо ACK пакета посылается SYN. </p>
<p class="level1">Причина, по которой Nmap предоставляет оба типа пингования (SYN и ACK), состоит в повышении шансов обхода брандмауэров. Многие администраторы конфигурируют роутеры или другие простые брандмауэры на блокировку входящих SYN пакетов за исключением тех, что предназначены для публичных служб, таких как веб сайт или почтовый сервер. Тем самым предотвращаются все остальные соединения, и в то же время пользователи могут беспрепятственно выходить в Интернет. Такой подход не требует много ресурсов от брандмауэров/роутеров и широко поддерживается различными аппаратными и программными фильтрами. </p>
<p class="level1">для реализации такого подхода имеет опцию <span Class="bold">--syn</span>. Когда брандмауэр использует такие правила, то запросы с установленным флагом SYN (<span Class="bold">-PS</span>), посланные на закрытые порты, с большой вероятностью будут заблокированы. В таких случаях более выгодно использовать запросы с флагом ACK, т.к. они не попадают под эти правила. </p>
<p class="level1">Другим популярным типом сетевого экрана является брандмауэр блокирующий все непредвиденные пакеты. Изначально эта функция поддерживалась только в наиболее продвинутых брандмауэрах, хотя с годами она становится все популярнее. Использующийся в Linux сетевой экран Netfilter/iptables реализует этот механизм с помощью опции <span Class="bold">--state</span>, которая категоризирует пакеты в зависимости от состояния соединения. Против таких систем лучше использовать пакеты SYN, т.к. непредвиденные пакеты ACK с большой вероятностью будут распознаны как фиктивные и заблокированы. Решение такого затруднительного положение состоит в том, чтобы посылать и SYN и ACK запросы путем задания опций <span Class="bold">-PS</span> и <span Class="bold">-PA</span>. </p>
<p class="level0"><span Class="bold">-PU </span><span class="bold"><a class="emphasis" href="#">список_портов</a></span> (UDP пингование) </p>
<p class="level1">Еще одной функцией используемой для обнаружения хостов является UDP пингование, которая посылает пустой (пока не задана опция <span Class="bold">--data-length</span>) UDP пакет на данные порты. Список портов задается в том же формает, что и для описанных выше опций <span Class="bold">-PS</span> и <span Class="bold">-PA</span>. Если порты не заданы, то по умолчанию используется 31338. Порт по умолчанию может быть задан во время компиляции путем изменения <span Class="emphasis">DEFAULT_UDP_PROBE_PORT_SPEC</span> в nmap.h. </p>
<p class="level1">По умолчанию выбран не распростаненный порт, т.к. отправка запросов на открытые порты нежелательна для этого типа сканирования. </p>
<p class="level1">Целью запроса UDP является получение в ответ ICMP пакета с ошибкой &quot;порт недостижим&quot;. Это указывает Nmap на то, что машина работает и доступна. Другие типы ICMP ошибок, такие как хост/сеть недоступна или превышение TTL указывают на то, что машина выключена или недоступна. Отсутствие ответа интерпретируется этим же путем. Если такой запрос посылается на открытый порт, то большинство служб просто игнорируют пустой пакет и не посылают никакого ответа. Поэтому портом по умолчанию является 31338, т.к. он вряд ли будет использоваться какой-либо службой. Лишь некоторые службы, такие как Character Generator (chargen) protocol, ответят на пустой UDP пакет, и это также укажет Nmap на то, что машина доступна. </p>
<p class="level1">Основным преимуществом такого типа сканирования является то, что он позволяет обходить брандмауэры, фильтрующие только TCP запросы. Например, однажды у меня был беспроводной широкополосный роутер Linksys BEFW11S4. Внутренний интерфейс этого устройства фильтровал по умолчанию все TCP порты, в то время как в ответ на UDP запросы посылалось сообщение об ошибке &quot;порт недостижим&quot;, что делало его работу бесполезной. </p>
<p class="level0"><span Class="bold">-PE</span>; <span Class="bold">-PP</span>; <span Class="bold">-PM</span> (Типы пинг пакетов ICMP) </p>
<p class="level1">В дополнении к нестандратным методам обнаружения хостов с помощью TCP и UDP запросов, Nmap может посылать и стандартные пакеты, используемые вездесущей программой ping. Nmap посылает ICMP пакет типа 8 (эхо запрос) на целевой IP адрес, ожидая в ответ от доступного хоста пакет типа 0 (эхо ответ). К сожалению для сетевых исследователей, многие хосты и брандмауэры теперь блокируют такие пакеты вместо того, чтобы ответить на них, как это требуется в m[blue]<span Class="bold"><a href="http://www.ietf.org/rfc/rfc1122.txt">RFC 1122</a></span>m[]s-2u[3]ds+2. По этой причине сканеры использующе только ICMP запросы редко бывают полезны при сканировании неизвестных целей в Интернете. Но они могут быть полезны системным администраторам, занимающимся мониторингом внутренней сети. Используйте опцию <span Class="bold">-PE</span>, чтобы активировать такой тип сканирования. </p>
<p class="level1">Но Nmap использует не только стандратный эхо запрос. В стандарте ICMP (m[blue]<span Class="bold"><a href="http://www.ietf.org/rfc/rfc792.txt">RFC 792</a></span>m[]s-2u[4]ds+2) также определены запросы временной метки, информационные запросы и запросы адресной маски с кодами 13, 15 и 17 соответственно. Хотя они служат для того, чтобы узнать какую-либо информацию, такую как адресную маску или текущее время, они могут быть легко применены для обнаружения целей. Система, которая отвечает на них, работает и доступна. В настоящее время Nmap не использует информационные запросы, т.к. они не получиил широкого распространения. Стандарт <a href="http://www.ietf.org/rfc/rfc1122.txt">RFC 1122</a> наставивает на том, что «хост НЕ ДОЛЖЕН посылать такие сообщения». Запросы временной метки или адресной маски могут быть посланы путем задания опций <span Class="bold">-PP</span> и <span Class="bold">-PM</span> соответственно. Ответ на запрос временной метки (ICMP код 14) или на запрос адресной маски (код 18) указывают на то, что хост доступен. Эти запросы могут быть полезны, когда администраторы блокируют пакеты эхо запросов, но забывают о том, что другие типы ICMP запросов могут быть использованы в тех же целях. </p>
<p class="level0"><span Class="bold">-PO </span><span class="bold"><a class="emphasis" href="#">список_протоколов</a></span> (пингование с использованием IP протокола) </p>
<p class="level1">Новейшей опцией для обнаружения хостов является пингование с использованием IP протокола, которая посылает IP пакеты с номером протокола, указанным в заголовке пакета. Список протоколов задается в том же формате, что и список портов в описанных выше опциях обнаружения хостов с помощью протоколов TCP и UDP. Если не указан ни один протокол, то по умолчанию будут использованы IP пакеты ICMP (протокол 1), IGMP (протокол 2) и IP-in-IP (протокол 4). Протоколы по умолчанию могут быть заданы во время компиляции путем изменения <span Class="emphasis">DEFAULT_PROTO_PROBE_PORT_SPEC</span> в nmap.h. Имейте в виду, что для ICMP, IGMP, TCP (протокол 6) и UDP (протокол 17), пакеты посылаются с &quot;правильными&quot; заголовками протокола, в то время как для остальных протоколов пакеты посылаются без дополнительной информации после IP заголовка (пока не задана опция <span Class="bold">--data-length</span>). </p>
<p class="level1">При использовании этого метода ожидаются ответы по протоколу исходного запроса, либо ICMP сообщение о недостижимости, что свидетельствует о том, что данный протокол не поддерживается удаленным хостом. Оба варианта ответа означают, что целевой хост доступен. </p>
<p class="level0"><span Class="bold">-PR</span> (ARP пингование) </p>
<p class="level1">Одной из наиболее популярных сфер применения Nmap является сканирование локальных сетей (LAN). В большинстве локальных сетей, особенно тех, которые используют диапазоны частных адресов определенные в m[blue]<span Class="bold"><a href="http://www.ietf.org/rfc/rfc1918.txt">RFC 1918</a></span>m[]s-2u[5]ds+2, большое количество IP адересов не используется в любой момент времени. Когда Nmap пытается послать сырой IP пакет, такой как ICMP эхо запрос, операционная система должна определить MAC-адрес (ARP) соответствующий целевому IP, чтобы правильно адресовать фрейм. Это часто бывает медленно и проблематично, т.к. операционные системы не были написаны с учетом того, что им придется посылать миллионы ARP запросов недоступным хостам в короткий промежуток времени. </p>
<p class="level1">ARP сканирование позволяет Nmap вместо ARP запросов использовать свои собственные оптимизированные алгоритмы. И если Nmap получает ответ, то ей даже нет необходимости беспокоиться о других типах обнаружения хостов, основанных на IP пакетах. Этот делает ARP сканирование более быстрым и надежным. Поэтому оно применяется по умолчанию для сканирования локальных сетей. Даже если указаны другие типы сканирования (как <span Class="bold">-PE</span> или <span Class="bold">-PS</span>), Nmap все равно использует ARP сканирование для машин локальной сети. Если вы абсолютно не хотите использовать такой тип сканирования, то задайте опцию <span Class="bold">--send-ip</span>. </p>
<p class="level0"><span Class="bold">--traceroute</span> (Отслеживать путь к хосту) </p>
<p class="level1">Отслеживание осуществляется после сканирования, используя результаты этого сканирования для определения порта и протокола, с помощью которых можно будет достичь цели. Процедура работает со всеми типами сканирования кроме сканирования с использованием системного вызова connect (<span Class="bold">-sT</span>) и &quot;ленивого&quot; (idle) сканирования (<span Class="bold">-sI</span>). Все отслеживания используют динамическую модель таймингов Nmap и осуществляются параллельно. </p>
<p class="level1">Процедура отслеживания маршрута работает путем посылки пакетов с низким TTL (time-to-live (временем-жизни) в попытке получить в ответ ICMP сообщение Time Exceeded (Превышение Времени Жизни) от промежуточных узлов между сканером и целевым хостом. Стандартные реализации процедуры отслеживания маршрута начинают с TTL равным 1, а затем увеличивают его до тех пор, пока не будет достигнут целевой хост. В реализации же этой процедуры в Nmap сначала устанавливается высокий TTL, а затем TTL уменьшается, пока не станет равным 0. Это позволяет Nmap использовать &quot;умные&quot; алгоритмы кэширования с целью увеличения скорости отслеживания маршрута. В среднем Nmap посылает 5-10 пакетов на хост, в зависимости от условий в сети. В случае сканирования единственной подсети (напр. 192.168.0.0/24), возможно будет необходимо послать только один пакет на каждый хост. </p>
<p class="level0"><span Class="bold">--reason</span> (Показать причины состояний портов и хостов) </p>
<p class="level1">Показывает информацию о причинах, по которым каждый порт установлен в какое-либо состояние, и по которым каждый хост работает или нет. Эта опция выводит тип пакета, по которому было определено состояние порта или хоста. Например, RST пакет от закрытого порта или эхо ответ от работающего хоста. Информация, которую может предоставить Nmap, определяется типом сканирования или пингования. SYN сканирование и SYN пингование (<span Class="bold">-sS</span> и <span Class="bold">-PS</span>) описываются очень детально, а информация о сканировании с использованием TCP соединений (<span Class="bold">-sT</span>) ограничена реализацией системного вызова <span Class="bold">connect</span>. Эта функция автоматически активируется при использовании опции отладки (<span Class="bold">-d</span>), и результаты ее работы хранятся в XML файлах, даже если эта опция не была задана. </p>
<p class="level0"><span Class="bold">-n</span> (Не производить разрешение DNS имен) </p>
<p class="level1">Указывает Nmap <a class="emphasis" href="#">никогда</a> не производить обратное разрешение DNS </p>
<p class="level1">имен каждого обнаруженного активного IP адереса. Преобразование DNS может быть медленным даже со встроенным в Nmap параллельным преобразователем IP адресов, поэтому данная опция может сократить время сканирования. </p>
<p class="level0"><span Class="bold">-R</span> (Производить разрешение DNS имен для всех целей) </p>
<p class="level1">Указыват Nmap <a class="emphasis" href="#">всегда</a> производить обратное разрешение DNS имен для каждого целевого IP адреса. Обычно DNS преобразование применяется только к доступным хостам. </p>
<p class="level0"><span Class="bold">--system-dns</span> (Использовать системный DNS преобразователь) </p>
<p class="level1">По умолчанию Nmap преобразует IP адреса путем посылки запросов непосредственно серверам имен, указанным в вашей системе, и последующим анализом ответов. Многие запросы (часто десятки) исполняются параллельно для увеличения производительности. Задайте эту опцию, чтобы использовать ваш системный преобразователь IP адресов (один IP адрес за один системный вызов <span Class="bold">getnameinfo</span>). Это медленно и редко бывает полезно, до тех пор, пока вы не найдете ошибку в параллельном преобразователе Nmap (если найдете, известите нас, пожалуйста). Системный преобразователь всегда используется для сканирования с использованием протокола IPv6. </p>
<p class="level0"><span Class="bold">--dns-servers </span><span class="bold"><span Class="emphasis">server1</span></span><span class="bold">[,<span Class="emphasis">server2</span>[,...]]</span><a class="bold" href="#"> </a> (Сервера для обратного разрешения DNS) </p>
<p class="level1">По умолчанию Nmap определяет DNS сервера (для разрашения rDNS) из вашего resolv.conf файла (Unix) или из реестра (Win32). Вы можете использовать эту опцию для задания альтернативных серверов. Эта опция игнорируется, если вы используете <span Class="bold">--system-dns</span> или сканирование по протоколу IPv6. Использование нескольких DNS серверов частно увеличивает скорость сканирования, особенно если вы выбираете официальные сервера для IP пространства вашей цели. Эта опция также может увеличить незаметность, т.к. ваши запросы могут быть перенаправлены любым рекурсивным DNS сервером в Интернете. </p>
<p class="level1">Эта опция также бывает полезна при сканировании частных сетей. Иногда лишь некоторые сервера имен предоставляют правильную rDNS информацию, и вы можете даже не знать, где они. Вы можете просканировать сеть на наличие открытого порта 53 (возможно с помощью фукнкции определения версии), затем попробовать составить список (<span Class="bold">-sL</span>) указывая по очереди все сервера имен в опции <span Class="bold">--dns-servers</span> до тех пор, пока не найдете тот, который работает. </p><a name=""></a><h2 class="nroffsh">ОСНОВЫ СКАНИРОВАНИЯ ПОРТОВ</h2>
<p class="level0">Хотя Nmap постоянно наращивала функциональность, изначально утилита разрабатывалась как эффективный сканер портов, и она по-прежнему сохраняет свои основные функции. Простой командой <span Class="bold">nmap </span><span class="bold"><a class="emphasis" href="#">цель сканирования</a></span> будет произведено сканирование более чем 1660 TCP портов на <a class="emphasis" href="#">целевой машине</a>. В то время как многие сканеры портов традиционно разделяют все порты на закрытые и открытые, Nmap имеет более подробную шкалу деления. Она подразделяет порты на шесть состояний: открыт, закрыт, фильтруется, не фильтурется, открыт|фильтруется или закрыт|фильтруется. </p>
<p class="level0">Эти состояния не являются собственно характеристиками самих портов, а лишь описывают, как Nmap видит их. Например, сканирование из той же сети, что и цель, может показать, что порт 135/tcp открыт, в то время как сканирование из Интернета в то же время и с теми же опциями может показать, что порт фильтруется. </p>
<p class="level0"><a class="bold" href="#">Шесть состояний портов распознаваемых Nmap</a> </p>
<p class="level0">открыт (open) </p>
<p class="level1">Приложение принимает запросы на TCP соединение или UDP пакеты на этот порт. Обнаружение этого состояния обычно является основной целью сканирования. Люди разбирающиеся в безопасности знают, что каждый открытый порт это прямой путь к осуществлению атаки. Атакующие хотят использовать открытые порты, а администраторы пытаются закрыть их или защитить с помощью брадмауэров так, чтобы не мешать работе обычных пользователей. Октрытые порты также интересны с точки зрения сканирования, не связанного с безопасностью, т.к. они позволяют определить службы доступные в сети. </p>
<p class="level0">закрыт (closed) </p>
<p class="level1">Закрытый порт доступен (он принимает и отвечает на запросы Nmap), но не используется каким-либо приложением. Они могут быть полезны для установления, что по заданному IP адресу есть работающий хост (определение хостов, ping сканирование), или для определения ОС. Т.к. эти порты достижимы, может быть полезным произвести сканирование позже, т.к. некоторые из них могут открыться. Администраторы могут заблокировать такие порты с помощью брандмауэров. Тогда их состояние будет определено как фильтруется, что обсуждается далее. </p>
<p class="level0">фильтруется (filtered) </p>
<p class="level1">Nmap не может определить, открыт ли порт, т.к. фильтрация пакетов не позволяет достичь запросам Nmap этого порта. Фильтрация может осуществляться выделенным брадмауэром, правилами роутера или брандмауэром на целевой машине. Эти порты бесполезны для атакующих, т.к. предоставляют очень мало информации. Иногда они отвечают ICMP сообщениями об ошибке, такими как тип 3 код 13 (destination unreachable: communication administratively prohibited (цель назначения недоступна: связь запрещена администратором)), но чаще встречаются фильтры, которые отбрасывают запросы без предоставления какой-либо информации. Это заставляет Nmap совершить еще несколько запросов, чтобы убедиться, что запрос был отброшен фильтром, а не затором в сети. Это очень сильно замедляет сканирование. </p>
<p class="level0">не фильтруется (unfiltered) </p>
<p class="level1">Это состояние означает, что порт доступен, но Nmap не может определить открыт он или закрыт. Только ACK сканирование, используемое для определения правил брандмауэра, может охарактеризовать порт этим состоянием. Сканирование не фильтруемых портов другими способами, такими как Window сканирование, SYN сканирование или FIN сканирование может помочь определить, является ли порт открытым. </p>
<p class="level0">открыт|фильтруется (open|filtered) </p>
<p class="level1">Nmap характеризует порт таким состоянием, когда не может определить октрыт порт или фильтруется. Это состояние возникает при таких типах сканирования, при которых открытые порты не отвечают. Отсутствие ответа также может означать, что пакетный фильтр не пропустил запрос или ответ не был получен. Поэтому Nmap не может определить наверняка открыт порт или фильтруется. При сканировании UDP, по IP протоколу, FIN, NULL, а также Xmas порт может быть охарактеризован таким состоянием. </p>
<p class="level0">закрыт|фильтруется (closed|filtered) </p>
<p class="level1">Это состояние используется, когда Nmap не может определить закрыт порт или фильтруется. Используется только при сканировании IP ID idle типа. </p><a name=""></a><h2 class="nroffsh">РАЗЛИЧНЫЕ ПРИЕМЫ СКАНИРОВАНИЯ ПОРТОВ</h2>
<p class="level0">Как новичок в автомобильном деле, я могу часами биться в попытках использовать свои элементарные инструменты (молоток, клейкая лента, гаечный ключ и т.д.) для решения какой-либо проблемы. Когда все мои попытки с крахом проваливаются, и я буксирую свою развалюху к настоящему механику, он неизменно достает из большой коробки с интрументами какую-нибудь штуковину, и сразу складывается впечатление, что решение проблемы не требует много усилий. Искусство сканирования портов очень на это похоже. Эксперты понимают дюжины различных приемов сканирования портов и выбирают для конкретной задачи подходящий (или комбинацию из нескольких). Неопытные пользователи и script kiddies, </p>
<p class="level0">пытаются решить все задачи с помощью используемого по умолчанию SYN сканирования. Т.к. Nmap является бесплатной, то единственным барьером на пути к овладению техникой сканирования портов является знание. Это все же лучше чем в мире автомобилей, где, когда вам наконец-то удается определить, что вам необходимо какое-либо устройство, вам еще надо будет заплатить за него тысячу долларов. </p>
<p class="level0">Большинство типов сканирования доступны только привилегированным пользователям, </p>
<p class="level0">потому что посылаются и принимаются сырые пакеты, </p>
<p class="level0">что требует прав пользователя root на Unix системах. Под Windows рекомендуется работать с учетной записью администратора, хотя иногда Nmap работает и с непривилегированными пользователя, когда в ОС уже загружена утилита WinPcap. Требование root привилегий было серьезным ограничением, когда Nmap была выпущена в свет в 1997, т.к. многие пользователи имели доступ только к разделяемым аккаунтам. Сейчас мир изменился. Компьютеры стали дешевле, многие пользователи имеют постоянный доступ в Интернет, а Unix системы для домашних компьютеров (включая Linux и Mac OS X) теперь широко распространены. Также теперь доступна Windows версия Nmap, что позволяет запускать ее на еще большем количестве компьютеров. По этим причинам, пользователям нет необходимости запускать Nmap с разделяемых аккаунтов. Это большая удача, т.к. функции требующие привилегированного доступа делают Nmap намного более мощной и гибкой. </p>
<p class="level0">Когда Nmap предпринимает попытку выдать правильные результаты, надо иметь ввиду, что вся информация базируется на пакетах, возвращенных целевыми машинами (или брандмауэром перед ними). Такие хосты могут быть ненадежными и посылать ответы с целью ввести Nmap в забдуждение. Намного более распространным случаем являются не совместимые с RFC хосты, которые отвечают на запросы Nmap не так, как должны. Сканирования типа FIN, NULL и Xmas наиболее восприимчивы к такого рода проблемам. Такие сложности специфичны только для определенных типов сканирования, и поэтому обсуждаются в посвященных им разделах. </p>
<p class="level0">В этом разделе описываются около дюжины способов сканирования портов поддерживаемых Nmap. В любой момент времени вы можете использовать только один метод; исключение составляет UDP сканирование (<span Class="bold">-sU</span>), которое может быть скомбинировано с любым типом TCP сканирования. В качестве памятки имейте ввиду, что различные опции сканирования портов задаются в форме <span Class="bold">-s</span><span class="bold"><span Class="emphasis">C</span></span>, где <span Class="emphasis">C</span> это символ из названия какого-либо типа сканирования, обычно первый. Единственное исключение это FTP bounce сканирование (<span Class="bold">-b</span>). По умолчанию Nmap осуществляет SYN сканирование; этот тип сканирования заменяет сканирование с использованием соединения для пользователей не имеющих достаточных привилегий для отправки сырых пакетов (требует root доступа в Unix), или если были заданы цели в формате IPv6. Среди описанных ниже типов сканирования, непривилегированные пользователи могут осуществлять только сканирование с использованием соединения и FTP bounce сканирование. </p>
<p class="level0"><span Class="bold">-sS</span> (TCP SYN сканирование) </p>
<p class="level1">SYN это используемый по умолчанию и наиболее популярный тип сканирования. На то есть несколько причин. Он может быть быстро запущен, он способен сканировать тысячи портов в секунду при быстром соединении, его работе не препятствуют ограничивающие бранмауэры. Этот тип сканирования относительно ненавящив и незаметен, т.к. при таком сканировании TCP соединение никогда не устанавливается до конца. Он работает с любым TCP стеком, не завися от каки-либо особенностей специфичной платформы, как это происходит при сканированиях типа FIN/NULL/Xmas, Maimon и idle сканировании. Он также предоставляет ясную и достоверную дифференциацию между состояниями открыт, закрыт и фильтруется. </p>
<p class="level1">Эту технику часто называют сканированием с использованием полуотрытых соединений, т.к. вы не открываете полного TCP соединения. Вы посылаете SYN пакет, как если бы вы хотели установить реальное соединение и ждете. Ответы SYN/ACK указывают на то, что порт прослушивается (открыт), а RST (сброс) на то, что не прослушивается. Если после нескольких запросов не приходит никакого ответа, то порт помечается как фильтруемый. Порт также помечается как фильтруемый, если в ответ приходит ICMP сообщение об ошибке недостижимости (тип 3, код 1,2, 3, 9, 10 или 13). </p>
<p class="level0"><span Class="bold">-sT</span> (TCP сканирование с использованием системного вызова connect) </p>
<p class="level1">Это используемый по умолчанию тип TCP сканирования, когда недоступно SYN сканирование. Это происходит в случае, когда у пользователя нет привилегий для использования сырых пакетов или при сканировании IPv6 сетей. Вместо того, чтобы использовать сырые пакеты, как это происходит при большинстве других типов сканирования, Nmap &quot;просит&quot; операционную систему установить соединение с целевой машиной по указанному порту путем системного вызова <span Class="bold">connect</span>. Это такой же высокоуровневый системный вызов, используемый браузерами, P2P клиентами и другими приложениями для установки соединения. Этот вызов является частью программируемого интерфейса, известного как Berkeley Sockets API. Вместо того, чтобы считывать ответы в форме сырых пакетов, Nmap использует этот API для получения информации о статусе каждой попытки соединения. </p>
<p class="level1">При доступности SYN сканирования, оно, безусловно, будет являться лучшм выбором. У Nmap имеется меньше возможностей контролирования высокоуровнего вызова <span Class="bold">connect</span> по сравнению с сырыми пакетами, что делает его менее эффективным. Системный вызов завершает соединения по открытым портам, вместо того, чтобы использовать полуоткрытые соединения, как в случае с SYN сканированием. Таким образом на получение той же самой информации потребуется больше времени и пакетов, да к тому же целевые машины скорее всего запишут это соединение в свои логи. То же самое сделает и порядочная IDS, хотя большинство машин не имеют такой системы защиты. Многие службы на вашей Unix системе будут добавлять запись в системный лог (syslog), а также сообщение об ошибке, когда Nmap будет устанавливать и закрывать соединение без отправления данных. Некоторые службы даже аварийно завершают свою работу, когда это происходит, хотя это не является обычной ситуацией. Администратор, который увидит в логах группу записей о попытке установки соединения от одной и той же системы, должен знать, что его машина подверглась такому типу сканирования. </p>
<p class="level0"><span Class="bold">-sU</span> (Различные типы UDP сканирования) </p>
<p class="level1">В то время как большинство сервисов Интернета используют TCP протокол, m[blue]<span Class="bold">UDP</span>m[]s-2u[6]ds+2 службы также широко распространены. Тремя наиболее популярными являются DNS, SNMP и DHCP (используют порты 53, 161/162 и 67/68). Т.к. UDP сканирование в общем случае медленнее и сложнее TCP, то многие специалисты по безопасности игнорируют эти порты. Это является ошибкой, т.к. существуют UDP службы, которые используются атакующими. К счастью, Nmap позволяет инвентаризировать UDP порты. </p>
<p class="level1">UDP сканирование запускается опцией <span Class="bold">-sU</span>. Оно может быть скомбинировано с каким-либо типом TCP сканирования, например SYN сканирование (<span Class="bold">-sS</span>), чтобы использовать оба протокола за один проход. </p>
<p class="level1">UDP сканирование работает путем посылки пустого (без данных) UDP заголовка на каждый целевой порт. Если в ответ приходит ICMP ошибка о недостижимости порта (тип 3, код 3), значит порт закрыт. Другие ICMP ошибки недостижимости (тип 3, коды 1, 2, 9, 10 или 13) указывают на то, что порт фильтруется. Иногда, служба будет отвечать UDP пакетом, указывая на то, что порт открыт. Если после нескольких попыток не было получено никакого ответа, то порт классифицируется как открыт|фильтруется. Это означает, что порт может быть открыт, или, возможно, пакетный фильтр блокирует его. Функция определения версии (<span Class="bold">-sV</span>) может быть полезна для дифференциации действительно открытых портов и фильтруемых. </p>
<p class="level1">Большой проблемой при UDP сканировании является его медленная скорость работы. Открытые и фильтруемые порты редко посылают какие-либо ответы, заставляя Nmap отправлять повторные запросы, на случай если пакеты были утеряны. Закрытые порты часто оказываются еще большей проблемой. Обычно они в ответ возвращают ICMP ошибку о недостижимости порта. Но в отличии от RST пакетов отсылаемых закрытыми TCP портами в ответ на SYN или сканирование с установкой соединения, многие хосты ограничивают лимит </p>
<p class="level1">ICMP сообщений о недостижимости порта по умолчанию. Linux и Solaris особенно строги в этом плане. Например, ядро Linux 2.4.20 огранивает количество таких сообщений до одного в секунду (в net/ipv4/icmp.c). </p>
<p class="level1">Nmap обнаруживает такого рода ограничения и соответственно сокращает количество запросов, чтобы не забивать сеть бесполезными пакетами, которые все равно будут отброшены целевой машиной. К сожалению, при ограничении в стиле Linux (один пакет в секунду) сканирование 65,536 портов займет более 18 часов. К способам увеличения скорости UDP сканирования относятся: параллельное сканирование нескольких хостов, сканирование в первую очередь только наиболее популярных портов, сканирование из-за брандмауэра и использование <span Class="bold">--host-timeout</span> дял пропуска медленных хостов. </p>
<p class="level0"><span Class="bold">-sN</span>; <span Class="bold">-sF</span>; <span Class="bold">-sX</span> (TCP NULL, FIN и Xmas сканирования) </p>
<p class="level1">Эти три типа сканирования используют (другие типы сканирования доступны с использованием опции <span Class="bold">--scanflags</span> описанной в другой секции) незаметную лазейку в m[blue]<span Class="bold">TCP RFC</span>m[]s-2u[7]ds+2, чтобы разделять порты на открытые и закрытые. На странице 65 <a href="http://www.ietf.org/rfc/rfc793.txt">RFC 793</a> говорится, что «если порт назначения ЗАКРЫТ .... входящий сегмент не содержащий RST повлечет за собой отправку RST в ответ.» На следующей странице, где обсуждается отправка пакетов без установленных битов SYN, RST или ACK, утверждается что: «вы вряд ли с этим столкнетесь, но если столкнетесь, то сбросьте сегменти и вернитесь к исходному состоянию.» </p>
<p class="level1">Когда сканируется система отвечающая требованиям RFC, любой пакет, не содержащий установленного бита SYN, RST или ACK, повлечет за собой отправку RST в ответ в случае, если порт закрыт, или не повлечет никакого ответа, если порт открыт. Т.к. ни один из этих битов не установлен, то любая комбинация трех оставшихся (FIN, PSH и URG) будет являться правильной. Nmap использует это в трех типах сканирования: </p>
<p class="level1">Null сканирование (<span Class="bold">-sN</span>) </p>
<p class="level2">Не устанавливаются никакие биты (Флагов в TCP заголовоке 0) </p>
<p class="level1">FIN сканирование (<span Class="bold">-sF</span>) </p>
<p class="level2">Устанавливается только TCP FIN бит. </p>
<p class="level1">Xmas сканирование (<span Class="bold">-sX</span>) </p>
<p class="level2">Устанавливаются FIN, PSH и URG флаги. </p>
<p class="level1">Эти три типа сканирования работают по одной схеме, различия только в TCP флагах установленных в пакетах запросов. Если в ответ приходит RST пакет, то порт считается закрытым, отсутствие ответа означает, что порт открыт|фильтруется. Порт помечается как фильтруется, если в ответ приходит ICMP ошибка о недостижимости (тип 3, код 1, 2, 3, 9, 10 или 13). </p>
<p class="level1">Ключевой особенностью этих типов сканирования является их способность незаметно обойти некоторые не учитывающие состояние (non-stateful) брандмауэры и роутеры с функцией пакетной фильтрации. Еще одним преимуществом является то, что они даже чуть более незаметны, чем SYN сканирование. Все же не надо на это полагаться - большинство современных IDS могут быть сконфигурированы на их обнаружение. Большим недостатком является то, что не все системы следуют <a href="http://www.ietf.org/rfc/rfc793.txt">RFC 793</a> дословно. Некоторые системы посылают RST ответы на запросы не зависимо от того, открыт порт или закрыт. Это приводит к тому, что все порты помечаются как закрытые. Основными системами ведущими себя подобным образом являются Microsoft Windows, многие устройства Cisco, BSDI и IBM OS/400. Хотя такое сканирование применимо к большинству систем, основанных на Unix. Еще одним недостатком этих видов сканирования является их неспособность разделять порты на открытые и фильтруемые, т.к. порт помечается как открыт|фильтруется. </p>
<p class="level0"><span Class="bold">-sA</span> (TCP ACK сканирование) </p>
<p class="level1">Этот тип сканирования сильно отличается от всех других тем, что он не способен определить открый порт open (или даже открытый|фильтруемый). Он используются для выявления правил брандмауэров, определения учитывают ли он состояние или нет, а также для определения фильтруемых ими портов. </p>
<p class="level1">Пакет запроса при таком типе сканирования содержит установленным только ACK флаг (если не используется <span Class="bold">--scanflags</span>). При сканировании нефильтруемых систем, открытые и закрытые порты оба будут возвращать в ответ RST пакет. Nmap помечает их как не фильтруемые, имея ввиду, что они достижимы для ACK пакетов, но неизвестно открыты они или закрыты. Порты, которые не отвечают или посылают в ответ ICMP сообщение об ошибке (тип 3, код 1, 2, 3, 9, 10 или 13), помечаются как фильтруемые. </p>
<p class="level0"><span Class="bold">-sW</span> (TCP Window сканирование) </p>
<p class="level1">Этот тип сканирования практически то же самое, что и ACK сканирование, за исключением того, что он использует особенности реализации различных систем для разделения портов на открытые и закрытые, вместо того, чтобы всегда при получении RST пакета выводить не фильтруется. Это осуществляется путем анализа TCP Window поля полученного в ответ RST пакета. В некоторых системах открытые порты используют положительное значение этого поля (даже в RST пакетах), а закрытые - нулевое. Поэтому вместо того, что все время при получении RST пакета в ответ помечать порты как не фильтруемые, при Window сканировании порты помечаются как открытые или закрытые, если значение поля TCP Window положительно или равно нулю соответственно. </p>
<p class="level1">Этот тип сканирования основывается на особенностях реализации меньшинства систем в Интернете, поэтому вы не можете все время доверять ему. В общем случае в системах, не имеющих таких особенностей, все порты будут помечаться как закрытые. Конечно, это возможно, что у машины действительно нет открытых портов. Если большинство просканированных портов закрыты, и лишь несколько распространненых портов (таких как 22, 25, 53) фильтруются, то скорее всего результатам сканирования можно доверять. Иногда, системы будут вести себя прямо противоположным образом. Если в результате сканирования будет найдено 1000 открытых портов и 3 закрытых или фильтруемых, то как раз эти 3 могут оказаться действительно открытыми. </p>
<p class="level0"><span Class="bold">-sM</span> (TCP сканирование Мэймона (Maimon)) </p>
<p class="level1">Этот тип сканирования носит имя своего первооткрывателя, Уриела Мэймона (Uriel Maimon). </p>
<p class="level1">Он описал эту технику в журнале Phrack Magazine, выпуск &#35;49 (Ноябрь 1996). </p>
<p class="level1">Версия Nmap с поддержкой этого типа сканирования была выпущена через два номера. Техника практически такая же как и при NULL, FIN и Xmas сканированиях, только в качестве запросов используются запросы FIN/ACK. Согласно m[blue]<span Class="bold"><a href="http://www.ietf.org/rfc/rfc793.txt">RFC 793</a></span>m[]s-2u[7]ds+2 (TCP), в ответ на такой запрос должен быть сгенерирован RST пакет, если порт открыт или закрыт. Тем не менее, Уриел заметил, что многие BSD системы просто отбрасывают пакет, если порт открыт. </p>
<p class="level0"><span Class="bold">--scanflags</span> (Заказное TCP сканирование) </p>
<p class="level1">Действительно продвинутым пользователям Nmap не нужды ограничивать себя заранее приготовленными типами сканирования. С помощью опции <span Class="bold">--scanflags</span> вы можете разработать свой тип сканирования путем задания специфичных TCP флагов. Используйте свое воображение, обходя системы обнаружения вторжений, чьи производители просто просмотрели справочное руководство Nmap, путем задания собственных правил! </p>
<p class="level1">Аргументом опции <span Class="bold">--scanflags</span> может быть числовое значение, например, 9 (PSH и FIN флаги), но использование символьных имен намного проще. Используйте любые комбинации URG, ACK, PSH, RST, SYN и FIN. Например, опцией <span Class="bold">--scanflags URGACKPSHRSTSYNFIN</span> будут установлены все флаги, хотя это и не очень полезно для сканирования. Порядок задания флагов не имеет значения. </p>
<p class="level1">В добавлении к заданию желаемых флагов, вы также можете задать тип TCP сканирования (например, <span Class="bold">-sA</span> или <span Class="bold">-sF</span>). Это укажет Nmap на то, как необходимо интерпретировать ответы. Например, при SYN сканировании отсутствие ответа указывает на фильтруемый порт, тогда как при FIN сканировании - на открытый|фильтруемый. Nmap будет осуществлять заданный тип сканирования, но используя указанные вами TCP флаги вместо стандартных. Если вы не указываете тип сканирования, то по умолчанию будет использоваться SYN. </p>
<p class="level0"><span Class="bold">-sI </span><span class="bold"><a class="emphasis" href="#">зомби_хост</a></span><span class="bold">[:<a class="emphasis" href="#">порт</a>]</span> (&quot;ленивое&quot; idle сканирование) </p>
<p class="level1">Этот продвинутый метод сканирования позволяет осуществить действительно незаметное TCP сканирование портов цели (имеется ввиду, что никакие пакеты не отсылаются на целевую машину с вашего реального IP адерса). Вместо этого, на зомби машине используется предсказуемая последовательность генерации ID IP фрагментов для сбора информации об открытых портах цели. Системы IDS будут считать, что сканирование производится с заданной вами зомби машины (которая должна работать и удовлетворять определенным критериям). Этот тип сканирования слишком сложен для описания в этом справочном руководстве, поэтому я написал и выложил подробное описание на m[blue]<span Class="bold">%<a href="https://nmap.org/book/idlescan.html">https://nmap.org/book/idlescan.html</a></span>m[]. </p>
<p class="level1">Помимо его незаметности (в силу своей природы), этот тип сканирования также позволяет определять основанные на IP доверительные отношения между машинами. Список открытых портов показывает открытые порты <a class="emphasis" href="#">с точки зрения зомби машины.</a> Поэтому вы можете попробовать просканировать цель используя различные зомби машины, которым, вы считаете, возможно будут доверять </p>
<p class="level1">(посредством правил роутера/пакетного фильтра). </p>
<p class="level1">Вы можете добавить номер порта после двоеточия к зомби хосту, если хотите использовать конкретный порт. По умолчанию будет использоваться порт 80. </p>
<p class="level1">Порты также могут быть заданы именами, которым они соответствуют в файле nmap-services. Вы даже можете использовать шаблоны * и ? в именах. Например, чтобы просканировать ftp и все порты начинающиеся с http используйте <span Class="bold">-p ftp,http*</span>. В таких случаях лучше брать аргументы -p в кавычки. </p>
<p class="level1">Диапазоны портов заключаются в квадратные скобки; будут просканированы порты из этого диапазона, встречающиеся в nmap-services. Например, с помощью следующей опции будут просканированы все порты из nmap-services равные или меньше 1024: <span Class="bold">-p [-1024]</span>. В таких случаях лучше брать аргументы -p в кавычки. </p>
<p class="level0"><span Class="bold">-sO</span> (Сканирование IP протокола) </p>
<p class="level1">Сканирование такого типа позволяет определить, какие IP протоколы (TCP, ICMP, IGMP и т.д.) поддерживаются целевыми машинами. Технически такое сканирование не является разновидностью сканирования портов, т.к. при нем циклически перебираются номера IP протоколов вместо номеров TCP или UDP портов. Хотя здесь все же используется опция <span Class="bold">-p</span> для выбора номеров протоколов для сканирования, результаты выдаются в формате таблицы портов, и даже используется тот же механизм сканирования, что и при различных вариантах сканирования портов. Поэтому он достаточно близок к сканированию портов и описывается здесь. </p>
<p class="level1">Помимо полезности непосредственно в своей сфере применения, этот тип сканирования также демонстрирует всю мощь открытого программного обеспечения (open-source software). Хотя основная идея довольна проста, я никогда не думал включить такую функцию в Nmap, и не получал запросов на это. Затем, летом 2000-го, Джерард Риджер (Gerhard Rieger) </p>
<p class="level1">развил эту идею, написал превосходный патч воплощающий ее и отослал его на nmap-hackers рассылку. Я включил этот патч в Nmap и на следующий день выпустил новую версию. Лишь единицы комерческого программного обеспечения могут похвастаться пользователями, достаточно полными энтузиазма для разработки и предоставления своих улучшений! </p>
<p class="level1">Способ работы этого типа сканирования очень похож на реализованный в UDP сканировании. Вместо того, чтобы изменять в UDP пакете поле, содержащее номер порта, отсылаются заголовки IP пакета, и изменяется 8 битное поле IP протокола. Заголовки обычно пустые, не содержащие никаких данных и даже правильного заголовка для требуемого протокола. Исключениями явлются TCP, UDP и ICMP. Включение правильного заголовка для этих протоколов необходимо, т.к. в обратном случае некоторые системы не будут их отсылать, да и у Nmap есть все необходимые функции для их создания. Вместо того, чтобы ожидать в ответ ICMP сообщение о недостижимости порта, этот тип сканирования ожидает ICMP сообщение о недостижимости <a class="emphasis" href="#">протокола</a>. Если Nmap получает любой ответ по любому протоколу, то протокол помечается как открытый. ICMP ошибка о неостижимости протокола (тип 3, код 2) помечает протокол как закрытый. Другие ICMP ошибки недостижимости (тип 3, код 1, 3, 9, 10 или 13) помечают протокол как фильтруемый (в то же время они показывают, что протокол ICMP открыт). Если не приходит никакого ответа после нескольких запросов, то протокол помечается как открыт|фильтруется . </p>
<p class="level1">&nbsp;       .RE </p>
<p class="level1"><span Class="bold">-b </span><span class="bold"><span Class="emphasis">FTP хост</span></span> (FTP bounce сканирование) </p>
<p class="level2">Интересной возможностью FTP протокола (m[blue]<span Class="bold"><a href="http://www.ietf.org/rfc/rfc959.txt">RFC 959</a></span>m[]s-2u[8]ds+2) является поддержка так называемых прокси FTP соединений. Это позволяет пользователю подключиться к одному FTP серверу, а затем попросить его передать файлы другому. Это является грубым нарушением, поэтому многие сервера прекратили поддерживать эту функцию. Используя эту функцию, можно осуществить с помощью данного FTP сервера сканирование портов других хостов. Просто попросите FTP сервер переслать файл на каждый интересующий вас порт целевой машины по очереди. Сообщение об ошибке укажет: открыт порт или нет. Это хороший способ обхода брандмауэров, т.к. организационные FTP сервера обычно имеют больше доступа к другим внутренним хостам, чем какие-либо другие машины. В Nmap такой тип сканирования задается опцией <span Class="bold">-b</span>. В качестве аргумента ей передается <a class="emphasis" href="#">имя_пользователя</a>:<a class="emphasis" href="#">пароль</a>@<a class="emphasis" href="#">сервер</a>:<a class="emphasis" href="#">порт</a>. <a class="emphasis" href="#">Сервер</a> - это сетевое имя или IP адрес FTP сервера. Как и в случае в обычными URL, вы можете опустить <a class="emphasis" href="#">имя_пользователя</a>:<a class="emphasis" href="#">пароль</a>, тогда будут использованы анонимные данные (пользователь: anonymous пароль:-wwwuser@). Номер порта (и предшествующее ему двоеточие) также можно не указывать; тогда будет использован FTP порт по умолчанию (21) для подключения к <a class="emphasis" href="#">серверу</a>. </p>
<p class="level2">Эта уязвимость была широко распространена в 1997, когда была выпущена Nmap, но теперь почти везде исправлена. Уязвимые сервера по-прежнему есть, так что, если ничего другое не помогает, то стоит попробовать. Если вашей целью является обход бранмауэра, то просканируйте целевую сеть на наличие открытого порта 21 (или даже на наличие любых FTP служб, если вы используете определение версии), а затем попробуйте данный тип сканирования с каждым из найденных. Nmap скажет вам, уязвим хост или нет. Если вы просто пытаетесь замести следы, то вам нет необходимости (и, фактически, не следует) ограничивать себя только хостами целевой сети. Перед тем как вы начнете сканировать произвольные Интернет адреса на наличие уязвимого FTP сервера, имейте ввиду, что многим системным администраторам это не понравится. </p><a name=""></a><h2 class="nroffsh">ОПРЕДЕЛЕНИЕ ПОРТОВ И ПОРЯДКА СКАНИРОВАНИЯ</h2>
<p class="level0">В дополнении ко всем методам сканирования описанными ранее, Nmap предлагает опции для определения портов для сканирования, а также порядка сканирования: произвольного или последовательного. По умолчанию, Nmap сканирует все порты до 1024 включительно, а также все порты с большими номерами упомянутыми в файле nmap-services для протокола, по которому идет сканирование. </p>
<p class="level0"><span Class="bold">-p </span><span class="bold"><a class="emphasis" href="#">диапазон портов</a></span> (Сканирование только определенных портов) </p>
<p class="level1">С помощью этой опции вы можете определить, какие порты вы хотите просканировать и переопределить установки по умолчанию. Указание отдельных номеров портов допустимо, как и задание диапазонов портов разделенных дефисом (напр. 1-1023). Начальные и/или кончные значения диапазонов могут быть опущены, что заставит Nmap использовать 1 и 65535 соответственно. Поэтому вы можете задать опцию <span Class="bold">-p-</span>, чтобы просканировать все порты от 1 до 65535. Сканирование нулевого порта допустимо, если вы укажене его явно . Для сканирования по IP протоколу (<span Class="bold">-sO</span>), эта опция определяет номера протоколов, которые вы хотите просканировать для диапазона (0-255). </p>
<p class="level1">Когда сканируете и TCP и UDP порты, вы можете задать определенный протокол указав перед номерами портов T: или U:. Определитель будет действовать до того момента, пока вы не зададите другой. Например, при задании аргумента <span Class="bold">-p U:53,111,137,T:21-25,80,139,8080</span> будут просканированы UDP порты 53,111, и 137, а также все перечисленные TCP порты. Имейте в виду, что для сканирования и UDP и TCP портов, вы должны указать опцию <span Class="bold">-sU</span> и, по крайне мере, один из типов сканирования TCP (таких как <span Class="bold">-sS</span>, <span Class="bold">-sF</span> или <span Class="bold">-sT</span>). Если определитель прокотола не указан, то перечисленные порты будут добавлены ко всем протоколам. </p>
<p class="level1">Порты также могут быть заданы именами, которые указаны в nmap-services. Вы даже можете использовать символы ? и * с именами. Например, чтобы просканировать FTP и все порты, чьи имена начинаются с «http», используйте <span Class="bold">-p ftp,http*</span>. Будьте осторожны при вводе этой команды и лучше заключите аргумент <span Class="bold">-p</span> в кавычки. </p>
<p class="level1">Диапазоны портов могут быть заключены в квадратные скобки, чтобы определить порты внутри этого диапазона, которые упомянуты в nmap-services. Например, с помощью следующей команды будут просканированы все порты из nmap-services равные или меньшие 1024: <span Class="bold">-p [-1024]</span>. Будьте осторожны при вводе этой команды и лучше заключите аргумент <span Class="bold">-p</span> в кавычки. </p>
<p class="level0"><span Class="bold">-F</span> (Быстрое (ограниченные порты) сканирование) </p>
<p class="level1">Указывает, что вы хотите произвести сканирование только портов, указанных в nmap-services, который поставляется вместе с Nmap (или в файле протоколов для <span Class="bold">-sO</span>). Это намного быстрее, чем сканировать все 65535 портов целевой машины. Т.к. этот список содержит много TCP портов (больше 1200), разница в скорости в отличии от TCP сканирования по умолчанию (около 1650 портов) несущественна. Разница может быть огромна, если вы определите свой небольшой nmap-services файл используя <span Class="bold">--servicedb</span> или <span Class="bold">--datadir</span> опции. </p>
<p class="level0"><span Class="bold">-r</span> (Не использовать случайный порядок портов) </p>
<p class="level1">По умолчанию, Nmap использует произвольный порядок сканирования портов (исключение составляют лишь наиболее часто употребляемые порты, которые расположены в начале списка сканирования по причинам эффективности). Обычно эта случайность нужна, но вы можете задать опцию <span Class="bold">-r</span>, чтобы использовать прямой порядок сканирования. </p>
<p class="level0"><span Class="bold">--port-ratio &lt;десятичное число между 0 и 1&gt;</span> </p>
<p class="level1">Сканирует все порты из nmap-services, чей рейтинг больше числа, указанного как аргумент (только для нового формата nmap-services). </p>
<p class="level0"><span Class="bold">--top-ports &lt;целое число от 1 и выше&gt;</span> </p>
<p class="level1">Сканирует N портов с наибольшими рейтингами, расположенными в nmap-services файле (только для нового формата nmap-services). </p><a name=""></a><h2 class="nroffsh">ОБНАРУЖЕНИЕ СЛУЖБ И ИХ ВЕРСИЙ</h2>
<p class="level0">При сканировании удаленной машины Nmap может выдать, что порты 25/tcp, 80/tcp, и 53/udp открыты. Используя свою базу данных nmap-services, состоящюю из около 2200 известных служб, </p>
<p class="level0">Nmap сообщит, что эти порты вероятно соответстуют почтовому серверу (SMTP), веб серверу (HTTP), и серверу доменных имен (DNS) соответственно. Эта информация обычно верна, т.к. подавляющее большинство служб, использующих 25 TCP порт, фактически, почтовые сервера. Тем не менее, вам не следует полностью полагаться на эту информацию! Люди могут и запускают службы с использованием нестандартных портов. </p>
<p class="level0">Даже если Nmap права, и на какой-либо гипотетической машине упомянутой выше запушены SMTP, HTTP и DNS сервера, это не так уж и много информации. Когда производится сканирование с целью обнаружения уязвимостей (или же просто определение структуры сети) компьютеров ваших компаний или клиентов, вам хочется знать, какие точно почтовые и DNS сервера и какие версии используются. Знание точной версии очень помогает в определении, к каким эксплоитам сервер наиболее уязвим. Эту информацию вы можете получить с помощью задания опции определения версии. </p>
<p class="level0">После того как какие-либо TCP и/или UDP были обнаружены, Nmap начинает &quot;опрашивать&quot; эти порты, чтобы определить, какие же приложения (службы) их действительно используют. База данных nmap-service-probes содержит запросы для обращения к различным службам и соответствующие выражения для распознавания и анализа ответов. Nmap пытается определить протоколо службы (напр. FTP, SSH, Telnet, HTTP), имя приложения (e.g. ISC BIND, Apache httpd, Solaris telnetd), номер версии, имя хоста, тип устройства (напр. принтер, роутер), семейство ОС (напр. Windows, Linux) и иногда различные детали типа возможно ли соединится с X сервером, версию протокола SSH, или имя пользователя KaZaA. Конечно же, большинство служб не предоставляют такую информацию. Если Nmap была скомпилирована с поддержкой OpenSSL, Она соединится с сервером SSL, чтобы попытаться определить запущенные службы, работающие за зашифрованным слоем. </p>
<p class="level0">Когда обнаружены службы RPC, удет автоматически задействована опция Nmap </p>
<p class="level0">(<span Class="bold">-sR</span>) </p>
<p class="level0">для определения программы RPC и ее версии. После сканирования портов UDP некоторые из них характеризуются как открыт|фильтруется, если сканирование не может определить открыт порт или фильтруется. С заданной опцией определения версии Nmap попытается получить ответ от таких портов (точно так же как она поступает с открытыми портами), и, в случае успеха, поменяет состояние этого порта на открыт открытые|фильтруемые TCP порты обрабатываются так же. Имейте в виду, что опция Nmap <span Class="bold">-A</span> помимо других команд активирует также и обнаружение версии. Бумажная документация по работе, использованию и настройке опции обнаружения версии доступна на m[blue]<span Class="bold">%<a href="https://nmap.org/book/vscan.html">https://nmap.org/book/vscan.html</a></span>m[]. </p>
<p class="level0">Когда Nmap получает ответы от службы, но не может сопоставить их с какой-либо записью в своей базе данных, она выводит на экран специальную информацию и URL, по которому вы можете опубликовать эту информацию, если вы точно уверены, что за служба запущена на исследуемом вами порте. Пожалуйста, потратьте пару минут на публикацию этой информации, т.к. ваша находка поможет остальным. Благодаря таким публикациям, Nmap содержит в своей базе данных около 3000 записей для более чем 350 протоколов, таких как SMTP, FTP, HTTP и т.д. </p>
<p class="level0">Функция определения версии включается и управляется с помощью следующих опций: </p>
<p class="level0"><span Class="bold">-sV</span> (Определение версии) </p>
<p class="level1">Включает функцию определения версии, работа которой описана выше. Вы также можете использовать опцию <span Class="bold">-A</span>, которая помимо других функций включает определение версии. </p>
<p class="level0"><span Class="bold">--allports</span> (Не исключать порты из проверки определения версии) </p>
<p class="level1">По умолчанию, функция определения версии пропускает TCP порт 9100, потому что некоторые принтеры просто распечатывают все, что приходить на этот порт, что ведет к дюжинам страниц HTTP GET запросов, бинарных запросов SSL сессий т.д. Это может быть изменено путем модифицирования или удаления директивы Exclude в nmap-service-probes, или вы можете задать опцию <span Class="bold">--allports</span>, сканированить все порты не обращая внимания на всякие Exclude директивы. </p>
<p class="level0"><span Class="bold">--version-intensity </span><span class="bold"><a class="emphasis" href="#">интенсивность</a></span> (Устанавливает интенсивность работы функции) </p>
<p class="level1">Когда производится сканирование с заданной опцией определения версии (<span Class="bold">-sV</span>), Nmap посылает серию запросов, каждому из которых присваивается значение в диапазоне от 1 до 9. Запросы с низкими значениями эффективны для большинства типичных служб, в то время как запросы с более высокими значениями редко применяются на практике. Уровень интенсивности определяет, какие запросы должны использоваться во время сканирования. Чем выше значение запроса, тем больше вероятность корректного определения службы. Тем не менее, сканирование с высокой интенсивностью займет много времени. Уровень интенсивности должна быть задана числом от 0 до 9. </p>
<p class="level1">По умолчанию уровень интенсивности равен 7. </p>
<p class="level1">Когда запрос привязан к целевому порту посредством директивы nmap-service-probes ports, этот запрос будет производиться вне зависимости от уровня интенсивности. Это гарантирует, что DNS запросы всегда будут производится с использование порта 53, SSL запросы - 443 и т.д. </p>
<p class="level0"><span Class="bold">--version-light</span> (Включить облегченный режим) </p>
<p class="level1">Это не что иное как псевдоним для <span Class="bold">--version-intensity 2</span>. Этот режим существенно уменьшает время сканирования, но вероятность определения служб сокращается. </p>
<p class="level0"><span Class="bold">--version-all</span> (Использовать каждый единичный запрос) </p>
<p class="level1">Псевдоним для <span Class="bold">--version-intensity 9</span>, гарантирующий что каждый единичный запрос будет направлен на каждый порт. </p>
<p class="level0"><span Class="bold">--version-trace</span> (Отслеживание процесса сканирования) </p>
<p class="level1">Указывает Nmap выводить подробную отладочную информацию о процессе сканирования. Это часть той информации, которую вы можете получить с помощью опции <span Class="bold">--packet-trace</span>. </p>
<p class="level0"><span Class="bold">-sR</span> (RPC сканирование) </p>
<p class="level1">Этот метод работает в связке с различными методами сканирования портов Nmap. При включении этой опции на все обнаруженные открытые TCP/UDP порты посылатеся множество NULL команд программы SunRPC в попытке определить, являются ли эти порты RPC портами, и если так, то какими программами (а также их версии) они используются. Таким образом, вы можете получить ту же информацию как и в случае использования команды <span Class="bold">rpcinfo -p</span>, даже если целевой сервер портмаппинга (portmapper) находится за брандмауэром (или защищен TCP фильтром). На сегодняшний момент ловушки со сканированием RPC не работают </p>
<p class="level1">Эта опция автоматически активируется как часть сканирования с функцией определения версии (<span Class="bold">-sV</span>). Т.к. это включено в функцию определения версии и более детально проработано, то опция <span Class="bold">-sR</span> нужна очень редко. </p><a name=""></a><h2 class="nroffsh">ОПРЕДЕЛЕНИЕ ОС</h2>
<p class="level0">Одна из наиболее известных функциональных возможностей Nmap это удаленное определение ОС на основе анализа работы стека TCP/IP. Nmap посылает серию TCP и UDP пакетов на удаленный хост и изучает практически каждый бит в ответах. После проведения дюжины тестов таких как TCP ISN выборки, поддержки опций TCP, IP ID выборки, и анализа продолжительности процедуры инициализации, Nmap сравнивает результаты со своей nmap-os-db базой данных, состоящей из более чем тысячи известных наборов типичных результатов для различных ОС и, при нахождении соответствий, выводит информацию об ОС. Каждый набор содержит свободное текстовое описание ОС и классификацию, в которой указаны название производителя (напр. Sun), название ОС (напр. Solaris), поколение ОС (напр. 10), и тип устройства (). OS, and a classification which provides the vendor name (e.g. Sun), underlying OS (e.g. Solaris), OS generation (e.g. 10), and device type (для общих целей, роутер, коммутатор (switch), игровая консоль и т.д.). </p>
<p class="level0">Если Nmap не может определить ОС, но для этого есть хорошие предпосылки (наприме, по крайней мере, найдены один открытый и один закрытый порты), то Nmap предоставит URL, по которому, если вы точно знаете, какая ОС используется, вы сможете предоставить набор ее характеристик. Тем самым вы внесете свой вклад в дополнение базы данных известных ОС Nmap, и она будет более полезна для всех остальных. </p>
<p class="level0">Опция определения ОС также активирует проведение некоторых других тестов, которые позволяют воспользоваться собираемой в процессе работы информацией. Один из них Классификация Предсказуемости Последовательности TCP (TCP Sequence Predictability Classification). Это позволяет приблизительно определить, насколько сложно установить ложное TCP соединение с удаленным хостом. Это может быть полезно для взлома и эксплуатации программ, базирующихся на доверительных отношениях (rlogin, фильтры брандмауэров и т.д.) или для сокрытия источника атаки. Этот тип спуфинга (spoofing) теперь редко используется, но многие машины все еще уязвимы к такого рода атакам. Число, характеризующее сложность, базируется на статистической выборке и может колебаться. Обычно лучше испльзовать классификацию с испльзованием английских фраз типа «worthy challenge(достойное испытание)» или «trivial joke(шуточное дело)». Эта информация будет выведена только при включенном вербальном режиме (<span Class="bold">-v</span>). Когда вербальный режим активирован вместе с опцией <span Class="bold">-O</span>, то выводится также информация о генарции IP ID последовательности. Большинство машин находятся в классе «incremental(возрастающий)», что означает, что они увеличивают поле ID в IP заголовке для каждого посланого пакета. Это делает их уязвимыми к спуфинг(spoofing) атакам и атакам с целью сбора расширенной информации. </p>
<p class="level0">Также во время определения ОС делается попытка узнать время работы целевой машины. С помощью временных меток (timestamp) TCP (m[blue]<span Class="bold"><a href="http://www.ietf.org/rfc/rfc1323.txt">RFC 1323</a></span>m[]s-2u[9]ds+2) Nmap пробует угадать, когда машина была перезагружена в последний раз. Информация может быть не точна, т.к. счетчик временной метки не был обнулен или был переполнен, или каким-то образом скрыт. Информация выводится только в вербальном режиме. </p>
<p class="level0">Бумажная документация по работе, использованию и настройки опции определения ОС находится на m[blue]<span Class="bold">%<a href="https://nmap.org/book/osdetect.html">https://nmap.org/book/osdetect.html</a></span>m[]. </p>
<p class="level0">Функция определения ОС включается и управляется с помощью следующих опций: </p>
<p class="level0"><span Class="bold">-O</span> (Включить определение ОС) </p>
<p class="level1">Включает фукнцию определения ОС, работа которой описана выше. Вы также можете использовать опцию <span Class="bold">-A</span>, которая помимо других функций включает определение ОС. </p>
<p class="level0"><span Class="bold">--osscan-limit</span> (Использовать функцию определения ОС только для &quot;перспективных&quot; хостов) </p>
<p class="level1">Функция определения ОС намного более эффективна, если обнаружены, по крайней мере, один открытый и один закрытый TCP порты. Задайте эту опцию, и Nmap не будет даже пытаться определить ОС хостов, не удовлетворяющих этому критерию. Это поможет сэкономить массу времени, особенно при <span Class="bold">-PN</span> сканирование многих хостов. Эта опция будет действовать только при включении функции ОС путем задания опций <span Class="bold">-O</span> или <span Class="bold">-A</span>. </p>
<p class="level0"><span Class="bold">--osscan-guess</span>; <span Class="bold">--fuzzy</span> (Угадать результаты определения ОС) </p>
<p class="level1">Когда Nmap не в состоянии определеить точное совпадение, она иногда предоставляет наиболее близкие к результатам сканирования совпадения. Чтобы Nmap сделала это по умолчанию, совпадения должны быть очень близки. Любая их этих (равных) опций побуждает Nmap к более агрессивному анализу результатов. Nmap по-прежнему будет сообщать, когда будет найдено не идеальное совпадение, а также отображать стпень соответствия (в процентах) для каждого набора характеристик. </p>
<p class="level0"><span Class="bold">--max-os-tries</span> (Устанавливает максимальное количество попыток определения ОС) </p>
<p class="level1">Когда Nmap пытается определить ОС на целевом хосте и не может найти идеального соответствия результатов, то она обычно повторяет попытку. По умолчанию, Nmap совершает пять попыток при условии, что существуют благоприятные условия для определения ОС, и дважды - в противном случае. Задание более низкого значения <span Class="bold">--max-os-tries</span> (напр. 1) увеличивает скорость работы Nmap, однако вы пропускаете некоторые записи, с помощью которых, возможно, можно было бы определить ОС. Большое значение может быть задано для разрешения большего количества попыток при благоприятных условиях. Это делается редко, за исключением тех случаев, когда необходимо сгенерировать более детальный набор характеристик ОС для занесения в базу данных Nmap. </p><a name=""></a><h2 class="nroffsh">СКРИПТОВЫЙ ДВИЖОК nmap(nse - nmap scripting engine)</h2>
<p class="level0">Скриптовый движок Nmap (NSE) это одна из наиболее мощных и гибких возможностей Nmap. Он позволяет пользователям писать (и делиться ими) простые скрипты (используя m[blue]<a class="bold" href="#">язык программирования Lua</a>m[]s-2u[10]ds+2, ) для автоматизации широкого круга сетевых задач. Эти скрипты выполняются со скоростью и эффективность ожидаемой вами от Nmap. Пользователи могут использовать разнообразный и постоянно расщиряющийся набор скриптов, которые поставляются вместе с Nmap, или написать свои скрипты под свои собственные нужды. </p>
<p class="level0">Когда мы создавали эту систему, считалось, что она будет использоваться для задач исследования сети, более изощренного варианта определения версии, исследования уязвимостей. NSE может быть исполльзован даже для обнаружения уязвимостей. </p>
<p class="level0">Чтобы отразить все многообразие возможностей использования скриптов и при этом упростить выбор необходимого скрипта, каждый из них содержит поле, где указано к какой категории он принадлежит. Сейчас определены следующие категории: safe, (intrusive), malware, version, discovery, vuln, auth и default. Все они описаны в m[blue]<span Class="bold">%<a href="https://nmap.org/book/nse-usage.html&#35;nse-categories">https://nmap.org/book/nse-usage.html&#35;nse-categories</a></span>m[]. </p>
<p class="level0">Скриптовый движок Nmap детально описан на m[blue]<span Class="bold">%<a href="https://nmap.org/book/nse.html">https://nmap.org/book/nse.html</a></span>m[] </p>
<p class="level0">и настраивается с помощью следующих опций: </p>
<p class="level0"><span Class="bold">-sC</span> </p>
<p class="level1">Осуществляет сканирование на основе скриптов. Эквивалентно опции <span Class="bold">--script=default</span>. Некоторые их применяемых здесь скриптов относятся к категории intrusive (навязчивые) и не должны быть использованы для сканирования целевой сети без разрешения. </p>
<p class="level0"><span Class="bold">--script </span><span class="bold"><span Class="emphasis">категории-скриптов</span></span><a class="bold" href="#">|</a><span class="bold"><a class="emphasis" href="#">директория</a></span><a class="bold" href="#">|</a><span class="bold"><a class="emphasis" href="#">имя_файла</a></span><span Class="bold">|all</span> </p>
<p class="level1">Осуществляет сканирование на основе скриптов (как <span Class="bold">-sC</span>) используя разделенный запятыми список категорий скриптов, отдельных файлов скриптов или директорий содержащих скрипты вместо стандартного набора скриптов. Сначала Nmap пытается интерпретирует все аргументы как категории, затем (в случае неудачи) как файлы или директории. Файл скрипта или директория скриптов могут быть определны с использованием абсолютного или относительного пути. Абсолютные пути используются так, как вы их зададите. Относительные пути будут определяться относительно: </p>
<p class="level1">--datadir/; $NMAPDIR/; ~/.nmap/ (не используется в Windows); NMAPDATADIR/ или ./. Также все эти папки будут проверяться на наличие поддиректории scripts/ </p>
<p class="level1">Если вы определили директорию со скриптами, и она была найдена, то Nmap загружает все NSE скрипты (все файлы с расширением .nse) из этой директории. Файлы без расширения nse игнорируются. Nmap не производит рекурсивный поиск скриптов во всех поддиректориях. Если вы указываете конкретный файл, то его расширение не обязательно должно быть nse. </p>
<p class="level1">По умолчанию скрипты Nmap хранятся в папке scripts - поддиректории основного каталого Nmap. Для большей производительности, все скрипты проиндексированы в базе даннных scripts/script.db, </p>
<p class="level1">где указано к какой категории или категориям принадлежит каждый скрипт. Для исполнения всех скриптов из базы данных Nmap задайте атрибут all. </p>
<p class="level1">Злонамеренные скрипты запускатся не в &quot;песочнице&quot; (sandbox) и поэтому могут повредить вашу систему или нарушить вашу анонимность. Никогда не используйте скрипты от третьих лиц до тех пор, пока не будете доверять автору или сами тщательно просмотрите скрипт. </p>
<p class="level0"><span Class="bold">--script-args </span><span class="bold"><span Class="emphasis">имя1</span></span><a class="bold" href="#">=</a><span class="bold"><span Class="emphasis">значение1</span></span><a class="bold" href="#">, </a><span class="bold"><span Class="emphasis">имя2</span></span><a class="bold" href="#">={</a><span class="bold"><span Class="emphasis">имя3</span></span><a class="bold" href="#">=</a><span class="bold"><span Class="emphasis">значение3</span></span><a class="bold" href="#">}, </a><span class="bold"><span Class="emphasis">имя4</span></span><a class="bold" href="#">=</a><span class="bold"><span Class="emphasis">значение4</span></span> </p>
<p class="level1">Позволяет вам передавать аргументы NSE скриптам. Аргументы передаются как пары имя=значение. Передаваемый аргумент обрабатывается и хранится в Lua таблице, к которой имеют доступ все скрипты. Имена передаются как строки (должны быть буквенно-цифровыми значениями) и используются в качестве ключей в argument-table. Значения могут быть также строками или в свою очередь таблицами (заключенными в (oq{&apos; и (oq}&apos;). Такие подтаблицы позволяют переопределить аргументы для конкретных скриптов (например, если вы хотите предоставить различным скриптам различные пары login/password). Например, вы можете определить аргументы через запятые: user=bar, password=foo и anonFTP={password=nobody@foobar.com}. Если вы хотите переопределить опцию для скрипта, вы должны проиндексировать подтаблицу с помощью id скрипта, т.к. это единственный способ указать скрипту на наличие специального аргумента. </p>
<p class="level0"><span Class="bold">--script-trace</span> </p>
<p class="level1">Эта опция делает то же самое, что и <span Class="bold">--packet-trace</span>, но на один ISO уровень выше. Если задана эта опция, то все входящие и исходящие соединения, осуществляемые скриптом, выводятся на экран. Выводимая информация включает в себя используемый коммуникационный протокол, источник, цель и переданные данные. Если более 5% переданных данных невозможно вывести на экран, то вывод будет представлять собой шестнадцатеричный (hex) дамп. </p>
<p class="level0"><span Class="bold">--script-updatedb</span> </p>
<p class="level1">Этой опцией обновляется база скриптов scripts/script.db, которая используется Nmap для определения доступных скриптов по умолчанию и их категорий. Обновлять базу необходимо, только если вы добавили или удалили NSE скрипты из директории scripts, или поменяли категорию какого-нибудь скрипта. Эта опция обычно используется без аргументов: <span Class="bold">nmap --script-updatedb</span>. </p><a name=""></a><h2 class="nroffsh">ОПЦИИ УПРАВЛЕНИЯ ВРЕМЕНЕМ И ПРОИЗВОДИТЕЛЬНОСТЬЮ</h2>
<p class="level0">Наиболее приоритетной стороной развития Nmap для меня всегда была производительность. Сканирование по умолчанию (<span Class="bold">nmap </span><span class="bold"><a class="emphasis" href="#">имя_хоста</a></span>) какого-либо хоста в моей локальной сети занимает пятую долю секунды. Этого едва хватает, чтобы моргнуть, но становится существенным, когда вы сканируете сотни или тысячи хостов. Более того, некоторые типы сканирования, как например, UDP или сканирование с целью определения версии могут в значительной степени увеличить время сканирования. Этому также могут поспособствовать настройки некоторых брандмауэров, где есть ограничения на количество ответов. Хотя в Nmap используются параллелизм и различные продвинутые алгоритмы для уменьшения времени сканирования, у пользователя есть возможность полностью контролировать работу программы. Опытные пользователи Nmap задают команды таким образом, чтобы получать только необходимую им информацию и в удовлетворяющие им сроки. </p>
<p class="level0">Способами увеличения скорости сканирования могут быть пропуск не критичных тестов, или обновление Nmap до последней версии (улучшения производительности выходят довольно часто). Оптимизация параметров опций управления временем также может значительно повлиять на скрость сканирования. Эти опции описаны ниже. </p>
<p class="level0">Некоторые опции могут принимать параметр время. По умолчанию он задается в миллисекундах, но вы можете добавить (oqs&apos;, (oqm&apos; или (oqh&apos; к значению, чтобы задать его в секундах, минутах или часах. Поэтому для опции <span Class="bold">--host-timeout</span> аргументы 900000, 900s и 15m означают одно и то же. </p>
<p class="level0"><span Class="bold">--min-hostgroup </span><span class="bold"><a class="emphasis" href="#">количество_хостов</a></span>; <span Class="bold">--max-hostgroup </span><span class="bold"><a class="emphasis" href="#">количество_хостов</a></span> (Регулирует размер групп для параллельного сканирования) </p>
<p class="level1">В Nmap есть возможность осуществлять сканирование портов или сканирование с целью определения версии нескольких хостов параллельно. Это происходит путем разделения целевого IP пространства на группы, а затем сканирования одной группы за раз. В общем случае целесообразно использовать большие группы. Недостатком является то, что вы не можете узнать информацию о каком-либо хосте, пока не закончится сканирование всей группы. Таким образом, если Nmap начнет сканирование группы из 50-ти хостов, то пользователь не будет получать никакой информации (кроме обновлений информации предлагаемых в вербальном режиме), пока не будет завершено сканирование всех 50-ти хостов. </p>
<p class="level1">По умолчанию Nmap использует компромиссный подход к решению этой проблемы. Сначала производится сканирование небольших групп из 5-ти хостов, поэтому первые результаты приходят быстро, затем размер группы постепенно увеличивается до максимального - 1024. Точные значения по умолчанию зависят от заданных опций. Для большей эффективности Nmap использует группы больших размеров для UDP сканирования и для некоторых типов TCP сканирования портов. </p>
<p class="level1">Когда максимальный размер группы задан опцией <span Class="bold">--max-hostgroup</span>, Nmap не будет его превышать. Минимальный размер группы задается опцией <span Class="bold">--min-hostgroup</span>, и Nmap будет пытаться поддерживать размер групп больше этого уровня. Возможно Nmap придется использовать группы меньше заданных размеров, когда для выполнения условия минимальности будет не хватать целевых хостов. Эти опции могут быть использованы для удержания размера группы внутри некоторого диапазона, хотя это редко необходимо. </p>
<p class="level1">Эти опции не имеют эффекта на фазе обнаружения хостов. Там используются обычное ping сканирование (<span Class="bold">-sP</span>). При сканировании с целью обнаружения хостов всегда используются большие группы для увеличения скорости и точности. </p>
<p class="level1">Основной целью использования этих опций является задание большого минимума размера группы, с тем чтобы сканирование проходило быстрее. При сканировании сети класса C обычным выбором является 256. При сканировании большого количества портов, превышение этого числа вряд ли поможет. При сканировании лишь нескольких портов, наилучшим размером группы будет 2048 или больше. </p>
<p class="level0"><span Class="bold">--min-parallelism </span><span class="bold"><a class="emphasis" href="#">количество_запросов</a></span>; <span Class="bold">--max-parallelism </span><span class="bold"><a class="emphasis" href="#">количество_запросов</a></span> (Регулирует распараллеливание запросов) </p>
<p class="level1">Эти опции регулируют общее количество запросов для группы хостов. Опции испльзуются при сканировании портов и при обнаружени хостов. По умолчанию Nmap высчитывает степень параллельности основываясь на производительности сети. Если пакеты отбрасываются, то Nmap использует меньшее количество запросов. Количество запросов медленно увеличивается по мере того, как сеть продолжает нормально работать. Эти опции устанавливают минимальную и максимальную границы для этой переменной. По умолчанию параллелизм устанавливается в 1, если сеть работает плохо, и может достигать нескольких сотен при идеальных условиях. </p>
<p class="level1">Наиболее частым вариантом применения является установка опции <span Class="bold">--min-parallelism</span> в значение большее единицы, чтобы увеличить скорость сканирования плохо работающих хостов и сетей. Это очень рискованная опция, т.к. установка большого значения может повлиять на правильность результатов сканирования. Установка этого значения также сокращает возможности Nmap по динамическому контролю параллелизма в зависимости от условий в сети. Значение равное 10-ти является приемлимым, хотя я прибегаю к этой опции в последнюю очередь. </p>
<p class="level1">Опция <span Class="bold">--max-parallelism</span> иногда устанавливается для предотвращения отправки хостам более одного запроса за раз. Это может быть полезно в комбинации с опцией <span Class="bold">--scan-delay</span> (описывается далее), хотя она и сама справляется со своими обязанностями. </p>
<p class="level0"><span Class="bold">--min-rtt-timeout </span><span class="bold"><a class="emphasis" href="#">время</a></span>, <span Class="bold">--max-rtt-timeout </span><span class="bold"><a class="emphasis" href="#">время</a></span>, <span Class="bold">--initial-rtt-timeout </span><span class="bold"><a class="emphasis" href="#">время</a></span> (Регулирует время ожидания ответа на запрос) </p>
<p class="level1">В Nmap есть значение промежутка времени, в течении которого будет ожидаться ответ на запрос, перед тем как прекратить попытки или совершить еще одну. Этот промежуток вычисляется на основе времени, в течении которого были получены ответы на предыдущие запросы. Если в сети есть значительная и непостоянная задержка, то этот промежуток может возрасти до нескольких секунда. Он также устанавливается на безопасном (высоком) уровне и может таким и оставаться некоторое время, если Nmap производит сканирование не отвечающих на запросы хостов . </p>
<p class="level1">Задание значений <span Class="bold">--max-rtt-timeout</span> и <span Class="bold">--initial-rtt-timeout</span> ниже значений по умолчанию может существенно сократить время сканирования. Это особенно заметно при различных вариантах сканирования с заданной опцией <span Class="bold">-PN</span>, а также при сканировании сильно фильтруемых сетей. Однако не торопитесь делать этого сразу. Сканирование займет много времени, если вы укажете такое низкое значение, при котором у большинства запросов закончиться время ожидания ответа, и они будут ретранслированы, в то время как ответы на них будут в пути. </p>
<p class="level1">Если хосты находятся в локальной сети, то 100 миллисекунда будет приемлимым значением опции <span Class="bold">--max-rtt-timeout</span>. Если при этом производится отслеживание маршурта, то для начала пропингуйте хост в сети с помощью утилиты ICMP ping или <span Class="bold">hping2</span>, у которой больше шансов обойти брандмауэр. Выясните среднее максимальное значение для, примерно, 10-ти пакетов. Удвойте это значение для передачи опции <span Class="bold">--initial-rtt-timeout</span> и умножьте на три или четыре для опции <span Class="bold">--max-rtt-timeout</span>. Обычно я не устанавливаю maximum RTT ниже 100&nbsp;мс, не зависимо от результатов пингования. А также не превышаю 1000&nbsp;мс. </p>
<p class="level1">Опция <span Class="bold">--min-rtt-timeout</span> редко используется; она может быть полезна, в случае если сеть настолько ненадежна, что даже значения Nmap по умолчанию слишком агрессивны. Так как Nmap просто сокращает время ожидания до минимума, в случае если сеть кажется надежной, то нужды в этой опции нет, о ней дожно быть сообщено как о баге на nmap-dev рассылку. </p>
<p class="level0"><span Class="bold">--max-retries </span><span class="bold"><a class="emphasis" href="#">количество_попыток</a></span> (Задает максимальное количество повторных передач запроса) </p>
<p class="level1">Когда Nmap не получает ответа на запрос сканирования порта, это может означать, что порт фильтруется. А возможно, запрос или ответ просто затерялись в сети. Также возможно, что у цели есть ограничение на количество ответов, что стало причиной временной блокировки запроса. В этом случае Nmap повторную передачу исходного запроса. Если для Nmap сеть кажется ненадежной, то она может совершить очень много попыток, перед тем как бросить это дело. Хотя это и придает достоверность результатам сканирования, это в то же время увеличивает время сканирования. Когда производительность критична, время сканирования может быть сокращено путем введения ограничения на максимальное количество повторных передач запроса. Вы даже можете задать <span Class="bold">--max-retries 0</span>, чтобы предотвратить все повторные попытки, хотя это не рекомендуется. </p>
<p class="level1">Значением по умолчанию (без <span Class="bold">-T</span> шаблона) является 10 ретрансляций. Если сеть кажется надежной, и целевые хосты не имеют ограничений на количество ответов, то Nmap обычно делают одну повторную попытку. Поэтому установка <span Class="bold">--max-retries</span> в низкое значение (например, 3) никак не вличет на большинство типов сканирования. Такие значения могут значительно увеличить скорость сканирования медленных (с ограничениями на количество ответов) хостов. Обычно вы теряете некоторую информацию, когда Nmap рано прекращает сканировать порты, поэтому лучше дать истечь времени <span Class="bold">--host-timeout</span>, и потерять всю информацию о цели. </p>
<p class="level0"><span Class="bold">--host-timeout </span><span class="bold"><a class="emphasis" href="#">время</a></span> (Прекращает сканирование медленных целей) </p>
<p class="level1">Некоторые хосты просто требуют <a class="emphasis" href="#">длительного</a> времени сканирования. Это может быть в силу низкой производительности или ненадежности сетевого оборудования или программного обеспечения, ограничений на количество пакетов или ограничивающих брандмауэров. Несколько процентов наиболее медленных хостов могут занять большую часть времени сканирования. Иногда лучшим выходом является просто пропуск таких хостов. Передайте в качестве аргумента опции <span Class="bold">--host-timeout</span> максимальное значение промежутка времени, в течении которого вы готовы ждать. Я часто задаю 30 мин, чтобы удостовериться в том, что Nmap не потратит более получаса на единичный хост. Имейте ввиду, что в течении этого получаса Nmap может сканировать другие хосты, так что это не просто потеря времени. Хост, чье время истекло, пропускается. Для этого хоста не выводится ни таблица портов, ни информации об ОС. </p>
<p class="level0"><span Class="bold">--scan-delay </span><span class="bold"><a class="emphasis" href="#">время</a></span>; <span Class="bold">--max-scan-delay </span><span class="bold"><a class="emphasis" href="#">время</a></span> (Регулирует задержку между запросами) </p>
<p class="level1">Эта опция вынуждает Nmap подождать по крайней мере заданное время между каждым запросом. Это особенно полезно в случае наличия ограничения на количество ответов у целевых хостов. Машины Solaris (как и многие другие) обычно отвечают на запросы при UDP сканировании только одним ICMP сообщением в секунду. Посылка большего количества запросов со стороны Nmap будет впустую. Установка значения опции <span Class="bold">--scan-delay</span> в 1 сек будет поддерживать в Nmap такую медленную интенсивность. Nmap пытается определить ограничения на количество ответов у целевых хостов и подстроить задержку между запросами соответственно, но ничто не мешает указать вам это значение явно, если вы точно знаете, что так будет лучше. </p>
<p class="level1">Когда Nmap подстраивает задержку между запросами к обнаруженному ограничению, то скорость сканироания значительно уменьшается. Опция <span Class="bold">--max-scan-delay</span> позволяет задать наибольшую возможную задержку. Установка здесь маленького значения может привести к бесполезной ретрансляции пакетов или возможному пропуску портов, если у цели есть строгий лимит на количество ответов. </p>
<p class="level1">Еще одним вариантом использования опции <span Class="bold">--scan-delay</span> является обход пороговых систем обнаружения и предотвращения вторжений (IDS/IPS). </p>
<p class="level0"><span Class="bold">--min-rate </span><span class="bold"><a class="emphasis" href="#">число</a></span> (Задает минимальную интенсивность сканирования) </p>
<p class="level1">Функции динамического управления различными опциями времени в Nmap хорошо справляются с задачей подборки подходящей скорости сканирования. Тем не менее, иногда вы можете заранее узнать подходящую интенсивность сканирования сети, или можете гарантировать, что сканирование закончится к определенному времени. Когда задается опция <span Class="bold">--min-rate</span>, Nmap будет пытаться отсылать пакеты с той же или большей, чем задано, интенсивностью. Аргументом этой опции является положительное число, отражающее интенсивность сканирования в пакетах в секунду. Например, задание опции <span Class="bold">--min-rate 300</span> означает, что Nmap будет пыпыться отсылать пакеты с интенсивностью 300 пакетов в секунду или больше. Задание низкого значения не отнимает у Nmap права работать с большей интенсивностью, если позволяют условия. </p>
<p class="level1">Существуют два варианта, при которых реальная интенсивность работы будет меньше заданного минимума. Первый, когда заданный минимум быстрее, чем наиболее быстрый возможный уровень работы Nmap, который зависит от аппаратного обеспечения. В этом случае Nmap будет посылать пакеты так быстро, как может; но будьте осторожны, т.к. при быстрой скорости возможны потери точности. Второй случай, когда у Nmap больше нечего отсылать, например, в конце сканирования, когда последние запросы уже посланы, и Nmap ожидает ответы на них. Это нормально, когда интенсивность падает в конце сканирования или при смене групп сканирования. </p>
<p class="level1">Задание минимального уровня интенсивности должно производится с осторожностью. Сканирование быстрее, чем возможно в данной сети, может привести к потери точности. В некоторых случаях, задание выского уровня интенсивности может привести к тому, что сканирование займет <a class="emphasis" href="#">больше</a> времени, чем с более низким уровнем. Это может произойти в случае, если адаптивные ретрансляционные </p>
<p class="level1">алгоритмы Nmap обнаружат перегрузку сети, вызванную высоким уровнем интенсивности сканирования, и увеличат количество ретрансляций для повышения точности сканирования. Поэтому, даже хотя пакеты отсылаются с большой интенсивностью, еще больше пакетов отсылается впустую. Установите максимальное количество ретрансляций с помощью опции <span Class="bold">--max-retries</span>, если вы хотите ограничить общее время сканирования. </p>
<p class="level1">Опция <span Class="bold">--min-rate</span> глобальна, она оказывает влияние на все сканирование, а не на отдельные хосты. Учитывается только при сканировании с целью обнаружения хостов и сканировании портов. Другие функции, как например определение ОС, имеют собственные особенности управления временем. </p>
<p class="level0"><span Class="bold">--max-rate </span><span class="bold"><a class="emphasis" href="#">число</a></span> (Задает максимальную интенсивность сканирования) </p>
<p class="level1">Дополнительно к опции <span Class="bold">--min-rate</span> есть опция <span Class="bold">--max-rate</span>, которая ограничивает максимальную интенсивность сканирования заданным значением. Используйте <span Class="bold">--max-rate 100</span>, например, чтобы ограничиться 100 пакетами в секунду в быстрой сети. Используйте <span Class="bold">--max-rate 0.1</span> для медленного сканирования - один пакет в десять секунд. </p>
<p class="level1"><span Class="bold">--max-rate</span> также как и <span Class="bold">--min-rate</span> глобальная опция, оказывающая влияние на все сканирование. Учитывается только при сканировании с целью обнаружения хостов и сканировании портов. </p>
<p class="level1">Иногда уровень интенсивности может превышать максимальное заданное значение для больры с непредвиденными задержками, но в среднем он будет находится на максимальном уровне или ниже. Nmap будет работать с меньшей интенсивностью, если того требуют условия. Чтобы удерживать интенсивность сканирования внутри определенного промежутка, используйте опции <span Class="bold">--min-rate</span> и <span Class="bold">--max-rate</span> вместе. </p>
<p class="level0"><span Class="bold">--defeat-rst-ratelimit</span> </p>
<p class="level1">Многие хосты имеют давно использующие ограничения </p>
<p class="level1">на количество ICMP сообщений об ошибке (как ошибки о недостижимости порта). Многие системы сейчас используют похожие ограничения на количество пакетов RST (сброс), генерируемых ими. Это может сильно замедлить сканирование, т.к. Nmap подстраивается под эти ограничения. Вы можете указать Nmap игнорировать такие ограничения (для сканирования портов типа SYN, при котором не отвечающие порты <a class="emphasis" href="#">не считаются</a> открытыми) путем задания опции <span Class="bold">--defeat-rst-ratelimit</span>. </p>
<p class="level1">Использование этой опции может привести к потери точности сканирования, т.к. Nmap могла не подождать неоходимое время ответа RST (на которые у целевой машины есть ограничения). При сканировании типа SYN не отвечающие порты помечаются как фильтруемые, а не закрытые, как в случае принятия ответа RST. Это опция полезна, только когда вам важны открытые порты, а различать закрытые и фильтруемые порты нет необходимости. </p>
<p class="level0"><span Class="bold">-T paranoid(паранойдный)|sneaky(хитрый)|polite(вежливый)|normal(обычный)|aggressive(агрессивный)|insane(безумный) </span> (Устанавливает шаблон настроек управления временем) </p>
<p class="level1">Хотя описанные выше опции управления временем мощны и эффективны, многих людей они сбивают с толку. Более того, выбор подходящих значений может иногда занимать больше времени, чем само сканирование. Поэтому Nmap предлагает более легкий подход, заключайющийся в применении шести шаблонов настроек. Вы можете задавать их с помощью опции <span Class="bold">-T</span> и номера шаблона (0–5) или его имени. Имена шаблонов следующие: <span Class="bold">paranoid(паранойдный)</span>&nbsp;(<span Class="bold">0</span>), <span Class="bold">sneaky(хитрый)</span>&nbsp;(<span Class="bold">1</span>), <span Class="bold">polite(вежливый)</span>&nbsp;(<span Class="bold">2</span>), <span Class="bold">normal(обычный)</span>&nbsp;(<span Class="bold">3</span>), <span Class="bold">aggressive(агрессивный)</span>&nbsp;(<span Class="bold">4</span>) и <span Class="bold">insane(безумный)</span>&nbsp;(<span Class="bold">5</span>). Первые два предназначены для обхода IDS. Вежливый (polite) режим снижает интенсивность сканирования с целью меньшего потребления пропускной способности и машинных ресурсов. Обычнй (normal) режим устанавливается по умолчанию, поэтому опция <span Class="bold">-T3</span> ничего не делает. Агрессивный (aggressive) режим повышает интенсивность сканирования, предполагая, что вы используете довольно быструю и надежную сеть. Наконец, безумный (insane) режим </p>
<p class="level1">предполагает, что вы используете чрезвычайно быструю сеть и готовы пожертвовать точностью ради скорости. </p>
<p class="level1">Эти опции позволяет определять пользователям, насколько агрессивными они хотят быть, оставляя за Nmap право выбирать подходящие значения опций управления временем. Также шаблоны позволяют производить некоторые незначительные корректировки скорости, для которых пока нет отдельных опций. Например, <span Class="bold">-T4</span> запрещает установку динамической задержки во время сканирования выше 10 мс для TCP порт, а <span Class="bold">-T5</span> - выше 5&nbsp;мс. Шаблоны могут использоваться в комбинации с описанными выше опциями; в этом случает будут использоваться в качестве значений аргументы этих опций, а не значения по умолчанию, заданные в шаблонах. Я рекомендую задавать <span Class="bold">-T4</span> при сканировании довольно современных и надежных сетей. Задавайте эту опцию, даже если вы используете описанные выше опции управления временем, и вы сможете получить выгоду от этих незначительных оптимизаций, которые включаются этой опцией. </p>
<p class="level1">Если у вас приличная широкополосная связь или ethernet соединение, то я бы порекомендовал вам всегда использовать <span Class="bold">-T4</span>. Некоторым людям нравится <span Class="bold">-T5</span>, хотя она чересчур агрессивна на мой взгляд. Иногда люди используют <span Class="bold">-T2</span>, потому что думают, что так у них мешьнше шансов пропустить какие-либо хосты или потому, что считают себя вежливыми по жизни. Они часто не осознают, насколько опция <span Class="bold">-T polite</span> медленна. Время их сканирования может занять в десять раз больше обычного. Проблемы с хостами и пропускной способностью редки при использовании опции (<span Class="bold">-T3</span>), поэтому я рекомендую ее для осторожного сканирования. Отключение функции определения версии намного более эффективно для сокращения таких проблем, чем попытка настройки всех опций управления временем. </p>
<p class="level1">Хотя опции <span Class="bold">-T0</span> и <span Class="bold">-T1</span> могут быть полезны для обхода IDS, они отнимут очень много времени при сканировании тысяч хостов или портов. Для такого сканирования, предпочтительнее будет задать свои точные значения, чем полагаться на опции <span Class="bold">-T0</span> и <span Class="bold">-T1</span>. </p>
<p class="level1">При использовании опции <span Class="bold">T0</span> в любой момент времени производится сканирование только одного порта, и перед отправкой каждого запроса проходит пять минут. <span Class="bold">T1</span> и <span Class="bold">T2</span> практически одинаковы, только между запросами проходит 15 секунд и 0.4 секунды соответственно. Опция <span Class="bold">T3</span> является опцией Nmap по умолчанию, она включает распараллеливание. <span Class="bold">-T4</span> эквивалента опциям <span Class="bold">--max-rtt-timeout 1250 --initial-rtt-timeout 500 --max-retries 6</span> и устанавливает максимальную задержку при TCP сканировании 10 миллисекунд. <span Class="bold">T5</span> эквивалента опциям <span Class="bold">--max-rtt-timeout 300 --min-rtt-timeout 50 --initial-rtt-timeout 250 --max-retries 2 --host-timeout 15m</span> и устанавливает максимальную задержку при TCP сканировании 5 миллисекунд. </p><a name=""></a><h2 class="nroffsh">ОБХОД БРАНДМАУЭРОВ/ids</h2>
<p class="level0">Многие пионеры Интернета представляли его в своем воображении как открутую глобальную сеть с универсальным пространством IP адресов, позволяющую создавать виртуальные соединения между любыми двумя точками. Это позволило бы хостам общаться на равных, обмениваясь информацией между собой. Люди могли бы получить доступ к своим домашним системам с работы, изменяя настройки климат-контроля или открывая двери ранним гостям. Этому видению глобальной соединенности не суждено было сбыться по причинам нехватки адресного пространства и проблемам безопасности. В ранние 1990-е организации стали использовать брадмауэры с целью сокращения возможностей соединения. Огромные сети были отрезаны от Интернета различными программными прокси, серверами преобразования имен и пакетными фильтрами. Неограниченный поток информации сократился до строго регламентированных каналов связи и содержимому передающемуся по ним. </p>
<p class="level0">Сетевые барьеры, такие как брандмауэры, могут сделать процесс исследования сети чрезвычайно сложным. Никаких послаблений не намечается, т.к. предотвращение инвентаризации сети часто является ключевой целью введения таких устройств. Тем не менее, Nmap предоставляет множество функций для облегчения понимания структуры таких сложных сетей и для проверки того факта, что сетевые фильтры работают как предполагалось. Поддерживаются даже механизмы обхода плохо организованных вариантов защит. Один из лучших методов проверки вашей системы безопасности - это попытка ее обойти. Поставьте себя на место атакующего и примените описанные ниже методы к вашей сети. Запустите FTP bounce сканирование, idle сканирование, атаку с фрагментацией пакетов или попробуйте пробиться через один из ваших прокси-серверов. </p>
<p class="level0">В дополнении к ограничению сетевой активности, компании все больше и больше используют мониторинг траффика с помощью систем обнаружения вторжений (intrusion detection systems - IDS). Все эти системы используют правила, составленные для обнаружения различного рода сканирований с помощью Nmap, т.к. сканирование часто оказывается предвестником атак. Многие из этих систем недавно были преобразованы в системы <a class="emphasis" href="#">предотвращения</a> вторжений (intrusion prevention systems - IPS), </p>
<p class="level0">которые блокирую трафик, расцениваемый как злонамеренный. К сожалению для сетевых администраторов и продавцов IDS, обнаружение вторжений с большой долей вероятности путем анализа паетов данных является сложной задачей. Атакующие с помощью терпения, навыков и с помощью некоторых опций Nmap обычно могут незамеченными обойти системы IDS. Между тем, администраторам приходится иметь дело с большим количеством ложных положительных результатов, когда такие системы ошибаются и блокируют безвредную сетевую активность. </p>
<p class="level0">Время от времени некоторые высказывают предположения, что Nmap не следует предоставлять фукнции для обхода IDS. Они аргументируют свою позицию тем, что эти функции могут быть с равным успехом использованы атакующими, так же как они используются администраторами для улучшения систем защиты. Проблема в таких рассуждениях заключается в том, что такие методы будут по-прежнему использоваться атакующими, которые просто найдут другие утилиты или самостоятель добавят такие функции в Nmap. Тем временем администраторам будет намного сложнее выполнять свою работу. Использование только современных FTP серверов намного более мощное средство защиты, чем попытки предотвратить распространение утилит позволяющих реализовать FTP bounce атаки. </p>
<p class="level0">Не существует такой магической опции, которая позволяла бы обнаруживать и обходить брандмауэры и IDS. Для этого необходимы навыки и опыт. Подробное описание таких методов выходит за рамки данного справочного руководства, где содержаться только важные опции с описанием их возможностей. </p>
<p class="level0"><span Class="bold">-f</span> (фрагментировать пакеты); <span Class="bold">--mtu</span> (используя заданное значение MTU) </p>
<p class="level1">При задании опции <span Class="bold">-f</span> все типы сканирования (включая различные типы пингования) будут использовать маленькие фрагментированные IP пакеты. Идея состоит в том, чтобы разбить TCP заголовок на части и посылать их в различных пакетах для того, чтобы не дать определить пакетным фильтрам и системам обнаружения вторжения, что вы делаете. Будьте осторожны с этой опцией! Некоторые программы имеют проблемы с обработкой таких маленьких пакетов. Один старый сниффер Sniffit аварийно завершал работу после принятия первого фрагмента. Задайте эту опцию один раз, и Nmap будет разбивать пакеты на части по 8 байт или меньше после IP заголовка. Таким образовм, 20-ти байтный TCP заголовок будет разбит на 3 пакета. Два из них будут содержать по 8 байт этого заголовка, а третий - последние 4. Конечно же, каждый фрагмент также имеет IP заголовок. Задайте опцию <span Class="bold">-f</span> снова, чтобы использовать фрагменты по 16 байт (тем самым сократится число фрагментов). Или вы можете задать свой собственный размер фрагмента с помощью опции <span Class="bold">--mtu</span>. Не используйте опцию <span Class="bold">-f</span> вместе с <span Class="bold">--mtu</span>. Размер должен быть кратным 8. В то время как фрагментированные пакеты не смогут пройти через пакетные фильтры и брандмауэры, которые ставят в очередь все IP фрагменты, например, с помощью опции <span Class="emphasis">CONFIG_IP_ALWAYS_DEFRAG</span>в ядре Linux, некоторые сети не могут позволить себе связанное с этим падение производительности и поэтому не используют такую возможность. Другие могут использовать ее, потому что фрагменты в таких сетях могут идти по разным маршрутам. Некоторые системы фрагментируют исходящие пакеты прямо в ядре. Linux с включенным модулем отслеживания соединения iptables </p>
<p class="level1">тому пример. Произведите сканирование с включенным сниффером Wireshark , чтобы убедиться, что пакеты фрагментируются. Если в вашей ОС возникают проблемы, попробуйте задать опцию <span Class="bold">--send-eth</span>, чтобы обойти IP слой и отсылать сырые ethernet фрэймы. </p>
<p class="level0"><span Class="bold">-D </span><span class="bold"><span Class="emphasis">фиктивный_хост1</span></span><span class="bold">[,<span Class="emphasis">фиктивный_хост2</span>]</span><span Class="bold">[,ME]</span><a class="bold" href="#">[,...]</a> (Маскировка сканирования с помощью фиктивных хостов) </p>
<p class="level1">Производится сканирование с использованием фиктивных хостов; в этом случае цель сканирования считает, что заданные вами фиктивные хосты также производят ее сканирование. Хотя IDS цели может сообщить о том, что было произведено 5-10 сканирований портов с каждого IP адреса, система не сможет узнать, с какого из этих IP адресов действительно производилось сканирование, а какие были лишь безвредными ловушками. Хотя этот тип сканирования может быть распознан путем отслеживания маршрута, сбрасыванием ответа или другими активными методами, в большинстве случае он является эффективным способом сокрытия вашего IP адреса. </p>
<p class="level1">При задании фиктивных хостов, разделяйте их запятыми; вы также можете указать ME как один из фиктивных хостов для задания позиции в списке вашего реального IP адреса. Если вы задаете ME в шестой позиции или дальше, некоторые обычные системы обнаружения сканирования портов (например, Solar Designer*(Aqs excellent Scanlogd) вряд ли вообще отобразят ваш IP адрес. Если вы не задаете флаг ME, Nmap поставит его в произвольную позицию. Вы также можете использовать RND для генерации произвольного, незарезервированного IP адреса, или RND:<a class="emphasis" href="#">чило</a> для генерации определенного <a class="emphasis" href="#">числа</a> адресов. </p>
<p class="level1">Имейте ввиду, что хосты, указанные вами в качестве фиктивных, должны работать, иначе вы просто зафлудите целевые хосты с помощью запросов на подключение. Также легко будет определить, какой хост действительно производит сканирование, если только он будет работать. Возможно вы захотите использовать IP адреса вместо имен (в этом случае сети, в которых находятся фиктивные хосты, не видят вас в своих логах). </p>
<p class="level1">Фиктивные хосты используются и во время фазы обнаружения хостов (используя ICMP, SYN, ACK и что там еще), и во время сканирования портов. Также они используются во время удаленного определения ОС (<span Class="bold">-O</span>). Эта техника не работает при сканировании с целью определения версии или с целью обнаружения возможности установления TCP соединения. Во время сканирования задержки принудительно устанавливаются между каждой группой обманных запросов. Т.к. ловушки посылаются одной группой сразу, то это может временно нарушить работу системы контроля ограничений нагрузок. </p>
<p class="level1">Использование большого количества фиктивных хостов может снизить скорость вашего сканирование и даже сделать его менее точным. Также, некоторые ISP будут отфильтровывать ваши обманные пакеты, в то время как некоторые вообще никак не ограничивают такого рода IP пакеты. </p>
<p class="level0"><span Class="bold">-S </span><span class="bold"><span Class="emphasis">IP_адрес</span></span> (Изменить исходный адрес) </p>
<p class="level1">В некоторых обстоятельствах Nmap может не определить ваш адрес (в этом случае Nmap сообщит вам об этом). В этом случае используйте опцию <span Class="bold">-S</span>, передав ей в качестве параметра IP адрес, чтобы указать интерфейс, который вы хотите использовать для отправки пакетов. </p>
<p class="level1">Также эта опция может быть использована для того, чтобы заставить &quot;думать&quot; цель сканирования, что ее сканирует <span Class="emphasis">кто-то другой</span>. Представьте компанию, которая частенько подвергается сканированию портов со стороны конкурента! Как правило, в этом случае необходимо использовать также опции <span Class="bold">-e</span> и <span Class="bold">-PN</span>. Имейте ввиду, что вы не будете получать в ответ никаких пакетов (они будут отправлены на указанный вами IP адрес), поэтому Nmap не будет выводить какой-либо полезной информации. </p>
<p class="level0"><span Class="bold">-e </span><span class="bold"><a class="emphasis" href="#">интерфейс</a></span> (Использовать конкретный интерфейс) </p>
<p class="level1">Указывает Nmap, какой интерфейс использовать для отправки и приема пакетов. Nmap в состоянии определить его автоматически, но сообщит вам, если не сможет. </p>
<p class="level0"><span Class="bold">--source-port </span><span class="bold"><a class="emphasis" href="#">номер_порта</a></span><a class="bold" href="#">;</a> <span Class="bold">-g </span><span class="bold"><a class="emphasis" href="#">номер_порта</a></span> (Задать свой номер порта) </p>
<p class="level1">Одной из удивительно часто встречаюшиься ошибок при конфигурировании системы безопасности является тенденция доверять траффику основываясь только на номере исходного порта. Легко понять как это происходит. Администратор устанавливает новенький брандмауэр, и его заваливают жалобы от неблагодарных пользователей, чьи приложения перестали работать. В частности, может не работать DNS, т.к. UDP DNS ответы от внешних серверов больше не могут войти в сеть. Еще одним распространенным примером ялвяется FTP. При активной FTP передаче, удаленный сервер пытается установить соединение с клиентом, чтобы послать запрашиваемый файл. </p>
<p class="level1">Существуют безопасные методы решения этих проблем, часто в виде прокси на уровне приложений или надстроек к брандмауэрам. Но, к сожалению, существуют и более легкие, небезопасные методы. Принимая во внимание то, что DNS ответы приходят с порта 53 а FTP с порта 20, многие администраторы поддаются искушению и просто разрешают весь входящий трафик с этих портов. Они также часто полагают, что атакующие не заметят и не будут использовать такие дыры в брандмауэрах. В других случаях, администраторы считают, что это всего лишь временные меры, до тех пор пока они не придумают более безопасные способы решения проблем. Потом они забывают об этом. </p>
<p class="level1">Перегруженные работой сетевые администраторы не единственные, кто попадается в такую ловушку. Многочисленные продукты просто кишат такими небезопасными правилами. Даже Microsoft заслуживает порицания. Фильтры IPsec, которые были установлены в Windows 2000 и Windows XP содержат внутренне правило, разрешающее весь TCP или UDP траффик с порта 88 (Kerberos). Еще один известный случай: версии брандмауэра Zone Alarm до 2.1.25 разрешали все входящие UDP пакеты с порта 53 (DNS) или 67 (DHCP). </p>
<p class="level1">Nmap предоставляет опции <span Class="bold">-g</span> и <span Class="bold">--source-port</span> (они эквиваленты) для того, чтобы воспользоваться такими ошибками. Просто задайте номер порта, и Nmap будет использовать его для отправки пакетов. Nmap должна использовать различные номера портов, чтобы точно определить ОС; также DNS запросы игнорируют опцию <span Class="bold">--source-port</span>, т.к. для их осуществления Nmap использует системные библиотеки. Большинство TCP вариантов сканирований, включая SYN сканирование, полностью поддерживают эту опцию, как и UDP сканирование. </p>
<p class="level0"><span Class="bold">--data-length </span><span class="bold"><a class="emphasis" href="#">число</a></span> (Добавить произвольные данные к посылаемым пакетам) </p>
<p class="level1">В обычных условиях Nmap посылает минимальные пакеты, содержащие только заголовок. Так TCP пакеты составляют 40 байтов, а запросы на ICMP эхо ответ всего 28. Эта опция указывет Nmap добавлять заданное число произвольных байтов к посылаемым пакетам. Эта опция не влияет на пакеты, используемые для определения ОС (<span Class="bold">-O</span>) , поскольку в этом случае необходимо тщательное соответствие запросов, но большинство пакетов, используемых для различных видов пингования и сканирования портов поддерживают ее. Это немного замедляет сканирование, зато делает его более незаметным. </p>
<p class="level0"><span Class="bold">--ip-options </span><span class="bold"><span Class="emphasis">S|R [маршрут]|L [маршрут]|T|U ... </span></span><a class="bold" href="#">;</a> <span Class="bold">--ip-options </span><span class="bold"><a class="emphasis" href="#">шестнадцатиричная строка</a></span> (Посылать пакет с заданным ip опциями) </p>
<p class="level1">m[blue]<a class="bold" href="#">Протокол IP</a>m[]s-2u[11]ds+2 предоставляет несколько опций, которые могут быть заданы в заголовке пакета. В отлиии от повсеместно используемых TCP опций, опций IP редко видны из соображений практичности и безопасности. Фактически, большинство роутеров Интернета блокируют наиболее опасные опации, как, например, отслеживание источника. И все же опции могут быть полезны для определения и манипулирования сетевым маршрутом к целевым машинам. Например, возможно вы сможете воспользоваться опцией для определния маршрута до цели, когда более традиционные методы в стиле tracerout будут бесполезны. Или если ваши пакеты блокируются каким-либо брандмауэром, вы можете попробовать задать маршрут с менее строгим сетевым экраном. </p>
<p class="level1">Наиболее действенным способом задания IP опций является передача их значений в качестве аргументов опции <span Class="bold">--ip-options</span>. Каждое шестнадцатиричное значение задается с помощью &bsol;x, после которого следуют два цифры. Вы можете повторять символы, поставив после них звездочку и указав количество повторений. Например, &bsol;x01&bsol;x07&bsol;x04&bsol;x00*36&bsol;x01 это шестнадцатиричная строка, содержащая 36 NUL байтов. </p>
<p class="level1">Nmap также предоставляет механизм сокращений для задания таких опций. Просто передайте в качестве аргумента букву R, T или U для задания опции записи маршрута, </p>
<p class="level1">записи временной метки </p>
<p class="level1">или обеих соответственно. Ослабление или ужесточение отслеживания источника </p>
<p class="level1">может быть задано с помощью L или S, затем пробела, а затем разделенный пробелами список IP адресов. </p>
<p class="level1">Если вы хотите заданные опции в передаваемых и получаемых пакетах, задайте опцию <span Class="bold">--packet-trace</span>. Для большей информации и примеров использования IP опций с Nmap, смотрите m[blue]<span Class="bold">%<a href="https://seclists.org/nmap-dev/2006/q3/0052.html">https://seclists.org/nmap-dev/2006/q3/0052.html</a></span>m[]. </p>
<p class="level0"><span Class="bold">--ttl </span><span class="bold"><a class="emphasis" href="#">значение</a></span> (Установить IP поле time-to-live (время жизни) </p>
<p class="level1">Устанавливает IPv4 поле time-to-live в посылаемых пакетах в соответствии с заданным значением. </p>
<p class="level0"><span Class="bold">--randomize-hosts</span> (Использовать произвольный порядок целей сканирования) </p>
<p class="level1">Указывает Nmap перемешать каждую группу, содержащую до 16384 хостов, перед началом сканирования. Это может сделать сканирование менее заметным для различного рода систем сетевого мониторинга, особенно если вы используете низкие значения таймингов. Если вы хотите перемешивать большие по размеру группы, то увеличьте значение <span Class="emphasis">PING_GROUP_SZ</span> в nmap.h и перекомпилируйте программу. Альтернативным решением является генерация списка целевых IP адресов (<span Class="bold">-sL -n -oN </span><span class="bold"><a class="emphasis" href="#">имя_файла</a></span>), обработка его с помощью Perl скрипта и затем передача его Nmap в качестве параметра опции <span Class="bold">-iL</span>. </p>
<p class="level0"><span Class="bold">--spoof-mac </span><span class="bold"><span Class="emphasis">MAC адрес, префикс или название производителя</span></span> (Задать собственный MAC адрес) </p>
<p class="level1">Указывает Nmap использовать заданный MAC адрес </p>
<p class="level1">для всех отсылаемых сырых ethernet фреймов. Эта опция подразумевает использование, <span Class="bold">--send-eth</span> чтобы быть уверенным, что Nmap действительно использует пакеты уровня ethernet. MAC адрес может быть задан в нескольких форматах. Если это просто число 0, то Nmap выбирает польностью произвольный MAC адрес для сессии. Если задается строка в виде простого набора шестнадцатиричных цифр (можно разделять пары двоеточиями), то Nmap будет использовать эту строку в качестве MAC адреса. Если задано менее 12-ти шестнадцатиричных цифр, то Nmap заполняет остаток из 6 байтов произвольными значениями. Если в качестве аргумента не передается ни 0, ни шестнадцатиричная строка, то Nmap просматривает nmap-mac-prefixes в поисках названия производителя, содержащего данную строку (нечувствительна к регистру). Если найдено совпадение, то Nmap использует OUI производителя (3-байтный префикс), </p>
<p class="level1">а оставшиеся 3 байта заполняет произвольно. Примеры аргументов опции <span Class="bold">--spoof-mac</span>: Apple, 0, 01:02:03:04:05:06, deadbeefcafe, 0020F2 и Cisco. Эта опция оказывает влияние только на сканирования с использованием сырых пакетов, такие как SYN сканирование или определение ОС, а также не ориентированные на соединение функции, такие как определение версии или Nmap Scripting Engine (NSE). </p>
<p class="level0"><span Class="bold">--badsum</span> (Посылать пакеты с фиктивными TCP/UDP контрольными суммами) </p>
<p class="level1">Указывает Nmap использовать неправильные TCP или UDP контрольные суммы для пакетов, отправляемых на целевой хост. Т.к. практически все реализации стека IP просто не обрабатывают такие пакеты, то любые ответы скорее всего приходят от брандмауэров или IDS, которые не обременяеют себя проверкой контрольной суммы. Более детальное описание этой техники смотрите на m[blue]<span Class="bold">%<a href="https://nmap.org/p60-12.html">https://nmap.org/p60-12.html</a></span>m[] </p><a name=""></a><h2 class="nroffsh">ВЫВОД РЕЗУЛЬТАТОВ</h2>
<p class="level0">Любая утилита безопасности полезна ровно настолько, насколько полезны выдаваемые ею результаты. Различные сложные тесты и алгоритмы имеют мало пользы, если они не представлены в хорошо организованной и удобной для понимания форме. Предоставляя разлиные способы вывода результатов Nmap используется людьми и программным обеспечением, т.к. нет такого формата, который подходил бы всем. Поэтому Nmap предлагает несколько форматов, включая интерактивный режим для чтения людьми и XML для удобного анализа программным обеспечением. </p>
<p class="level0">В дополнении к предоставлению различных форматов вывода, Nmap предлагает опции для упрваления уровнем вербальности выходных данных и отладочных сообщений. Результаты могут быть направлены на стандартный вывод или в файлы, причем Nmap может как добавлять в конец файлов, так и создавать новые. Выходные файлы также могут быть использованы для продолжения остановленного сканирования. </p>
<p class="level0">Nmap предоставляет пять различных выходных форматов. Формат по умолчанию называется интерактивный вывод,, результаты передаются на стандартный вывод (stdout). Есть также нормальный вывод,, который подобен интерактивному, за исключением того, что в процессе работы выводится меньше информации и предупреждений, т.к. предполагатеся, что эти результаты будут анализироваться после завершения сканирования, а не интерактивно. </p>
<p class="level0">XML вывод это один из наиболее важных выходных форматов, т.к. он может быть конвертирован в HTML, лего анализируется программами типа графического пользовательского интерфейса Nmap или может быть экспортирован в базу данных. </p>
<p class="level0">Оставшимися двумя форматами являются grepable формат, который содержит большую часть о целевом хосте в одной строке, и sCRiPt KiDDi3 0utPUt для пользователей, которые считают себя |&lt;-r4d. </p>
<p class="level0">В то время как интерактивный вывод устанавливается по умолчанию и не имеет связанных с ним опций командой строки, опции остальных четырех форматов вывода имеют похожий синтаксис. В качестве аргумента они принимают имя файла, где должны храниться результаты. Возможно испльзование нескольких форматов, но каждый из них должен быть задан только один раз. Например, вы хотите сохранить результаты предоставляемые форматом нормального вывода для себя, и в то же время сохранить в формате XML результаты того же сканирования для анализа программами. Вы можете сделать это с помощью опции <span Class="bold">-oX myscan.xml -oN myscan.nmap</span>. Для краткости здесь используются простые имена типа myscan.xml, но рекомендуется использовать более описательные имена. Каждый выбирает имена по своему; я обычно использую длинные имена, содержащие дату сканирования и пару слов описания, и помещаю эти файлы в директории с именем компании, которую я сканирую. </p>
<p class="level0">Хотя с помощью этих опций информация сохраняется в файлы, Nmap по-прежнему выводит интерактивную информацию на стандартный вывод. Например, с помощью опции <span Class="bold">nmap -oX myscan.xml target</span> XML сохраняется в файл myscan.xml, а стандартный вывод заполняется информацией, как если бы опция <span Class="bold">-oX</span> вообще не была задана. Вы можете изменить это поведение передав в качестве аргумента к одному из форматов вывода символ дефиса. Это деактивирует интерактивный вывод, а на стандартный вывод будет пересылаться информация в заданном вами формате. Поэтому с помощью команды <span Class="bold">nmap -oX - target</span> на стандартный вывод будет пересылаться только XML. Серьезный ошибки могут выводиться в стандартный поток ошибок, stderr. </p>
<p class="level0">В отличии от некоторых аргументов Nmap, пробел между флагом формата файла (например, <span Class="bold">-oX</span>) и именем файла или дефисом здесь обязателен. Если вы опустите флаги и зададите аргументы типа <span Class="bold">-oG-</span> или <span Class="bold">-oXscan.xml</span>, из-за функции обратной совместимости Nmap будут созданы файлы <a class="emphasis" href="#">нормального формата</a> с именами G- и Xscan.xml соответственно. </p>
<p class="level0">Все эти аргументы поддерживают <span Class="bold">strftime</span> перобразования в именах файлов. %H, %M, %S, %m, %d, %y и %Y это то же самое что и в <span Class="bold">strftime</span>. %T то же самое что и %H%M%S, %R то же самое что и %H%M и %D то же самое что и %m%d%y. Знак %, после которого следует любой символ просто даст этот символ (%% даст вам символ процента). Поэтому опция <span Class="bold">-oX *(Aqscan-%T-%D.xml*(Aq</span> будет использовать XML файл в формате scan-144840-121307.xml. </p>
<p class="level0">Nmap также предоставляет опции для управления вербальностью сканирования, а также для добавления в конец файлов вместо их перезаписи. Все эти опции описаны ниже. </p>
<p class="level0"><a class="bold" href="#">Форматы вывода Nmap</a> </p>
<p class="level0"><span Class="bold">-oN </span><span class="bold"><a class="emphasis" href="#">имя_файла</a></span> (Нормальный вывод) </p>
<p class="level1">Перенаправляет нормальный вывод в заданный файл. Как отмечалось выше, немного отличается от интерактивного вывода. </p>
<p class="level0"><span Class="bold">-oX </span><span class="bold"><a class="emphasis" href="#">имя_файла</a></span> (XML вывод) </p>
<p class="level1">Перенаправляет XML вывод в заданный файл. Nmap включает определение типа документа (DTD), что позволяет XML парсерам использовать XML вывод Nmap. Изначально это предназначалось для программного использования, хотя это также позволяет людям интерпретировать XML вывод Nmap. DTD определяет возможные элементы, а также перечисляет атрибуты и значения, которые они могут принимать. Последняя версия всегда доступна на m[blue]<span Class="bold">%<a href="https://nmap.org/data/nmap.dtd">https://nmap.org/data/nmap.dtd</a></span>m[]. </p>
<p class="level1">XML предоставляет формат, который легко обрабатывается программным обеспечением. Бесплатные XML парсеры, доступны для всех основных языков программирования, включая C/C++, Perl, Python и Java. Люди даже написали привязки для большинства из этих языков для обработки выходных данных Nmap. Примерами являются m[blue]<span Class="bold">Nmap::Scanner</span>m[]s-2u[12]ds+2 </p>
<p class="level1">и m[blue]<span Class="bold">Nmap::Parser</span>m[]s-2u[13]ds+2 </p>
<p class="level1">на Perl CPAN. В большинстве случаев взаимодействия какого-либо приложения и Nmap, XML является предпочитаемым форматом. </p>
<p class="level1">XML вывод связывается с XSL таблицей стилей, которая используется для форматирования результатов как HTML. Самым легким способом использования этой возможности является загрузка XML вывода в браузер типа Firefox или IE. По умолчанию это будет работать только на машине, на которой установлена Nmap (или настроенной аналогично) из-за жесткой привязки полного пути файла nmap.xsl. Используйте опции <span Class="bold">--webxml</span> или <span Class="bold">--stylesheet</span> для создания XML файлов отображаемых как HTML только на подключенной к интернету машине. </p>
<p class="level0"><span Class="bold">-oS </span><span class="bold"><a class="emphasis" href="#">имя_файла</a></span> (ScRipT KIdd|3 oUTpuT) </p>
<p class="level1">Script kiddie формат практически такой же как и интерактивный, за тем исключением, что после окончания сканирования он перерабатывается, чтобы больше подходит l33t HaXXorZ, который смотрит свысока на Nmap из-за постоянного использования заглавных букв и правовисания. Лишенные чувства юмора люди должны иметь ввиду, что эта опция высмеивает script kiddies, перед тем как ругать меня за то, что я якобы «помогаю им». </p>
<p class="level0"><span Class="bold">-oG </span><span class="bold"><a class="emphasis" href="#">имя_файла</a></span> (grepable вывод) </p>
<p class="level1">Это формат обсуждается последним, т.к. он нежелетален для использования. Формат вывода XML намного мощенее, а также особенно удобен для опытных пользователей. XML это стандарт, для которого доступны дюжины отличных парсеров, в то время как grepable вывод всего лишь мое простое изобретение. XML достаточно гибок для поодержания новых функций Nmap по мере их выхода, тогда как мне частенько приходится опускать некоторые возможности grepable вывода из-за недостатка места. </p>
<p class="level1">Тем не менее, этот формат вывода все еще довольно популярен. Это простой формат, который просто описывает каждый хост в одну строку и может быть легко обработан стандартными Unix утилитами как grep, awk, cut, sed, diff и Perl. Даже я иногда использую этот формат вывода. Поиск хостов, на которых открыт SSH порт или работает Solaris сводится к простой передаче результатов утилите grep, а затем утилитам типа awk или cut для вывода желаемой информации. </p>
<p class="level1">Grepable вывод состоит из комментариев (линий начинающихся с &#35;) и строк описывающих цели. Каждая строка включает комбинацию из 6 помеченных полей, разделенных знаками табуляции и оканчивающихся двоеточием. Поля следующие: Хост, Порты, Протоколы, Ignored State, ОС, Seq Index, IP ID и Статус. </p>
<p class="level1">Наиболее важным из этих полей обычно является Порты, где дается описание каждого интересного порта. Это поле представляет собой разделенный запятыми список портов. Каждый элемент этого списка описывает один интересный порт и состоит из семи подполей, разделенных знаком косой черты (/). Подполя следующие: Номер порта, Состояние, Протокол, Владелец, Служба, SunRPC информация и Информация о версии. </p>
<p class="level1">Как и в случае с XML выводом, это руководство не позволяет полностью описать формат. Более подробное описание этого формата доступно с m[blue]<span Class="bold">%<a href="https://nmap.org/book/output-formats-grepable-output.html">https://nmap.org/book/output-formats-grepable-output.html</a></span>m[]. </p>
<p class="level0"><span Class="bold">-oA </span><span class="bold"><a class="emphasis" href="#">базовое_имя_файла</a></span> (Использовать все форматы вывода) </p>
<p class="level1">Для удобства вы можете задать опцию <span Class="bold">-oA </span><span class="bold"><a class="emphasis" href="#">базовове_имя_файла</a></span>, чтобы сохранить результаты сканирования в обычном, XML и grepable форматах сразу. Они будут содержаться в файлах <a class="emphasis" href="#">базовове_имя_файла</a>.nmap, <a class="emphasis" href="#">базовове_имя_файла</a>.xml и <a class="emphasis" href="#">базовове_имя_файла</a>.gnmap соответственно. Как и с большинством программ вы можете предварять имя файла путем к директории, например, ~/nmaplogs/foocorp/ для Unix или c:&bsol;hacking&bsol;sco для Windows. </p>
<p class="level0"><a class="bold" href="#">Опции управления вербальностью и отладкой</a> </p>
<p class="level0"><span Class="bold">-v</span> (Увеличить уровень вербальности) </p>
<p class="level1">Увеличение уровня вербальности влечет за собой вывод большего количества информации во время сканирования. Когда Nmap предполагает, что сканирование займет больше нескольких минут, будет выводиться приблизительное время завершения работы и открытые порты по мере их обнаружения. Задайте эту опцию дважды или более для увеличения количества выводимой информации. </p>
<p class="level1">Большинство изменений касаются только интерактивного режима; некоторые также нормального и script kiddie режимов. Остальные форматы вывода предназначены для обработки машинами, поэтому вся необходимая информация выдается Nmap по умолчанию. Тем не менее существуют несколько изменений в других режимах, когда размер выходной информации может быть существенно сокращен путем отбрасывания некоторых деталей. Например, линия комментариев в grepable формате, предоставляющая список всех просканированных портов, выводится только в вербальном режиме, т.к. список может быть довольно длинный. </p>
<p class="level0"><span Class="bold">-d [уровень]</span> (Увеличить или установить уровень отладки) </p>
<p class="level1">Когда даже вербальный режим не предоставляет вам достаточную информацию, вы можете использовать отладку! Отладка активируется опцией командной строки (<span Class="bold">-d</span>), и уровень отладочной информации может быть увеличен путем задания этой опции несколько раз. В качестве альтернативы, вы можете передать уровень отладки как аргумент опции <span Class="bold">-d</span>. Например, опцией <span Class="bold">-d9</span> устанавливается девятый уровень. Это наивысший уровень, который будет предоставлять тысячи строк, до тех пор пока вы не запустите очень простое сканирование небольшого количества целей. </p>
<p class="level1">Отладка полезна, если вы предполагаете, что в Nmap есть баг, или если вы просто озадачены тем, что делает Nmap и почему. Т.к. эта функция по большому счету предназначена для разработчиков, то выходная информация не всегда понятна. Вы можете получить что-то типа: Timeout vals: srtt: -1 rttvar: -1 to: 1000000 delta 14987 ==&gt; srtt: 14987 rttvar: 14987 to: 100000. Если вы не понимаете, что это означает, вы можете проигнорировать эту информацию, посмотреть в исходному коде или попросить помощи у разработчиков (nmap-dev). Некоторые линии довольно понятны, но сообщения становятся более неясными с увеличением уровня отладки. </p>
<p class="level0"><span Class="bold">--packet-trace</span> (Отслеживание принятых и переданных пакетов и данных) </p>
<p class="level1">Указывает Nmap выводить краткую информацию о каждом принятом и отправленном пакете. Обычно используется для отладки, но также может быть полезна новичкам для понимания того, что же действительно делает Nmap. Чтобы избежать вывода тысяч строк, вы можете ограничить количество портов для сканирования, например опцией <span Class="bold">-p20-30</span>. Если вас интересует только то, что происходит при процессе определения версии, то вместо этой опции используйте <span Class="bold">--version-trace</span>. </p>
<p class="level0"><span Class="bold">--open</span> (Показывать только открытые (или возможно открытые) порты) </p>
<p class="level1">Иногда вас интересуют только порты, к которым вы фактически можете подключиться (а именно открытые), и вам не нужны результаты о закрытых, фильтруемых и закрытых|фильтруемых портах. Обработка выходной информации может быть легко произведена с помощью таких утилит как grep, awk и Perl, но по многочисленным просьбам эта функция была добавлена в Nmap. Задайте опцию <span Class="bold">--open</span>, чтобы видеть информацию только об открытых, открытых|фильтруемых и не фильтруемых портах. Эти три типа портов расцениваются как обычно, что означает, что открытые|фильтруемые и нефильтруемые порты могут быть приняты во внимание, если их набралось большое количество. </p>
<p class="level0"><span Class="bold">--iflist</span> (Вывести список интерфейсов и роутеров) </p>
<p class="level1">Выводит список интерфейсов и системных роутеров, обнаруженных Nmap. Это полезно для отладки проблем с роутерами и неправильного описания устройств (когда, например, Nmap рассматривает PPP соединение как ethernet). </p>
<p class="level0"><span Class="bold">--log-errors</span> (Записывать ошибки/предупреждения в выходной файл нормального режима) </p>
<p class="level1">Обычно предупреждения и ошибки выводятся Nmap только на экран (интерактивный вывод), и не сохраняются в файлах нормального режима вывода (заданных опцией <span Class="bold">-oN</span>). Если вы хотите записывать эти сообщения в заданные вами файлы, то используйте эту. Это может быть полезно, если вы не просматриваете интерактивный вывод или хотите сохранить все ошибки во время отладки какой-либо проблемы. Сообщения об ошибках и предупреждениях по-прежнему будут выводится в интерактивном режиме. Это не будет работать для большинства ошибок, вызванных неправильным заданием аргументов командой строки, т.к. Nmap может не успеть проинициализировать выходные файлы этих команд. В дополнении ко всему, некоторые предупреждения и ошибки Nmap используют другую систему, которая еще не поддерживает данную опцию. </p>
<p class="level1">Альтернативой опции <span Class="bold">--log-errors</span> может служить перенаправление интерактивного вывода (включая стандартный поток ошибок) в файл. Большинство командных оболочек Unix легко справится с этим, но это может быть проблематично на Windows. </p>
<p class="level0"><a class="bold" href="#">Различные опции вывода</a> </p>
<p class="level0"><span Class="bold">--append-output</span> (Добавлять в конец, а не перезаписывать выходные файлы) </p>
<p class="level1">Когда вы передаете в качестве аргумента какому-либо флагу формата вывода (например, <span Class="bold">-oX</span> или <span Class="bold">-oN</span>) имя файла, то по умолчанию этот файл перезаписывается. Если вы хотите оставить текущее содержание файла, а новые результаты добавлять в конец, используйте опцию <span Class="bold">--append-output</span>. В результате все указанные файлы вывода не будут перезаписываться, а новое содержимое будем добавляться в конец. Существуют некоторые сложности с XML выводом (<span Class="bold">-oX</span>), т.к. результирующий файл в этом случае обычно не сможет быть правильно проанализирован программами, пока не вы подправите его вручную. </p>
<p class="level0"><span Class="bold">--resume </span><span class="bold"><a class="emphasis" href="#">имя_файла</a></span> (Продолжить прерванное сканирование) </p>
<p class="level1">Некоторые всесторонние варианты сканирования Nmap могут занимать очень продолжительное время - порядка нескольких дней. И они не всегда работают до завершения. Различные ограничения могут не позволить Nmap сканировать в течении рабочих часов, сеть может перестать работать, машина, на которой запущена Nmap может быть перезагружена, или сама Nmap может вылететь. Администратор, использующий Nmap, может отменить сканирование по каким-то другим причинам, просто нажав ctrl-C. Запуск целого сканирования с самого начала может быть нежелателен. К счастью, если были сохранены логи нормального (<span Class="bold">-oN</span>) или grepable формата (<span Class="bold">-oG</span>), пользователь может продолжить сканирование с того места, на котором оно было остановлено. Просто задайте опцию <span Class="bold">--resume</span> и передайте в качестве аргумента имя выходного файла обычного или grepable формата. Никакие другие опции использовать не разрешается, т.к. Nmap будет продолжать сканирование с заданными ранее опциями. Просто запустите Nmap командой <span Class="bold">nmap --resume</span><span class="bold"><a class="emphasis" href="#">имя_лог_файла</a></span>. Nmap будет добавлять новые результаты к выходным файлам, определенным при предыдущем запуске. Выходные файлы формата XML не поддерживаются функцией возобновления работы, т.к. комбинирование результатов двух сканирований в один правильный XML файл является сложной задачей. </p>
<p class="level0"><span Class="bold">--stylesheet </span><span class="bold"><a class="emphasis" href="#">путь или URL</a></span> (Устанавливает XSL таблицу стилей для преобразования XML вывода) </p>
<p class="level1">Nmap использует XSL </p>
<p class="level1">таблицу стилей </p>
<p class="level1">nmap.xsl </p>
<p class="level1">для просмотра или перевода XML вывода в HTML. </p>
<p class="level1">XML вывод включает директиву xml-stylesheet, которая указывает на файл nmap.xml, туда, где он был размещен Nmap при установке (или на текущую рабочую директорию в Windows). Просто загрузите XML вывод Nmap в любой современный веб браузер, и он самостоятельно найдет файл nmap.xsl для отображения результатов. Если вы хотите использовать другой файл таблицы стилей, то передайте имя этого файла в качестве аргумента опции <span Class="bold">--stylesheet</span>. Вы должны использовать полный путь к файлу или URL. Один из примеров: <span Class="bold">--stylesheet <a href="https://nmap.org/data/nmap.xsl">https://nmap.org/data/nmap.xsl</a></span>. Эта опция указывает браузеру загружать последнюю версию таблицы стилей с Nmap.Org. Опция <span Class="bold">--webxml</span> делает то же самое, но без лишнего набора на клавиатуре и запоминания. Загрузка XSL с Nmap.Org облегчает просмотр результатов на машине, на которой не установленна Nmap (и поэтому нет файла nmap.xsl). Поэтому URL часто бывает более полезен, но локальный файл nmap.xsl используется по умолчанию из соображений приватности. </p>
<p class="level0"><span Class="bold">--webxml</span> (Загружает таблицу стилей с Nmap.Org) </p>
<p class="level1">Эта опция является просто псевдонимом <span Class="bold">--stylesheet <a href="https://nmap.org/data/nmap.xsl">https://nmap.org/data/nmap.xsl</a></span>. </p>
<p class="level0"><span Class="bold">--no-stylesheet</span> (Убрать объявление XSL таблицы стилей из XML) </p>
<p class="level1">Задайте эту опцию, чтобы не ассоциировать какую-либо XSL таблицу стилей с XML выводом. В этом случае директива xml-stylesheet опускается. </p><a name=""></a><h2 class="nroffsh">РАЗЛИЧНЫЕ ОПЦИИ</h2>
<p class="level0">В этой секции описываются некоторые важные (и не очень важные) опции, которые не подходят к другим категориям. </p>
<p class="level0"><span Class="bold">-6</span> (Включает IPv6 сканирование) </p>
<p class="level1">Начиная с 2002 года Nmap имеет поддержку протокола IPv6 для своих наиболее используемых функций. В частности, пинг сканирование (только TCP), выявление возможности установки соединения и определение версии имеют поддержку протокола IPv6. Синтаксис команд такой же как и обычный за исключением того, что вы добавляете опцию <span Class="bold">-6</span>. Конечно же, вы должны использовать синтаксис IPv6, если вы указываете адрес, а не имя хоста. Адрес может выглядеть как 3ffe:7501:4819:2000:210:f3ff:fe03:14d0, поэтому лучше использовать имена хостов. Вывод выглядит так же как и обычный, только на линии «интересных портов» будет IPv6 адрес. </p>
<p class="level1">Хотя протокол IPv6 еще не завоевал весь мир, в некоторых (обычно Азиатских) странах он используется интенсивно, и большинство современных операционных систем поддерживают его. Чтобы использовать Nmap с протоколом IPv6, и источник и цель сканирования должны быть настроены на работу с ним. Если ваш ISP (как большинство из них) не предоставляет вам IPv6 адрес, вы можете использовать широко распространенный и работающий с Nmap сервис Tunnel Brokers. Я использую бесплатный сервис </p>
<p class="level1">на m[blue]<span Class="bold">%<a href="http://www.tunnelbroker.net">http://www.tunnelbroker.net</a></span>m[]. Другие подобные сервисы m[blue]<a class="bold" href="#">перечислены на Wikipedia</a>m[]s-2u[14]ds+2. </p>
<p class="level0"><span Class="bold">-A</span> (Опции агрессивного сканирования) </p>
<p class="level1">Этой опцией активируется набор агрессивных опций сканирования. Я еще не решил до конца, какие же опции будут использоваться. Сейчас этот набор включает определение ОС (<span Class="bold">-O</span>), сканирование с целью определения версии (<span Class="bold">-sV</span>), сканирование с использованием скриптов (<span Class="bold">-sC</span>) и трассировку (<span Class="bold">--traceroute</span>). </p>
<p class="level1">Возможно в будущем будут добавлены другие функции. Целью является создание всестороннего набора опций сканирования, чтобы людям не надо было запоминать большое количество флагов. Тем не менее, т.к. сканирование с использованием скриптов с настройками по умолчанию расценивается как &quot;назойливое&quot;, вам не следует использовать опцию <span Class="bold">-A</span> для сканирования целевых сетей без разрешения. Эта опция активирует только возможности, но не устанавливает опции времени (timing) (такие как <span Class="bold">-T4</span>) или опции вербального вывода (<span Class="bold">-v</span>), которые вы, возможно, хотели бы использовать. </p>
<p class="level0"><span Class="bold">--datadir </span><span class="bold"><a class="emphasis" href="#">имя_директории</a></span> (Определяет место расположения файлов Nmap) </p>
<p class="level1">Во время работы Nmap получает некоторые данные из файлов nmap-service-probes, nmap-services, nmap-protocols, nmap-rpc, nmap-mac-prefixes и nmap-os-db. Если место расположение какого-либо из этих файлов было задано конкретно (используя опции <span Class="bold">--servicedb</span> или <span Class="bold">--versiondb</span>), то оно используется для этого файла. Далее Nmap ищет эти файлы в директории, заданной опцией <span Class="bold">--datadir</span> (если задана). Если файлы не были найдены там, то Nmap ищет их в директории, определенной переменной окружения NMAPDIR . Далее идут ~/.nmap для реальных и действующих в данный момент UIDs (только POSIX системы) или расположение исполняемого файла Nmpa (только Win32), и далее /usr/local/share/nmap или /usr/share/nmap. В последнюю очередь Nmap будет искать эти файлы в текущей директории. </p>
<p class="level0"><span Class="bold">--servicedb </span><span class="bold"><a class="emphasis" href="#">файл_служб</a></span> (Задает определенный файл служб) </p>
<p class="level1">Указывает Nmap использовать заданный файл служб вместо файла nmap-services, который поставляется вместе с Nmap. Использование этой опции также подразумевает использование опции быстрого сканирования (<span Class="bold">-F</span>). Смотрите описание <span Class="bold">--datadir</span> для более подробной информации о файлах данных Nmap. </p>
<p class="level0"><span Class="bold">--versiondb </span><span class="bold"><a class="emphasis" href="#">файл_запросов_служб</a></span> (Задает определенный файл запросов для служб) </p>
<p class="level1">Указывает Nmap использовать заданный файл запросов для служб вместо файла nmap-service-probes, который поставляется вместе с Nmap. Смотрите описание <span Class="bold">--datadir</span> для более подробной информации о файлах данных Nmap. </p>
<p class="level0"><span Class="bold">--send-eth</span> (Использовать сырой уровень ethernet) </p>
<p class="level1">Указывает Nmap посылать пакеты с использование более низкого сырого уровня ethernet, а не с использованием более высокого уровня IP (сетевого). По умолчанию Nmap выбирает тот способ, который больше подоходит для используемой платформы. Сырые сокеты (уровень IP) </p>
<p class="level1">в общем случае более эффективны для Unix машин, в то время как использование ethernet фреймов необходимо для операционных систем Windows, т.к. Microsoft отключила в них поддержку сырых сокетов. Nmap по-прежнему использует сырые IP пакеты на Unix не смотря на эту опцию, когда нет другого выбора (как в случае с не-ethernet соединениями). </p>
<p class="level0"><span Class="bold">--send-ip</span> (Использовать сырой уровень IP) </p>
<p class="level1">Указывает Nmap посылать пакеты с использование сырых IP сокетов, а не с использованием более низкого уровня ethernet фреймов. Это дополнение к опции <span Class="bold">--send-eth</span> описанной выше. </p>
<p class="level0"><span Class="bold">--privileged</span> (Подразумевать, что у пользователя есть все привилегии) </p>
<p class="level1">Указывает Nmap, что у нее есть необходимые привилегии для использования сырых сокетов, пакетного сниффинга и сходных операций, которые обычно требуют привилегий пользователя root на Unix системах. </p>
<p class="level1">По умолчанию Nmap завершает работу, если были запрошены такие опреации, но <span Class="bold">geteuid</span> не нуль. Опцию <span Class="bold">--privileged</span> хорошо использовать на системах с возможностями ядра Linux или подобных, которые могут быть сконфигурированы так, что непривилегированные пользовтели смогут осуществлять сканирование с использованием сырых сокетов. Удостоверьтесь, что эта опция указана перед любымими опциями требующими привилегий (сканирование SYN, определение ОС и т.д.). Переменная окурежния <span Class="bold">NMAP_PRIVILEGED</span> может быть установлена как равнозначная альтернатива опции <span Class="bold">--privileged</span>. </p>
<p class="level0"><span Class="bold">--unprivileged</span> (Подразумевать, что у пользователя нет привилегий для использования сырых сокетов) </p>
<p class="level1">Эта опция противоположна <span Class="bold">--privileged</span>. Указывает Nmap, что у пользователя нет привилегий для использования сырых сокетов и сниффинга. Полезна для тестирования, отладки или когда по какой-то причине на вашей системе не работае механизм сырых сокетов. Переменная окружения <span Class="bold">NMAP_UNPRIVILEGED</span> может быть установлена как равнозначная альтернатива опции <span Class="bold">--unprivileged</span>. </p>
<p class="level0"><span Class="bold">--release-memory</span> (Освободить память перед завершением работы) </p>
<p class="level1">Эта опция полезна только во время отладки утечки памяти. Заставляет Nmap освободить занянутю память перед завершением работы, что облегчает задачу обнаружения действительной утечки памяти. В обычном режиме работы Nmap пропускает этот шаг, так ОС делает это самостоятельно при закрытии процесса. </p>
<p class="level0"><span Class="bold">-V</span>; <span Class="bold">--version</span> (Вывести номер версии) </p>
<p class="level1">Выводит номер версии Nmap и завершает работу. </p>
<p class="level0"><span Class="bold">-h</span>; <span Class="bold">--help</span> (Вывести страницу помощи) </p>
<p class="level1">Выводит небольшую страницу помощи с наиболее часто используемыми командами и опциями. Запуск Nmap без аргументов приводит к такому же результату. </p><a name=""></a><h2 class="nroffsh">ВЗАИМОДЕЙСТВИЕ ВО ВРЕМЯ ВЫПОЛНЕНИЯ</h2>
<p class="level0">Во время работы Nmap, все нажатые клавиши фиксируются. Это позволяет вам взаимодействовать с программой не прерывая и не перезапуская ее. С помощью некоторых клавиш можно изменить опции сканирования, при использовании же других будут выведены сообщения о текущем статусе сканирования. Существует договоренность, что <a class="emphasis" href="#">строчные буквы увеличивают</a> количество выводимой информации, а <a class="emphasis" href="#">прописные буквы уменьшают</a>. Для справки можно нажать (oq<a class="emphasis" href="#">?</a>&apos;. </p>
<p class="level0"><span Class="bold">v</span> / <span Class="bold">V</span> </p>
<p class="level1">Увеличить / уменьшить уровень вербальности </p>
<p class="level0"><span Class="bold">d</span> / <span Class="bold">D</span> </p>
<p class="level1">Увеличить / уменьшить отладочный уровень </p>
<p class="level0"><span Class="bold">p</span> / <span Class="bold">P</span> </p>
<p class="level1">Включить / выключить отслеживание пакетов </p>
<p class="level0"><a class="bold" href="#">?</a> </p>
<p class="level1">Вывести справку о взаимодействии во время выполнения </p>
<p class="level0">Что-либо другое </p>
<p class="level1">Выведет сообщение типа: </p>
<p class="level1">Stats: 0:00:08 elapsed; 111 hosts completed (5 up), 5 undergoing Service Scan </p>
<p class="level1">Service scan Timing: About 28.00% done; ETC: 16:18 (0:00:15 remaining) </p><a name=""></a><h2 class="nroffsh">ПРИМЕРЫ</h2>
<p class="level0">Здесь приведены несколько примеров использования Nmap, от самых простых до более изощренных. Некоторые реально существующие IP адреса и доменные имена использованны для того, чтобы сделать примеры более конкретными. На их место вы должны подставить адреса/имена из <a class="emphasis" href="#">вашей собственной сети.</a>. В то время как сканирование портов некоторой сети не является незаконным, некоторым администраторам сетей может не понравиться своевольное сканирование их сетей и они могут пожаловаться. Для начала постарайтесь получить разрешение. </p>
<p class="level0">В целях тестирования у вас есть разрешение сканировать scanme.nmap.org. Вы можете использовать сканирование с помощью Nmap, но не тестировать эксплоиты или производить атаки отказа в обслуживании. Для того чтобы не перегружать канал, пожалуйста, не производите более дюжины сканирований этого хоста в день. В случае злоупотребления этим свободным для сканирования хостом, он будет отключен и Nmap выдаст Failed to resolve given hostname/IP: scanme.nmap.org (не могу разрешить данное имя/IP: scanme.nmap.org). Все выше сказанное также относится и к хостам scanme2.nmap.org, scanme3.nmap.org, и так далее, несмотря на то, что эти хосты еще не существуют. </p>
<p class="level0"><span Class="bold">nmap -v scanme.nmap.org</span> </p>
<p class="level0">Этой командой будут просканированы все TCP порты машины scanme.nmap.org . Опция <span Class="bold">-v</span> активирует вербальный режим. </p>
<p class="level0"><span Class="bold">nmap -sS -O scanme.nmap.org/24</span> </p>
<p class="level0">Этой командой будет произведено скрытное SYN сканирование всех 255 машин сети «класса C», в которой расположена машина Scanme. Также будет произведена попытка определения операционной системы на каждом работающем хосте. Из-за SYN сканирования и опции определения ОС данная команда требует привилегий суперпользователя (root). </p>
<p class="level0"><span Class="bold">nmap -sV -p 22,53,110,143,4564 198.116.0-255.1-127</span> </p>
<p class="level0">Запускает перебор хостов и TCP сканирование первой половины всех (из доступных 255) 8 битных подсетей адресного пространства 198.116 класса B. Также проверяет запущены ли SSH, DNS, POP3 или IMAP с использованием их стандартных портов, а также использует ли какое-нибудь приложение порт 4564. Если какой-нибудь из этих портов открыт, то будет произведена попытка определения работающего с этим портом приложения. </p>
<p class="level0"><span Class="bold">nmap -v -iR 100000 -PN -p 80</span> </p>
<p class="level0">Указывает Nmap выбрать случайным образом 100,000 хостов и просканировать их на наличие запущенных на них веб-серверов (порт 80). Перебор хостов отключен опцией <span Class="bold">-PN</span>, т.к. посылка пары предварительных запросов с целью определения доступности хоста является нецелесообразной, когда вас интересует всего один порт на каждом хосте. </p>
<p class="level0"><span Class="bold">nmap -PN -p80 -oX logs/pb-port80scan.xml -oG logs/pb-port80scan.gnmap 216.163.128.20/20</span> </p>
<p class="level0">Этой командой будут просканированы 4096 IP адресов (без предварительного пингования), а выходные данные будут сохранены в фомате XML и формате, удобном для просмотра утилитой grep (grepable формат). </p><a name=""></a><h2 class="nroffsh">ОШИБКИ</h2>
<p class="level0">Как и ее автор, Nmap не идеальна. Но вы можете сделать ее лучше посылая нам отчеты об ошибках или даже написав патч. Если Nmap ведет себя не так, как вы ожидаете, то для начала обновитесь до последней версии с m[blue]<span Class="bold">%<a href="https://nmap.org">https://nmap.org</a></span>m[]. Если проблема останется, то выясните, не была ли эта проблема уже обнаружена кем-то. Попробуйте поискать сообщения об ошибках на нашей странице поиска m[blue]<span Class="bold">%<a href="https://insecure.org/search.html">https://insecure.org/search.html</a></span>m[] или в Google. Также попробуйте просмотреть nmap-dev архивы на m[blue]<span Class="bold">%<a href="https://seclists.org/">https://seclists.org/</a></span>m[]. Также прочитайте полностью страницу руководства. Если ничего не помогло, отправьте сообщение об ошибке на &lt;dev@nmap.org&gt;. Пожалуйста, включите всю известную вам информацию об ошибке, какую версию Nmap вы используете, и на какой операционной системы вы запускаете Nmap. Сообщения о проблемах и вопросы по использованию Nmap отправленные на &lt;dev@nmap.org&gt; имеют больше шансов на ответ, чем если бы вы послали их непосредственно Fyodor*(Aqу. Если вы подпишитесь на рассылку nmap-dev перед отправкой сообщения, то ваше сообщение будет обработано быстрее. Подпишитесь на рассылку на m[blue]<span Class="bold">%<a href="https://nmap.org/mailman/listinfo/dev">https://nmap.org/mailman/listinfo/dev</a></span>m[]. </p>
<p class="level0">Патчи для исправления ошибок даже лучше просто сообщений об ошибках. Базовые инструкции по созданию патчей доступны по адресу m[blue]<span Class="bold">%<a href="https://nmap.org/data/HACKING">https://nmap.org/data/HACKING</a></span>m[]. Созданные вами патчи можно отправить на nmap-dev (рекомендуется) или непосредственно Fyodor*(Aqу. </p><a name=""></a><h2 class="nroffsh">АВТОР</h2>
<p class="level0">Fyodor &lt;fyodor@nmap.org&gt; (m[blue]<span Class="bold">%<a href="https://insecure.org">https://insecure.org</a></span>m[]) </p>
<p class="level0">На протяжении многих лет сотни людей внесли ценный вклад в разработку Nmap. Все изменения и улучшения подробно описаны в файле CHANGELOG, который распространяется вместе с Nmap, а также доступен на m[blue]<span Class="bold">%<a href="https://nmap.org/changelog.html">https://nmap.org/changelog.html</a></span>m[]. </p><a name=""></a><h2 class="nroffsh">ЮРИДИЧЕСКИЕ УВЕДОМЛЕНИЯ</h2><a name="Unofficial"></a><h2 class="nroffsh">Unofficial translation disclaimer / Отречение неофициального перевода</h2>
<p class="level0">This is an unnofficial translation of the m[blue]<span Class="bold">Nmap license details</span>m[]s-2u[15]ds+2 into Russian. It was not written by Insecure.Com LLC, and does not legally state the distribution terms for Nmap -- only the original English text does that. However, we hope that this translation helps Russian speakers understand the Nmap license better. </p>
<p class="level0">Это неофициальный перевод m[blue]<a class="bold" href="#">лицензии Nmap</a>m[]s-2u[15]ds+2 на русский язык. Он не был осуществлен Insecure.Com LLC, и не определяет с юридической точки зрения условия распространения Nmap -- это делает только оригинальный английский вариант. Тем не менее, мы надеемся, что этот перевод поможет русскоязычным пользователям лучше понять лицензию Nmap. </p><a name=""></a><h2 class="nroffsh">Авторское право и лицензия nmap</h2>
<p class="level0">Nmap Security Scanner (C) 1996-2008 Insecure.Com LLC. Nmap также является зарегистрированным товарным знаком Insecure.Com LLC. Эта программа является свободным программным обеспечением; вы можете распространять и / или модифицировать его в соответствии с условиями GNU General Public License, опубликованной Free Software Foundation; Версия 2 с уточнениями и исключениями, описанными ниже. Лицензия гарантирует ваше право использовать, модифицировать и распространять данное программное обеспечение на определенных условиях. Если вы хотите встроить Nmap технологии в собственное программное обеспечение, мы продаем альтернативные лицензии (обращаться &lt;sales@insecure.com&gt;). Десятки поставщиков программного обеспечения, уже имеют лицензии на использование Nmap технологий, таких, как обнаружение хостов, сканирование портов, определение OS и определение версии. </p>
<p class="level0">Имейте ввиду, что GPL накладывает важные ограничения на «производные приложения», хотя и не дает четкого определения этого термина. Чтобы избежать недоразумений, мы считаем, что приложение является «производным», если в нем реализованы любые из следующих пунктов: </p>
<p class="level1">h&#39;-04&#39;(buh&#39;+03&#39;c </p>
<p class="level0"><a name="bu"></a><span class="nroffip">\(bu 2.3</span> </p>
<p class="level1">Используется исходный код Nmap </p>
<p class="level1">h&#39;-04&#39;(buh&#39;+03&#39;c </p>
<p class="level0"><a name="bu"></a><span class="nroffip">\(bu 2.3</span> </p>
<p class="level1">Используются авторские файлы данных Nmap, такие, как nmap-os-db или nmap-service-probes. </p>
<p class="level1">h&#39;-04&#39;(buh&#39;+03&#39;c </p>
<p class="level0"><a name="bu"></a><span class="nroffip">\(bu 2.3</span> </p>
<p class="level1">Запускается Nmap, и анализируются результаты работы (в противовес обычным командным оболочкам, которые просто отображают необработанные выходные данные Nmap и поэтому не являются производными приложениями.) </p>
<p class="level1">h&#39;-04&#39;(buh&#39;+03&#39;c </p>
<p class="level0"><a name="bu"></a><span class="nroffip">\(bu 2.3</span> </p>
<p class="level1">Nmap интегрируется/включается/агрегируется в собственный исполняемый инсталлятор, как предоставляемые, например, с помощью InstallShield. </p>
<p class="level1">h&#39;-04&#39;(buh&#39;+03&#39;c </p>
<p class="level0"><a name="bu"></a><span class="nroffip">\(bu 2.3</span> </p>
<p class="level1">Используется ссылка на библиотеку или запускается программа, в которой реализованы любые из перечисленных пунктов. </p>
<p class="level0">В термин «Nmap» следует также включать любые части Nmap или производные от нее приложения. Это список не является полным, мы просто хотим сделать ясным наше понимание производных приложений с помощью некоторых общих примеров. Эти ограничения имеют силу, только когда вы действительно распростаняете Nmap. Например, ничего не мешает вам написать и продавать свой собственный пользовательский интерфейс для Nmap. Распространяйте его самостоятельно, а для скачивания Nmap направляйте людей на m[blue]<span Class="bold">%<a href="https://nmap.org">https://nmap.org</a></span>m[]. </p>
<p class="level0">Мы не считаем, что данные ограничения должны быть добавлены к лицензии GPL, мы просто приводим наше понимание «производных приложений» по отношению к нашему продукту с GPL лицензией. Это похоже на то, как Линус Торвальдс (Linus Torvalds) опубликовал свое понимание «производных приложений» применимо к модулям ядра Linux. Наше трактовка относится только к Nmap, мы не говорим ни о каких других GPL продуктах. </p>
<p class="level0">Если у вас есть какие-либо вопросы о GPL ограничениях по использованию Nmap в не-GPL продуктах, мы с радостью вам поможем. Как уже упоминалось выше, мы предоставляем альтернативную лицензию для интегрирования Nmap в собственные программные продукты. Эти контракты были проданы многим производителям программного обеспечения и обычно они включают: бессрочную лицензию, предоставление приоритетной поддержки и обновлений, а также содействие спонсированию продолжающейся разработки Nmap технологии. Для дальнейшей информации пишите на &lt;sales@insecure.com&gt;. </p>
<p class="level0">В качестве исключения из GPL соглашений, Insecure.Com LLC предоставляет право связывать исходный код этой программы с любой версией OpenSSL библиотеки, которая распространяется по лицензии приведенной в файле COPYING.OpenSSL, а также распространять эту комбинацию. Вы должны удовлетворять условиям лицензии GNU GPL во всем, что касается кода не использующего OpenSSL. Если вы модифицируете этот файл, вы можете расширить это исключение на вашу версию файла, но вы не обязаны это делать. </p>
<p class="level0">Если вы получаете эти файлы в лицензионным соглашением или контрактом, где указаны отличные от этих условий, то альтернативные условия лицензионного соглашения имеют преимущество над этими комментариями. </p><a name="Creative"></a><h2 class="nroffsh">Creative commons license для этого справочного руководства nmap</h2>
<p class="level0">Справочно Руководство Nmap это (C) 2005-2008 Insecure.Com LLC. Оно распространяется под лицензией m[blue]<a class="bold" href="#Creative">Creative Commons Attribution License</a>m[]s-2u[2]ds+2 версии 2.5. Это позволяет вам распространять и модифицировать его по вашему усмотрению, до тех пор пока вы считаетесь с исходным источником. В качестве альтернативы вы можете считать, что этот документ распространяется по той же лицензии, что и сама Nmap (описывается выше). </p><a name=""></a><h2 class="nroffsh">Доступность исходного кода и общественные вклады</h2>
<p class="level0">Мы предоставляем исходный код, потому что верим, что пользователи должны иметь право знать, что именно программа будет делать до того, как запустят ее. Это также позволяет вам проверять программное обеспечение на наличие дыр в безопасности (пока не было найдено ни одной). </p>
<p class="level0">Исходный код также позволяет вам портировать Nmap на новые платформы, исправлять баги и добавлять новые возможности. Всячески поощряется посылка своих изменений на &lt;fyodor@nmap.org&gt; для возможного их включения в основной дистрибутив. Отправляют эти изменения Fyodor*(Aqу или разработчикам на Insecure.Org, пердполагается, что вы предоставляете Fyodor*(Aqу и Insecure.Com LLC безграничное, не эксклюзивное право на повторное использование, модификацию и изменение лицензии кода. Nmap всегда будет доступна как Open Source продукт, это важно, т.к. невозможность изменения лицензии на кода уже повлекла за собой большие проблемы для других Free Software проектов (как, например, KDE и NASM). Вы также порой позволяем третьим сторонам изменять лицензию, как описывалось выше. Если вы хотите использовать собственные лицензионные условия для ваших изменений, сообщите об этом, когда будете их отсылать. </p><a name=""></a><h2 class="nroffsh">Отсутствие гарантии</h2>
<p class="level0">Эта программа распространяется в надежде на то, что она будет полезна, но БЕЗ КАКИХ-ЛИБО ГАРАНТИЙ; даже без какой-либо подразумеваемой ТОВАРНОЙ ПРИГОДНОСТИ или ПРИГОДНОСТИ ДЛЯ КАКОЙ-ЛИБО ОПРЕДЕЛЕННОЙ ЗАДАЧИ. Смотрите GNU General Public License v2.0 для подробностей m[blue]<span Class="bold">%<a href="http://www.gnu.org/licenses/gpl-2.0.html">http://www.gnu.org/licenses/gpl-2.0.html</a></span>m[], или в файле COPYING, который распространяется с Nmap. </p>
<p class="level0">Также следует принять во внимание, что время от времени Nmap вызывает крах плохо написанных приложений, TCP/IP стеков и даже операционных систем. Хотя такие случаи и чрезвычайно редки, не следует о них забывать. <span Class="emphasis">Nmap никогда не следует использовать для сканирования критичных систем</span>, пока вы не готовы мириться в временем простоя. Мы признаем, что Nmap может вызвать крах ваших систем или сетей, и отрицаем всякую ответственность за проблемы или ущерб, нанесенные Nmap. </p><a name=""></a><h2 class="nroffsh">Несоответствующее использование</h2>
<p class="level0">Из-за возможного риска краха и из-за того, что некоторые личности используют Nmap для предварительного исследования систем перед их атакой, некоторые администраторы могут быть недовольны тем, что их система была просканирована. Поэтому, перед тем как сканировать сеть, разумно получить на это разрешение. </p>
<p class="level0">Nmap не следует устанавливать с особыми привилегиями (например, suid root) из соображений безопасности. </p><a name=""></a><h2 class="nroffsh">Стороннее программное обеспечение</h2>
<p class="level0">Этот продукт содержит программное обеспечение разработанное m[blue]<span Class="bold">Apache Software Foundation</span>m[]s-2u[16]ds+2. Модифицированная версия библиотеки m[blue]<span Class="bold">Libpcap portable packet capture library</span>m[]s-2u[17]ds+2 распространяется вместе с Nmap. Windows версия Nmap использует вместо Libpcap производную от нее библиотеку m[blue]<span Class="bold">WinPcap library</span>m[]s-2u[18]ds+2. Поддержка регулярных выражений предоставляется библиотекой m[blue]<span Class="bold">PCRE library</span>m[]s-2u[19]ds+2,, которая является программным обеспечением с открытым исходным кодом, написана Филипом Хазелом (Philip Hazel). Некоторые функции по работе с сырыми сокетами используют сетевую библиотеку m[blue]<span Class="bold">Libdnet</span>m[]s-2u[20]ds+2, написанную Дагом Сонгом (Dug Song). Модифицированная версия распространяется вместе с Nmap. Nmap может быть связана с m[blue]<span Class="bold">OpenSSL cryptography toolkit</span>m[]s-2u[21]ds+2 поддержки SSL определения версии. Скриптовый движок Nmap (Nmap Scripting Engine) использует встроенную версию m[blue]<a class="bold" href="#">языка программирования Lua</a>m[]s-2u[22]ds+2. Все описанное здесь стороннее проограммное обеспечение бесплатно распространяется на основе лицензии в стиле BSD. </p><a name=""></a><h2 class="nroffsh">Классификация по контролю экспорта Соединенных Штатов</h2>
<p class="level0">U.S. Export Control: Insecure.Com LLC указывает, что Nmap попадает под U.S. ECCN (число в классификации по контролю экспорта) 5D992. Эта категория называется «Программное обеспечение информационной безопасности не контролируемое 5D002». Единственным ограничем в этой категории является AT (анти-терроризм), под который попадают почти все товары, что запрещает экспорт в горстку не стран типа Ирана и Северной Кореи. Поэтому экспорт Nmap не требует какой-либо специальной лицензии, разрешения или других санкций со стороны государства. </p><a name=""></a><h2 class="nroffsh">ПРИМЕЧАНИЯ</h2>
<p class="level0"><a name=""></a><span class="nroffip"> 1. 4</span> </p>
<p class="level1">оригинальной английской версии </p>
<p class="level2">%<a href="https://nmap.org/book/man.html">https://nmap.org/book/man.html</a> </p>
<p class="level0"><a name=""></a><span class="nroffip"> 2. 4</span> </p>
<p class="level1">Creative Commons Attribution License </p>
<p class="level2">%<a href="http://creativecommons.org/licenses/by/2.5/">http://creativecommons.org/licenses/by/2.5/</a> </p>
<p class="level0"><a name=""></a><span class="nroffip"> 3. 4</span> </p>
<p class="level1"><a href="http://www.ietf.org/rfc/rfc1122.txt">RFC 1122</a> </p>
<p class="level2">%<a href="http://www.rfc-editor.org/rfc/rfc1122.txt">http://www.rfc-editor.org/rfc/rfc1122.txt</a> </p>
<p class="level0"><a name=""></a><span class="nroffip"> 4. 4</span> </p>
<p class="level1"><a href="http://www.ietf.org/rfc/rfc792.txt">RFC 792</a> </p>
<p class="level2">%<a href="http://www.rfc-editor.org/rfc/rfc792.txt">http://www.rfc-editor.org/rfc/rfc792.txt</a> </p>
<p class="level0"><a name=""></a><span class="nroffip"> 5. 4</span> </p>
<p class="level1"><a href="http://www.ietf.org/rfc/rfc1918.txt">RFC 1918</a> </p>
<p class="level2">%<a href="http://www.rfc-editor.org/rfc/rfc1918.txt">http://www.rfc-editor.org/rfc/rfc1918.txt</a> </p>
<p class="level0"><a name=""></a><span class="nroffip"> 6. 4</span> </p>
<p class="level1">UDP </p>
<p class="level2">%<a href="http://www.rfc-editor.org/rfc/rfc768.txt">http://www.rfc-editor.org/rfc/rfc768.txt</a> </p>
<p class="level0"><a name=""></a><span class="nroffip"> 7. 4</span> </p>
<p class="level1">TCP RFC </p>
<p class="level2">%<a href="http://www.rfc-editor.org/rfc/rfc793.txt">http://www.rfc-editor.org/rfc/rfc793.txt</a> </p>
<p class="level0"><a name=""></a><span class="nroffip"> 8. 4</span> </p>
<p class="level1"><a href="http://www.ietf.org/rfc/rfc959.txt">RFC 959</a> </p>
<p class="level2">%<a href="http://www.rfc-editor.org/rfc/rfc959.txt">http://www.rfc-editor.org/rfc/rfc959.txt</a> </p>
<p class="level0"><a name=""></a><span class="nroffip"> 9. 4</span> </p>
<p class="level1"><a href="http://www.ietf.org/rfc/rfc1323.txt">RFC 1323</a> </p>
<p class="level2">%<a href="http://www.rfc-editor.org/rfc/rfc1323.txt">http://www.rfc-editor.org/rfc/rfc1323.txt</a> </p>
<p class="level0"><a name="10"></a><span class="nroffip">10. 4</span> </p>
<p class="level1">язык программирования Lua </p>
<p class="level2">%<a href="http://lua.org">http://lua.org</a> </p>
<p class="level0"><a name="11"></a><span class="nroffip">11. 4</span> </p>
<p class="level1">Протокол IP </p>
<p class="level2">%<a href="http://www.rfc-editor.org/rfc/rfc791.txt">http://www.rfc-editor.org/rfc/rfc791.txt</a> </p>
<p class="level0"><a name="12"></a><span class="nroffip">12. 4</span> </p>
<p class="level1">Nmap::Scanner </p>
<p class="level2">%<a href="http://sourceforge.net/projects/nmap-scanner/">http://sourceforge.net/projects/nmap-scanner/</a> </p>
<p class="level0"><a name="13"></a><span class="nroffip">13. 4</span> </p>
<p class="level1">Nmap::Parser </p>
<p class="level2">%<a href="http://nmapparser.wordpress.com/">http://nmapparser.wordpress.com/</a> </p>
<p class="level0"><a name="14"></a><span class="nroffip">14. 4</span> </p>
<p class="level1">перечислены на Wikipedia </p>
<p class="level2">%<a href="http://en.wikipedia.org/wiki/List_of_IPv6_tunnel_brokers">http://en.wikipedia.org/wiki/List_of_IPv6_tunnel_brokers</a> </p>
<p class="level0"><a name="15"></a><span class="nroffip">15. 4</span> </p>
<p class="level1">Nmap license details </p>
<p class="level2">%<a href="https://nmap.org/book/man-legal.html">https://nmap.org/book/man-legal.html</a> </p>
<p class="level0"><a name="16"></a><span class="nroffip">16. 4</span> </p>
<p class="level1">Apache Software Foundation </p>
<p class="level2">%<a href="http://www.apache.org">http://www.apache.org</a> </p>
<p class="level0"><a name="17"></a><span class="nroffip">17. 4</span> </p>
<p class="level1">Libpcap portable packet capture library </p>
<p class="level2">%<a href="http://www.tcpdump.org">http://www.tcpdump.org</a> </p>
<p class="level0"><a name="18"></a><span class="nroffip">18. 4</span> </p>
<p class="level1">WinPcap library </p>
<p class="level2">%<a href="http://www.winpcap.org">http://www.winpcap.org</a> </p>
<p class="level0"><a name="19"></a><span class="nroffip">19. 4</span> </p>
<p class="level1">PCRE library </p>
<p class="level2">%<a href="http://www.pcre.org">http://www.pcre.org</a> </p>
<p class="level0"><a name="20"></a><span class="nroffip">20. 4</span> </p>
<p class="level1">Libdnet </p>
<p class="level2">%<a href="http://libdnet.sourceforge.net">http://libdnet.sourceforge.net</a> </p>
<p class="level0"><a name="21"></a><span class="nroffip">21. 4</span> </p>
<p class="level1">OpenSSL cryptography toolkit </p>
<p class="level2">%<a href="http://www.openssl.org">http://www.openssl.org</a> </p>
<p class="level0"><a name="22"></a><span class="nroffip">22. 4</span> </p>
<p class="level1">языка программирования Lua </p>
<p class="level2">%<a href="http://www.lua.org">http://www.lua.org</a> </p><p class="roffit">
 This HTML page was made with <a href="http://daniel.haxx.se/projects/roffit/">roffit</a>.
</body></html>
